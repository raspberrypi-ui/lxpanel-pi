diff --git a/configure.ac b/configure.ac
index 2d7e8e1..610e198 100644
--- a/configure.ac
+++ b/configure.ac
@@ -31,7 +31,8 @@ AC_HELP_STRING([--enable-gtk3],[enable to use gtk-3.0 instead of gtk-2.0]),
   yes)  enable_gtk3=yes ;;
   no)   enable_gtk3=no ;;
   *) AC_MSG_ERROR([bad value "${enableval}" for --enable-gtk3, use "yes" (default) or "no".]) ;;
-esac],[])
+esac],[enable_gtk3=yes])
+AM_CONDITIONAL(GTK2_ONLY, test x"$enable_gtk3" = x"no")
 
 if test "x$enable_gtk3" = "xyes" ; then
   gtk_module="gtk+-3.0"
diff --git a/data/ui/launchtaskbar.glade b/data/ui/launchtaskbar.glade
index 41a79b3..2c4c12e 100644
--- a/data/ui/launchtaskbar.glade
+++ b/data/ui/launchtaskbar.glade
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <interface>
-  <requires lib="gtk+" version="2.16"/>
+  <requires lib="gtk+" version="3.24"/>
   <!-- interface-naming-policy project-wide -->
   <object class="GtkAdjustment" id="adjustment_max_width">
     <property name="upper">1000</property>
@@ -34,12 +34,13 @@
     <property name="default_height">440</property>
     <property name="type_hint">dialog</property>
     <child internal-child="vbox">
-      <object class="GtkVBox" id="dialog-vbox">
+      <object class="GtkBox" id="dialog-vbox">
+        <property name="orientation">vertical</property>
         <property name="visible">True</property>
         <property name="can_focus">False</property>
         <property name="spacing">6</property>
         <child>
-          <object class="GtkHBox" id="hbox_mode">
+          <object class="GtkBox" id="hbox_mode">
             <property name="visible">True</property>
             <property name="can_focus">False</property>
             <property name="spacing">12</property>
@@ -86,12 +87,13 @@
             <property name="visible">True</property>
             <property name="can_focus">True</property>
             <child>
-              <object class="GtkHBox" id="hbox1">
+              <object class="GtkBox" id="hbox1">
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <property name="spacing">12</property>
                 <child>
-                  <object class="GtkVBox" id="vbox_defined">
+                  <object class="GtkBox" id="vbox_defined">
+                    <property name="orientation">vertical</property>
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <child>
@@ -127,7 +129,9 @@
                       <object class="GtkLabel" id="label_def_app_exec">
                         <property name="visible">True</property>
                         <property name="can_focus">False</property>
+                        <property name="hexpand">False</property>
                         <property name="ellipsize">end</property>
+                        <property name="max_width_chars">1</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -143,7 +147,8 @@
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="vbox1">
+                  <object class="GtkBox" id="vbox1">
+                    <property name="orientation">vertical</property>
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <property name="spacing">6</property>
@@ -211,7 +216,8 @@
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="vbox_menu">
+                  <object class="GtkBox" id="vbox_menu">
+                    <property name="orientation">vertical</property>
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <child>
@@ -235,7 +241,9 @@
                       <object class="GtkLabel" id="label_menu_app_exec">
                         <property name="visible">True</property>
                         <property name="can_focus">False</property>
+                        <property name="hexpand">False</property>
                         <property name="ellipsize">end</property>
+                        <property name="max_width_chars">1</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -264,7 +272,8 @@
               </packing>
             </child>
             <child>
-              <object class="GtkVBox" id="vbox2">
+              <object class="GtkBox" id="vbox2">
+                <property name="orientation">vertical</property>
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <child>
@@ -408,7 +417,7 @@
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkHBox" id="hbox2">
+                  <object class="GtkBox" id="hbox2">
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <child>
@@ -450,7 +459,7 @@
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkHBox" id="hbox3">
+                  <object class="GtkBox" id="hbox3">
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <child>
diff --git a/data/ui/netstatus.glade b/data/ui/netstatus.glade
index 8dc995a..1d88c10 100644
--- a/data/ui/netstatus.glade
+++ b/data/ui/netstatus.glade
@@ -1,37 +1,144 @@
-<?xml version="1.0"?>
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- Generated with glade 3.22.1 -->
 <interface>
-  <requires lib="gtk+" version="2.16"/>
-  <!-- interface-naming-policy toplevel-contextual -->
+  <requires lib="gtk+" version="3.24"/>
   <object class="GtkDialog" id="network_status_dialog">
+    <property name="can_focus">False</property>
     <property name="border_width">5</property>
     <property name="resizable">False</property>
     <property name="window_position">center</property>
     <property name="default_width">300</property>
     <property name="type_hint">dialog</property>
+    <child>
+      <placeholder/>
+    </child>
     <child internal-child="vbox">
-      <object class="GtkVBox" id="dialog-vbox2">
+      <object class="GtkBox" id="dialog-vbox2">
         <property name="visible">True</property>
+        <property name="can_focus">False</property>
         <property name="spacing">2</property>
+        <child internal-child="action_area">
+          <object class="GtkButtonBox" id="dialog-action_area2">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="layout_style">end</property>
+            <child>
+              <object class="GtkButton" id="helpbutton1">
+                <property name="label">gtk-help</property>
+                <property name="can_focus">True</property>
+                <property name="can_default">True</property>
+                <property name="has_default">True</property>
+                <property name="receives_default">False</property>
+                <property name="use_stock">True</property>
+              </object>
+              <packing>
+                <property name="expand">False</property>
+                <property name="fill">False</property>
+                <property name="position">0</property>
+              </packing>
+            </child>
+            <child>
+              <object class="GtkButton" id="configure_button">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="can_default">True</property>
+                <property name="receives_default">False</property>
+                <child>
+                  <object class="GtkAlignment" id="alignment2">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="xscale">0</property>
+                    <property name="yscale">0</property>
+                    <child>
+                      <object class="GtkBox" id="hbox5">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="spacing">2</property>
+                        <child>
+                          <object class="GtkImage" id="image2">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="stock">gtk-preferences</property>
+                          </object>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">False</property>
+                            <property name="position">0</property>
+                          </packing>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="label42">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="label" translatable="yes">Con_figure</property>
+                            <property name="use_underline">True</property>
+                          </object>
+                          <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">False</property>
+                            <property name="position">1</property>
+                          </packing>
+                        </child>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+              <packing>
+                <property name="expand">False</property>
+                <property name="fill">False</property>
+                <property name="position">1</property>
+              </packing>
+            </child>
+            <child>
+              <object class="GtkButton" id="close_button">
+                <property name="label">gtk-close</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="can_default">True</property>
+                <property name="has_default">True</property>
+                <property name="receives_default">False</property>
+                <property name="use_stock">True</property>
+              </object>
+              <packing>
+                <property name="expand">False</property>
+                <property name="fill">False</property>
+                <property name="position">2</property>
+              </packing>
+            </child>
+          </object>
+          <packing>
+            <property name="expand">False</property>
+            <property name="fill">False</property>
+            <property name="pack_type">end</property>
+            <property name="position">0</property>
+          </packing>
+        </child>
         <child>
           <object class="GtkNotebook" id="notebook1">
             <property name="visible">True</property>
             <property name="can_focus">True</property>
             <property name="border_width">5</property>
             <child>
-              <object class="GtkVBox" id="vbox1">
+              <object class="GtkBox" id="vbox1">
                 <property name="visible">True</property>
+                <property name="can_focus">False</property>
                 <property name="border_width">12</property>
+                <property name="orientation">vertical</property>
                 <property name="spacing">18</property>
                 <child>
-                  <object class="GtkVBox" id="connection_frame">
+                  <object class="GtkBox" id="connection_frame">
                     <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="label3">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Connection&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -40,11 +147,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox6">
+                      <object class="GtkBox" id="hbox6">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label43">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -54,55 +163,38 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkHBox" id="connection_hbox">
+                          <object class="GtkBox" id="connection_hbox">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="spacing">12</property>
                             <child>
-                              <object class="GtkTable" id="connection_table">
+                              <object class="GtkGrid" id="connection_table">
                                 <property name="visible">True</property>
-                                <property name="n_rows">2</property>
-                                <property name="n_columns">2</property>
-                                <property name="column_spacing">12</property>
+                                <property name="can_focus">False</property>
                                 <property name="row_spacing">6</property>
+                                <property name="column_spacing">12</property>
                                 <child>
                                   <object class="GtkLabel" id="label5">
                                     <property name="visible">True</property>
-                                    <property name="xalign">0</property>
+                                    <property name="can_focus">False</property>
                                     <property name="label" translatable="yes">Status:</property>
+                                    <property name="xalign">0</property>
                                   </object>
                                   <packing>
+                                    <property name="left_attach">0</property>
                                     <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="x_options">GTK_FILL</property>
-                                    <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
                                   <object class="GtkLabel" id="status_label">
                                     <property name="visible">True</property>
                                     <property name="can_focus">True</property>
-                                    <property name="xalign">0</property>
                                     <property name="selectable">True</property>
+                                    <property name="xalign">0</property>
                                   </object>
                                   <packing>
                                     <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
                                     <property name="top_attach">1</property>
-                                    <property name="bottom_attach">2</property>
-                                    <property name="x_options">GTK_FILL</property>
-                                    <property name="y_options"></property>
-                                  </packing>
-                                </child>
-                                <child>
-                                  <object class="GtkLabel" id="label16">
-                                    <property name="visible">True</property>
-                                    <property name="xalign">0</property>
-                                    <property name="label" translatable="yes">_Name:</property>
-                                    <property name="use_underline">True</property>
-                                  </object>
-                                  <packing>
-                                    <property name="x_options">GTK_FILL</property>
-                                    <property name="y_options"></property>
                                   </packing>
                                 </child>
                                 <child>
@@ -118,13 +210,26 @@
                                   </object>
                                   <packing>
                                     <property name="left_attach">1</property>
-                                    <property name="right_attach">2</property>
-                                    <property name="x_options"></property>
-                                    <property name="y_options"></property>
+                                    <property name="top_attach">0</property>
+                                  </packing>
+                                </child>
+                                <child>
+                                  <object class="GtkLabel" id="label16">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">False</property>
+                                    <property name="label" translatable="yes">_Name:</property>
+                                    <property name="use_underline">True</property>
+                                    <property name="xalign">0</property>
+                                  </object>
+                                  <packing>
+                                    <property name="left_attach">0</property>
+                                    <property name="top_attach">0</property>
                                   </packing>
                                 </child>
                               </object>
                               <packing>
+                                <property name="expand">False</property>
+                                <property name="fill">True</property>
                                 <property name="position">0</property>
                               </packing>
                             </child>
@@ -133,30 +238,38 @@
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">0</property>
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="activity_frame">
+                  <object class="GtkBox" id="activity_frame">
                     <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="label4">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Activity&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -165,11 +278,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox8">
+                      <object class="GtkBox" id="hbox8">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label44">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -179,92 +294,93 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkTable" id="table2">
+                          <object class="GtkGrid" id="table2">
                             <property name="visible">True</property>
-                            <property name="n_rows">2</property>
-                            <property name="n_columns">2</property>
-                            <property name="column_spacing">12</property>
+                            <property name="can_focus">False</property>
                             <property name="row_spacing">6</property>
+                            <property name="column_spacing">12</property>
                             <child>
                               <object class="GtkLabel" id="received_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="sent_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="label11">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Received:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="label12">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Sent:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
+                                <property name="left_attach">0</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">1</property>
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="signal_strength_frame">
+                  <object class="GtkBox" id="signal_strength_frame">
                     <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="label48">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Signal Strength&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -273,11 +389,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox14">
+                      <object class="GtkBox" id="hbox14">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label49">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -287,42 +405,52 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkHBox" id="hbox15">
+                          <object class="GtkBox" id="hbox15">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="spacing">6</property>
                             <child>
                               <object class="GtkProgressBar" id="signal_strength_bar">
                                 <property name="visible">True</property>
+                                <property name="can_focus">False</property>
                                 <property name="pulse_step">0.10000000149</property>
                               </object>
                               <packing>
+                                <property name="expand">True</property>
+                                <property name="fill">True</property>
                                 <property name="position">0</property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="signal_strength_label">
                                 <property name="visible">True</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">0%</property>
                               </object>
                               <packing>
                                 <property name="expand">False</property>
+                                <property name="fill">True</property>
                                 <property name="position">1</property>
                               </packing>
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">True</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
                         <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">2</property>
                   </packing>
                 </child>
@@ -331,6 +459,7 @@
             <child type="tab">
               <object class="GtkLabel" id="label1">
                 <property name="visible">True</property>
+                <property name="can_focus">False</property>
                 <property name="label" translatable="yes">General</property>
               </object>
               <packing>
@@ -338,20 +467,25 @@
               </packing>
             </child>
             <child>
-              <object class="GtkVBox" id="vbox2">
+              <object class="GtkBox" id="vbox2">
                 <property name="visible">True</property>
+                <property name="can_focus">False</property>
                 <property name="border_width">12</property>
+                <property name="orientation">vertical</property>
                 <property name="spacing">18</property>
                 <child>
-                  <object class="GtkVBox" id="inet4_frame">
+                  <object class="GtkBox" id="inet4_frame">
                     <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="label25">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Internet Protocol (IPv4)&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -360,11 +494,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox11">
+                      <object class="GtkBox" id="hbox11">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label45">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -374,149 +510,140 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkTable" id="inet4_table">
+                          <object class="GtkGrid" id="inet4_table">
                             <property name="visible">True</property>
-                            <property name="n_rows">4</property>
-                            <property name="n_columns">2</property>
-                            <property name="column_spacing">12</property>
+                            <property name="can_focus">False</property>
                             <property name="row_spacing">6</property>
+                            <property name="column_spacing">12</property>
                             <child>
                               <object class="GtkLabel" id="inet4_addr_title">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Address:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_dest_title">
+                              <object class="GtkLabel" id="inet4_addr_label">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="selectable">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Destination:</property>
                               </object>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">1</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_bcast_title">
+                              <object class="GtkLabel" id="inet4_bcast_label">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="selectable">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Broadcast:</property>
                               </object>
                               <packing>
+                                <property name="left_attach">1</property>
                                 <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_mask_title">
+                              <object class="GtkLabel" id="inet4_mask_label">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="selectable">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Subnet Mask:</property>
                               </object>
                               <packing>
+                                <property name="left_attach">1</property>
                                 <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_addr_label">
+                              <object class="GtkLabel" id="inet4_mask_title">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="label" translatable="yes">Subnet Mask:</property>
                                 <property name="xalign">0</property>
-                                <property name="selectable">True</property>
                               </object>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">3</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_dest_label">
+                              <object class="GtkLabel" id="inet4_bcast_title">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="label" translatable="yes">Broadcast:</property>
                                 <property name="xalign">0</property>
-                                <property name="selectable">True</property>
                               </object>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">2</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_bcast_label">
+                              <object class="GtkLabel" id="inet4_dest_title">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="label" translatable="yes">Destination:</property>
                                 <property name="xalign">0</property>
-                                <property name="selectable">True</property>
                               </object>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">2</property>
-                                <property name="bottom_attach">3</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">1</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet4_mask_label">
+                              <object class="GtkLabel" id="inet4_dest_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="top_attach">3</property>
-                                <property name="bottom_attach">4</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="top_attach">1</property>
                               </packing>
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">0</property>
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="inet6_frame">
+                  <object class="GtkBox" id="inet6_frame">
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="label26">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Internet Protocol (IPv6)&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -525,11 +652,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox12">
+                      <object class="GtkBox" id="hbox12">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label46">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -539,92 +668,93 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkTable" id="table5">
+                          <object class="GtkGrid" id="table5">
                             <property name="visible">True</property>
-                            <property name="n_rows">2</property>
-                            <property name="n_columns">2</property>
-                            <property name="column_spacing">12</property>
+                            <property name="can_focus">False</property>
                             <property name="row_spacing">6</property>
+                            <property name="column_spacing">12</property>
                             <child>
                               <object class="GtkLabel" id="label39">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Address:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="label40">
+                              <object class="GtkLabel" id="inet6_addr_label">
                                 <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="selectable">True</property>
                                 <property name="xalign">0</property>
-                                <property name="label" translatable="yes">Scope:</property>
                               </object>
                               <packing>
-                                <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">1</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkLabel" id="inet6_addr_label">
+                              <object class="GtkLabel" id="label40">
                                 <property name="visible">True</property>
-                                <property name="can_focus">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="label" translatable="yes">Scope:</property>
                                 <property name="xalign">0</property>
-                                <property name="selectable">True</property>
                               </object>
                               <packing>
-                                <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">1</property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="inet6_scope_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">1</property>
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="dev_frame">
+                  <object class="GtkBox" id="dev_frame">
                     <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="orientation">vertical</property>
                     <property name="spacing">6</property>
                     <child>
                       <object class="GtkLabel" id="dev_label">
                         <property name="visible">True</property>
-                        <property name="xalign">0</property>
+                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">&lt;b&gt;Network Device&lt;/b&gt;</property>
                         <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
                       </object>
                       <packing>
                         <property name="expand">False</property>
@@ -633,11 +763,13 @@
                       </packing>
                     </child>
                     <child>
-                      <object class="GtkHBox" id="hbox13">
+                      <object class="GtkBox" id="hbox13">
                         <property name="visible">True</property>
+                        <property name="can_focus">False</property>
                         <child>
                           <object class="GtkLabel" id="label47">
                             <property name="visible">True</property>
+                            <property name="can_focus">False</property>
                             <property name="label">    </property>
                           </object>
                           <packing>
@@ -647,79 +779,77 @@
                           </packing>
                         </child>
                         <child>
-                          <object class="GtkTable" id="table6">
+                          <object class="GtkGrid" id="table6">
                             <property name="visible">True</property>
-                            <property name="n_rows">2</property>
-                            <property name="n_columns">2</property>
-                            <property name="column_spacing">12</property>
+                            <property name="can_focus">False</property>
                             <property name="row_spacing">6</property>
+                            <property name="column_spacing">12</property>
                             <child>
                               <object class="GtkLabel" id="dev_addr_title">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Address:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
+                                <property name="left_attach">0</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="dev_addr_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
                                 <property name="top_attach">1</property>
-                                <property name="bottom_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="dev_type_label">
                                 <property name="visible">True</property>
                                 <property name="can_focus">True</property>
-                                <property name="xalign">0</property>
                                 <property name="selectable">True</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
                                 <property name="left_attach">1</property>
-                                <property name="right_attach">2</property>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                             <child>
                               <object class="GtkLabel" id="dev_type_title">
                                 <property name="visible">True</property>
-                                <property name="xalign">0</property>
+                                <property name="can_focus">False</property>
                                 <property name="label" translatable="yes">Type:</property>
+                                <property name="xalign">0</property>
                               </object>
                               <packing>
-                                <property name="x_options">GTK_FILL</property>
-                                <property name="y_options"></property>
+                                <property name="left_attach">0</property>
+                                <property name="top_attach">0</property>
                               </packing>
                             </child>
                           </object>
                           <packing>
+                            <property name="expand">False</property>
+                            <property name="fill">True</property>
                             <property name="position">1</property>
                           </packing>
                         </child>
                       </object>
                       <packing>
+                        <property name="expand">False</property>
+                        <property name="fill">True</property>
                         <property name="position">1</property>
                       </packing>
                     </child>
                   </object>
                   <packing>
                     <property name="expand">False</property>
+                    <property name="fill">True</property>
                     <property name="position">2</property>
                   </packing>
                 </child>
@@ -731,6 +861,7 @@
             <child type="tab">
               <object class="GtkLabel" id="label2">
                 <property name="visible">True</property>
+                <property name="can_focus">False</property>
                 <property name="label" translatable="yes">Support</property>
               </object>
               <packing>
@@ -739,99 +870,10 @@
               </packing>
             </child>
           </object>
-          <packing>
-            <property name="position">1</property>
-          </packing>
-        </child>
-        <child internal-child="action_area">
-          <object class="GtkHButtonBox" id="dialog-action_area2">
-            <property name="visible">True</property>
-            <property name="layout_style">end</property>
-            <child>
-              <object class="GtkButton" id="helpbutton1">
-                <property name="label">gtk-help</property>
-                <property name="can_focus">True</property>
-                <property name="can_default">True</property>
-                <property name="has_default">True</property>
-                <property name="receives_default">False</property>
-                <property name="use_stock">True</property>
-              </object>
-              <packing>
-                <property name="expand">False</property>
-                <property name="fill">False</property>
-                <property name="position">0</property>
-              </packing>
-            </child>
-            <child>
-              <object class="GtkButton" id="configure_button">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="can_default">True</property>
-                <property name="receives_default">False</property>
-                <child>
-                  <object class="GtkAlignment" id="alignment2">
-                    <property name="visible">True</property>
-                    <property name="xscale">0</property>
-                    <property name="yscale">0</property>
-                    <child>
-                      <object class="GtkHBox" id="hbox5">
-                        <property name="visible">True</property>
-                        <property name="spacing">2</property>
-                        <child>
-                          <object class="GtkImage" id="image2">
-                            <property name="visible">True</property>
-                            <property name="stock">gtk-preferences</property>
-                          </object>
-                          <packing>
-                            <property name="expand">False</property>
-                            <property name="fill">False</property>
-                            <property name="position">0</property>
-                          </packing>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="label42">
-                            <property name="visible">True</property>
-                            <property name="label" translatable="yes">Con_figure</property>
-                            <property name="use_underline">True</property>
-                          </object>
-                          <packing>
-                            <property name="expand">False</property>
-                            <property name="fill">False</property>
-                            <property name="position">1</property>
-                          </packing>
-                        </child>
-                      </object>
-                    </child>
-                  </object>
-                </child>
-              </object>
-              <packing>
-                <property name="expand">False</property>
-                <property name="fill">False</property>
-                <property name="position">1</property>
-              </packing>
-            </child>
-            <child>
-              <object class="GtkButton" id="close_button">
-                <property name="label">gtk-close</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="can_default">True</property>
-                <property name="has_default">True</property>
-                <property name="receives_default">False</property>
-                <property name="use_stock">True</property>
-              </object>
-              <packing>
-                <property name="expand">False</property>
-                <property name="fill">False</property>
-                <property name="position">2</property>
-              </packing>
-            </child>
-          </object>
           <packing>
             <property name="expand">False</property>
-            <property name="pack_type">end</property>
-            <property name="position">0</property>
+            <property name="fill">True</property>
+            <property name="position">1</property>
           </packing>
         </child>
       </object>
diff --git a/data/ui/panel-pref.glade b/data/ui/panel-pref.glade
index e59dcce..0435b51 100644
--- a/data/ui/panel-pref.glade
+++ b/data/ui/panel-pref.glade
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <interface>
-  <requires lib="gtk+" version="2.16"/>
+  <requires lib="gtk+" version="3.24"/>
   <!-- interface-naming-policy toplevel-contextual -->
   <object class="GtkAdjustment" id="adjustment1">
     <property name="upper">10</property>
@@ -100,7 +100,8 @@
     <property name="title" translatable="yes">Panel Preferences</property>
     <property name="type_hint">dialog</property>
     <child internal-child="vbox">
-      <object class="GtkVBox" id="dialog-vbox1">
+      <object class="GtkBox" id="dialog-vbox1">
+        <property name="orientation">vertical</property>
         <property name="visible">True</property>
         <property name="can_focus">False</property>
         <child internal-child="action_area">
@@ -137,7 +138,8 @@
             <property name="visible">True</property>
             <property name="can_focus">True</property>
             <child>
-              <object class="GtkVBox" id="vbox7">
+              <object class="GtkBox" id="vbox7">
+                <property name="orientation">vertical</property>
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <child>
@@ -152,7 +154,7 @@
                         <property name="can_focus">False</property>
                         <property name="left_padding">12</property>
                         <child>
-                          <object class="GtkHBox" id="hbox6">
+                          <object class="GtkBox" id="hbox6">
                             <property name="visible">True</property>
                             <property name="can_focus">False</property>
                             <child>
@@ -169,7 +171,8 @@
                                     <property name="yscale">0</property>
                                     <property name="left_padding">12</property>
                                     <child>
-                                      <object class="GtkVBox" id="vbox9">
+                                      <object class="GtkBox" id="vbox9">
+                                        <property name="orientation">vertical</property>
                                         <property name="visible">True</property>
                                         <property name="can_focus">False</property>
                                         <property name="homogeneous">True</property>
@@ -270,7 +273,8 @@
                                     <property name="yscale">0</property>
                                     <property name="left_padding">12</property>
                                     <child>
-                                      <object class="GtkVBox" id="vbox12">
+                                      <object class="GtkBox" id="vbox12">
+                                        <property name="orientation">vertical</property>
                                         <property name="visible">True</property>
                                         <property name="can_focus">False</property>
                                         <property name="homogeneous">True</property>
@@ -342,7 +346,8 @@
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkVBox" id="vbox11">
+                              <object class="GtkBox" id="vbox11">
+                                <property name="orientation">vertical</property>
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <child>
@@ -668,7 +673,8 @@
               </packing>
             </child>
             <child>
-              <object class="GtkVBox" id="vbox1">
+              <object class="GtkBox" id="vbox1">
+                <property name="orientation">vertical</property>
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <property name="border_width">6</property>
@@ -685,7 +691,8 @@
                         <property name="can_focus">False</property>
                         <property name="left_padding">12</property>
                         <child>
-                          <object class="GtkVBox" id="vbox4">
+                          <object class="GtkBox" id="vbox4">
+                            <property name="orientation">vertical</property>
                             <property name="visible">True</property>
                             <property name="can_focus">False</property>
                             <property name="spacing">2</property>
@@ -707,7 +714,7 @@
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkHBox" id="hbox2">
+                              <object class="GtkBox" id="hbox2">
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <property name="spacing">10</property>
@@ -751,7 +758,7 @@
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkHBox" id="hbox4">
+                              <object class="GtkBox" id="hbox4">
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <property name="spacing">40</property>
@@ -822,12 +829,13 @@
                         <property name="can_focus">False</property>
                         <property name="left_padding">12</property>
                         <child>
-                          <object class="GtkVBox" id="vbox10">
+                          <object class="GtkBox" id="vbox10">
+                            <property name="orientation">vertical</property>
                             <property name="visible">True</property>
                             <property name="can_focus">False</property>
                             <property name="spacing">2</property>
                             <child>
-                              <object class="GtkHBox" id="hbox1">
+                              <object class="GtkBox" id="hbox1">
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <property name="spacing">10</property>
@@ -869,7 +877,7 @@
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkHBox" id="hbox3">
+                              <object class="GtkBox" id="hbox3">
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <property name="spacing">10</property>
@@ -951,12 +959,13 @@
               </packing>
             </child>
             <child>
-              <object class="GtkHBox" id="hbox5">
+              <object class="GtkBox" id="hbox5">
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <property name="spacing">2</property>
                 <child>
-                  <object class="GtkVBox" id="vbox5">
+                  <object class="GtkBox" id="vbox5">
+                    <property name="orientation">vertical</property>
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <child>
@@ -1003,7 +1012,8 @@
                   </packing>
                 </child>
                 <child>
-                  <object class="GtkVBox" id="vbox6">
+                  <object class="GtkBox" id="vbox6">
+                    <property name="orientation">vertical</property>
                     <property name="visible">True</property>
                     <property name="can_focus">False</property>
                     <property name="border_width">2</property>
@@ -1107,7 +1117,8 @@
               </packing>
             </child>
             <child>
-              <object class="GtkVBox" id="vbox3">
+              <object class="GtkBox" id="vbox3">
+                <property name="orientation">vertical</property>
                 <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <property name="border_width">6</property>
@@ -1209,7 +1220,8 @@
                               </packing>
                             </child>
                             <child>
-                              <object class="GtkVBox" id="vbox13">
+                              <object class="GtkBox" id="vbox13">
+                                <property name="orientation">vertical</property>
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <child>
@@ -1277,7 +1289,8 @@
                         <property name="can_focus">False</property>
                         <property name="left_padding">12</property>
                         <child>
-                          <object class="GtkVBox" id="vbox2">
+                          <object class="GtkBox" id="vbox2">
+                            <property name="orientation">vertical</property>
                             <property name="visible">True</property>
                             <property name="can_focus">False</property>
                             <child>
@@ -1347,7 +1360,8 @@
                             <property name="visible">True</property>
                             <property name="can_focus">False</property>
                             <child>
-                              <object class="GtkVBox" id="vbox8">
+                              <object class="GtkBox" id="vbox8">
+                                <property name="orientation">vertical</property>
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <property name="homogeneous">True</property>
@@ -1367,7 +1381,7 @@
                                   </packing>
                                 </child>
                                 <child>
-                                  <object class="GtkHBox" id="hbox8">
+                                  <object class="GtkBox" id="hbox8">
                                     <property name="visible">True</property>
                                     <property name="can_focus">False</property>
                                     <child>
@@ -1459,7 +1473,7 @@
                             <property name="yalign">0</property>
                             <property name="yscale">0</property>
                             <child>
-                              <object class="GtkHBox" id="hbox7">
+                              <object class="GtkBox" id="hbox7">
                                 <property name="visible">True</property>
                                 <property name="can_focus">False</property>
                                 <child>
diff --git a/plugins/batt/batt.c b/plugins/batt/batt.c
index cc7bfea..6eb6565 100644
--- a/plugins/batt/batt.c
+++ b/plugins/batt/batt.c
@@ -61,11 +61,19 @@ typedef struct {
         *chargingColor2,
         *dischargingColor1,
         *dischargingColor2;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA background,
+        charging1,
+        charging2,
+        discharging1,
+        discharging2;
+#else
     GdkColor background,
         charging1,
         charging2,
         discharging1,
         discharging2;
+#endif
     cairo_surface_t *pixmap;
     GtkContainer *box;
     GtkWidget *drawingArea;
@@ -233,7 +241,11 @@ void update_display(lx_battery *lx_b, gboolean repaint) {
     cairo_set_line_width (cr, 1.0);
 
     /* draw background */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_cairo_set_source_rgba(cr, &lx_b->background);
+#else
     gdk_cairo_set_source_color(cr, &lx_b->background);
+#endif
     cairo_rectangle(cr, 0, 0, lx_b->width, lx_b->height);
     cairo_fill(cr);
 
@@ -290,13 +302,23 @@ void update_display(lx_battery *lx_b, gboolean repaint) {
 
         /* Draw the battery bar vertically, using color 1 for the left half and
            color 2 for the right half */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_cairo_set_source_rgba(cr,
+                isCharging ? &lx_b->charging1 : &lx_b->discharging1);
+#else
         gdk_cairo_set_source_color(cr,
                 isCharging ? &lx_b->charging1 : &lx_b->discharging1);
+#endif
         cairo_rectangle(cr, 0, lx_b->height - chargeLevel,
                         lx_b->width / 2, chargeLevel);
         cairo_fill(cr);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_cairo_set_source_rgba(cr,
+                isCharging ? &lx_b->charging2 : &lx_b->discharging2);
+#else
         gdk_cairo_set_source_color(cr,
                 isCharging ? &lx_b->charging2 : &lx_b->discharging2);
+#endif
         cairo_rectangle(cr, lx_b->width / 2, lx_b->height - chargeLevel,
                         (lx_b->width + 1) / 2, chargeLevel);
         cairo_fill(cr);
@@ -306,12 +328,22 @@ void update_display(lx_battery *lx_b, gboolean repaint) {
 
         /* Draw the battery bar horizontally, using color 1 for the top half and
            color 2 for the bottom half */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_cairo_set_source_rgba(cr,
+                isCharging ? &lx_b->charging1 : &lx_b->discharging1);
+#else
         gdk_cairo_set_source_color(cr,
                 isCharging ? &lx_b->charging1 : &lx_b->discharging1);
+#endif
         cairo_rectangle(cr, 0, 0, chargeLevel, lx_b->height / 2);
         cairo_fill(cr);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_cairo_set_source_rgba(cr,
+                isCharging ? &lx_b->charging2 : &lx_b->discharging2);
+#else
         gdk_cairo_set_source_color(cr,
                 isCharging ? &lx_b->charging2 : &lx_b->discharging2);
+#endif
         cairo_rectangle(cr, 0, (lx_b->height + 1) / 2,
                         chargeLevel, lx_b->height / 2);
         cairo_fill(cr);
@@ -332,7 +364,9 @@ static int update_timout(lx_battery *lx_b) {
     battery *bat;
     if (g_source_is_destroyed(g_main_current_source()))
         return FALSE;
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GDK_THREADS_ENTER();
+#endif
     lx_b->state_elapsed_time++;
     lx_b->info_elapsed_time++;
 
@@ -347,7 +381,9 @@ static int update_timout(lx_battery *lx_b) {
 
     update_display( lx_b, TRUE );
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GDK_THREADS_LEAVE();
+#endif
     return TRUE;
 }
 
@@ -555,11 +591,19 @@ static GtkWidget * constructor(LXPanel *panel, config_setting_t *settings)
     if (! lx_b->dischargingColor2)
         lx_b->dischargingColor2 = g_strdup("#d9ca00");
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_rgba_parse(&lx_b->background, lx_b->backgroundColor);
+    gdk_rgba_parse(&lx_b->charging1, lx_b->chargingColor1);
+    gdk_rgba_parse(&lx_b->charging2, lx_b->chargingColor2);
+    gdk_rgba_parse(&lx_b->discharging1, lx_b->dischargingColor1);
+    gdk_rgba_parse(&lx_b->discharging2, lx_b->dischargingColor2);
+#else
     gdk_color_parse(lx_b->backgroundColor, &lx_b->background);
     gdk_color_parse(lx_b->chargingColor1, &lx_b->charging1);
     gdk_color_parse(lx_b->chargingColor2, &lx_b->charging2);
     gdk_color_parse(lx_b->dischargingColor1, &lx_b->discharging1);
     gdk_color_parse(lx_b->dischargingColor2, &lx_b->discharging2);
+#endif
 
     /* Start the update loop */
     lx_b->timer = g_timeout_add_seconds( 9, (GSourceFunc) update_timout, (gpointer) lx_b);
@@ -636,17 +680,37 @@ static gboolean applyConfig(gpointer user_data)
 
     /* Update colors */
     if (b->backgroundColor &&
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gdk_rgba_parse(&b->background, b->backgroundColor))
+#else
             gdk_color_parse(b->backgroundColor, &b->background))
+#endif
         config_group_set_string(b->settings, "BackgroundColor", b->backgroundColor);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (b->chargingColor1 && gdk_rgba_parse(&b->charging1, b->chargingColor1))
+#else
     if (b->chargingColor1 && gdk_color_parse(b->chargingColor1, &b->charging1))
+#endif
         config_group_set_string(b->settings, "ChargingColor1", b->chargingColor1);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (b->chargingColor2 && gdk_rgba_parse(&b->charging2, b->chargingColor2))
+#else
     if (b->chargingColor2 && gdk_color_parse(b->chargingColor2, &b->charging2))
+#endif
         config_group_set_string(b->settings, "ChargingColor2", b->chargingColor2);
     if (b->dischargingColor1 &&
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gdk_rgba_parse(&b->discharging1, b->dischargingColor1))
+#else
             gdk_color_parse(b->dischargingColor1, &b->discharging1))
+#endif
         config_group_set_string(b->settings, "DischargingColor1", b->dischargingColor1);
     if (b->dischargingColor2 &&
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gdk_rgba_parse(&b->discharging2, b->dischargingColor2))
+#else
             gdk_color_parse(b->dischargingColor2, &b->discharging2))
+#endif
         config_group_set_string(b->settings, "DischargingColor2", b->dischargingColor2);
 
     /* Make sure it is at least 1 px */
diff --git a/plugins/cpu/cpu.c b/plugins/cpu/cpu.c
index 8cf3c09..6f7580a 100644
--- a/plugins/cpu/cpu.c
+++ b/plugins/cpu/cpu.c
@@ -42,7 +42,6 @@
 #include "plugin.h"
 
 #define BORDER_SIZE 2
-#define PANEL_HEIGHT_DEFAULT 26 /* from panel defaults */
 
 /* #include "../../dbg.h" */
 
@@ -55,7 +54,13 @@ struct cpu_stat {
 
 /* Private context for CPU plugin. */
 typedef struct {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA foreground_color;			/* Foreground color for drawing area */
+    GdkRGBA background_color;			/* Background color for drawing area */
+#else
     GdkColor foreground_color;			/* Foreground color for drawing area */
+    GdkColor background_color;			/* Background color for drawing area */
+#endif
     GtkWidget * da;				/* Drawing area */
     cairo_surface_t * pixmap;				/* Pixmap to be drawn on drawing area */
 
@@ -65,6 +70,8 @@ typedef struct {
     guint pixmap_width;				/* Width of drawing area pixmap; also size of ring buffer; does not include border size */
     guint pixmap_height;			/* Height of drawing area pixmap; does not include border size */
     struct cpu_stat previous_cpu_stat;		/* Previous value of cpu_stat */
+    gboolean show_percentage;				/* Display usage as a percentage */
+    config_setting_t *settings;
 } CPUPlugin;
 
 static void redraw_pixmap(CPUPlugin * c);
@@ -81,18 +88,37 @@ static void cpu_destructor(gpointer user_data);
 /* Redraw after timer callback or resize. */
 static void redraw_pixmap(CPUPlugin * c)
 {
+#if !GTK_CHECK_VERSION(3, 0, 0)
+    GdkColor col;
+#endif
     cairo_t * cr = cairo_create(c->pixmap);
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkStyle * style = gtk_widget_get_style(c->da);
+#endif
     cairo_set_line_width (cr, 1.0);
     /* Erase pixmap. */
     cairo_rectangle(cr, 0, 0, c->pixmap_width, c->pixmap_height);
-    gdk_cairo_set_source_color(cr, &style->black);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    cairo_set_source_rgba(cr, c->background_color.blue,  c->background_color.green, c->background_color.red, c->background_color.alpha);
+#else
+    col.red = c->background_color.blue;
+    col.green = c->background_color.green;
+    col.blue = c->background_color.red;
+    gdk_cairo_set_source_color(cr, &col);
+#endif
     cairo_fill(cr);
 
     /* Recompute pixmap. */
     unsigned int i;
     unsigned int drawing_cursor = c->ring_cursor;
-    gdk_cairo_set_source_color(cr, &c->foreground_color);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    cairo_set_source_rgba(cr, c->foreground_color.blue,  c->foreground_color.green, c->foreground_color.red, c->foreground_color.alpha);
+#else
+    col.red = c->foreground_color.blue;
+    col.green = c->foreground_color.green;
+    col.blue = c->foreground_color.red;
+    gdk_cairo_set_source_color(cr, &col);
+#endif
     for (i = 0; i < c->pixmap_width; i++)
     {
         /* Draw one bar of the CPU usage graph. */
@@ -109,11 +135,37 @@ static void redraw_pixmap(CPUPlugin * c)
             drawing_cursor = 0;
     }
 
+    /* draw a border in black */
+    cairo_set_source_rgb(cr, 0, 0, 0);
+    cairo_set_line_width(cr, 1);
+    cairo_move_to(cr, 0, 0);
+    cairo_line_to(cr, 0, c->pixmap_height);
+    cairo_line_to(cr, c->pixmap_width, c->pixmap_height);
+    cairo_line_to(cr, c->pixmap_width, 0);
+    cairo_line_to(cr, 0, 0);
+    cairo_stroke(cr);
+
+    if (c->show_percentage)
+    {
+        int fontsize = 12;
+        if (c->pixmap_width > 50) fontsize = c->pixmap_height / 3;
+        char buffer[10];
+        int val = 100 * c->stats_cpu[c->ring_cursor ? c->ring_cursor - 1 : c->pixmap_width - 1];
+        sprintf (buffer, "%3d %%", val);
+        cairo_select_font_face (cr, "monospace", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_NORMAL);
+        cairo_set_font_size (cr, fontsize);
+        cairo_set_source_rgb (cr, 0, 0, 0);
+        cairo_move_to (cr, (c->pixmap_width >> 1) - ((fontsize * 5) / 3), ((c->pixmap_height + fontsize) >> 1) - 1);
+        cairo_show_text (cr, buffer);
+    }
+
     /* check_cairo_status(cr); */
     cairo_destroy(cr);
 
     /* Redraw pixmap. */
-    gtk_widget_queue_draw(c->da);
+    GdkPixbuf *pixbuf = gdk_pixbuf_new_from_data (cairo_image_surface_get_data (c->pixmap), GDK_COLORSPACE_RGB, TRUE, 8, c->pixmap_width, c->pixmap_height, c->pixmap_width *4, NULL, NULL);
+    gtk_image_set_from_pixbuf (GTK_IMAGE (c->da), pixbuf);
+    g_object_unref (pixbuf);
 }
 
 /* Periodic timer callback. */
@@ -125,13 +177,13 @@ static gboolean cpu_update(CPUPlugin * c)
     {
         /* Open statistics file and scan out CPU usage. */
         struct cpu_stat cpu;
-        FILE * stat = fopen("/proc/stat", "r");
-        if (stat == NULL)
-            return TRUE;
-        int fscanf_result = fscanf(stat, "cpu %llu %llu %llu %llu", &cpu.u, &cpu.n, &cpu.s, &cpu.i);
-        fclose(stat);
-
-        /* Ensure that fscanf succeeded. */
+        char buffer[256];
+        FILE *stat = fopen ("/proc/stat", "r");
+        if (stat == NULL) return TRUE;
+        fgets (buffer, 256, stat);
+        fclose (stat);
+        if (!buffer || !strlen (buffer)) return TRUE;
+        int fscanf_result = sscanf(buffer, "cpu %llu %llu %llu %llu", &cpu.u, &cpu.n, &cpu.s, &cpu.i);
         if (fscanf_result == 4)
         {
             /* Compute delta from previous statistics. */
@@ -160,14 +212,14 @@ static gboolean cpu_update(CPUPlugin * c)
 }
 
 /* Handler for configure_event on drawing area. */
-static gboolean configure_event(GtkWidget * widget, GdkEventConfigure * event, CPUPlugin * c)
+static void cpu_configuration_changed (LXPanel *panel, GtkWidget *p)
 {
-    GtkAllocation allocation;
+    CPUPlugin *c = lxpanel_plugin_get_data (p);
 
-    gtk_widget_get_allocation(widget, &allocation);
     /* Allocate pixmap and statistics buffer without border pixels. */
-    guint new_pixmap_width = MAX(allocation.width - BORDER_SIZE * 2, 0);
-    guint new_pixmap_height = MAX(allocation.height - BORDER_SIZE * 2, 0);
+    guint new_pixmap_height = panel_get_icon_size (panel) - (BORDER_SIZE << 1);
+    guint new_pixmap_width = (new_pixmap_height * 3) >> 1;
+    if (new_pixmap_width < 50) new_pixmap_width = 50;
     if ((new_pixmap_width > 0) && (new_pixmap_height > 0))
     {
         /* If statistics buffer does not exist or it changed size, reallocate and preserve existing data. */
@@ -218,7 +270,6 @@ static gboolean configure_event(GtkWidget * widget, GdkEventConfigure * event, C
         /* Redraw pixmap at the new size. */
         redraw_pixmap(c);
     }
-    return TRUE;
 }
 
 /* Handler for expose_event on drawing area. */
@@ -237,7 +288,7 @@ static gboolean draw(GtkWidget * widget, cairo_t * cr, CPUPlugin * c)
         GtkStyle * style = gtk_widget_get_style(c->da);
         gdk_cairo_region(cr, event->region);
         cairo_clip(cr);
-        gdk_cairo_set_source_color(cr, &style->black);
+        gdk_cairo_set_source_color(cr, &c->foreground_color);
 #else
         cairo_set_source_rgb(cr, 0, 0, 0); // FIXME: use black color from style
 #endif
@@ -258,6 +309,38 @@ static GtkWidget *cpu_constructor(LXPanel *panel, config_setting_t *settings)
     /* Allocate plugin context and set into Plugin private data pointer. */
     CPUPlugin * c = g_new0(CPUPlugin, 1);
     GtkWidget * p;
+    int tmp_int;
+    const char *str;
+
+	c->settings = settings;
+    if (config_setting_lookup_int(settings, "ShowPercent", &tmp_int))
+        c->show_percentage = tmp_int != 0;
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (config_setting_lookup_string(settings, "Foreground", &str))
+    {
+	if (!gdk_rgba_parse (&c->foreground_color, str))
+		gdk_rgba_parse(&c->foreground_color, "dark gray");
+    } else gdk_rgba_parse(&c->foreground_color, "dark gray");
+
+    if (config_setting_lookup_string(settings, "Background", &str))
+    {
+	if (!gdk_rgba_parse (&c->background_color, str))
+		gdk_rgba_parse(&c->background_color, "light gray");
+    } else gdk_rgba_parse(&c->background_color, "light gray");
+#else
+    if (config_setting_lookup_string(settings, "Foreground", &str))
+    {
+	if (!gdk_color_parse (str, &c->foreground_color))
+		gdk_color_parse("dark gray",  &c->foreground_color);
+    } else gdk_color_parse("dark gray",  &c->foreground_color);
+
+    if (config_setting_lookup_string(settings, "Background", &str))
+    {
+	if (!gdk_color_parse (str, &c->background_color))
+		gdk_color_parse("light gray",  &c->background_color);
+    } else gdk_color_parse("light gray",  &c->background_color);
+#endif
 
     /* Allocate top level widget and set into Plugin widget pointer. */
     p = gtk_event_box_new();
@@ -265,18 +348,12 @@ static GtkWidget *cpu_constructor(LXPanel *panel, config_setting_t *settings)
     lxpanel_plugin_set_data(p, c, cpu_destructor);
 
     /* Allocate drawing area as a child of top level widget. */
-    c->da = gtk_drawing_area_new();
+    c->da = gtk_image_new();
     gtk_widget_add_events(c->da, GDK_BUTTON_PRESS_MASK | GDK_BUTTON_RELEASE_MASK |
                                  GDK_BUTTON_MOTION_MASK);
-    gtk_widget_set_size_request(c->da, 40, PANEL_HEIGHT_DEFAULT);
     gtk_container_add(GTK_CONTAINER(p), c->da);
 
-    /* Clone a graphics context and set "green" as its foreground color.
-     * We will use this to draw the graph. */
-    gdk_color_parse("green",  &c->foreground_color);
-
     /* Connect signals. */
-    g_signal_connect(G_OBJECT(c->da), "configure-event", G_CALLBACK(configure_event), (gpointer) c);
 #if !GTK_CHECK_VERSION(3, 0, 0)
     g_signal_connect(G_OBJECT(c->da), "expose-event", G_CALLBACK(expose_event), (gpointer) c);
 #else
@@ -285,6 +362,7 @@ static GtkWidget *cpu_constructor(LXPanel *panel, config_setting_t *settings)
 
     /* Show the widget.  Connect a timer to refresh the statistics. */
     gtk_widget_show(c->da);
+    cpu_configuration_changed (panel,p);
     c->timer = g_timeout_add(1500, (GSourceFunc) cpu_update, (gpointer) c);
     return p;
 }
@@ -303,11 +381,45 @@ static void cpu_destructor(gpointer user_data)
     g_free(c);
 }
 
+static gboolean cpu_apply_configuration (gpointer user_data)
+{
+	char colbuf[32];
+    GtkWidget * p = user_data;
+    CPUPlugin * c = lxpanel_plugin_get_data(p);
+    config_group_set_int (c->settings, "ShowPercent", c->show_percentage);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    sprintf (colbuf, "%s", gdk_rgba_to_string (&c->foreground_color));
+#else
+    sprintf (colbuf, "%s", gdk_color_to_string (&c->foreground_color));
+#endif
+    config_group_set_string (c->settings, "Foreground", colbuf);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    sprintf (colbuf, "%s", gdk_rgba_to_string (&c->background_color));
+#else
+    sprintf (colbuf, "%s", gdk_color_to_string (&c->background_color));
+#endif
+    config_group_set_string (c->settings, "Background", colbuf);
+}
+
+/* Callback when the configuration dialog is to be shown. */
+static GtkWidget *cpu_configure(LXPanel *panel, GtkWidget *p)
+{
+    CPUPlugin * dc = lxpanel_plugin_get_data(p);
+    return lxpanel_generic_config_dlg(_("CPU Usage"), panel,
+        cpu_apply_configuration, p,
+        _("Show usage as percentage"), &dc->show_percentage, CONF_TYPE_BOOL,
+        _("Foreground colour"), &dc->foreground_color, CONF_TYPE_COLOR,
+        _("Background colour"), &dc->background_color, CONF_TYPE_COLOR,
+        NULL);
+}
+
 FM_DEFINE_MODULE(lxpanel_gtk, cpu)
 
 /* Plugin descriptor. */
 LXPanelPluginInit fm_module_init_lxpanel_gtk = {
     .name = N_("CPU Usage Monitor"),
+    .config = cpu_configure,
     .description = N_("Display CPU usage"),
     .new_instance = cpu_constructor,
+    .reconfigure = cpu_configuration_changed,
 };
diff --git a/plugins/dclock.c b/plugins/dclock.c
index 1a7fe18..df16076 100644
--- a/plugins/dclock.c
+++ b/plugins/dclock.c
@@ -46,6 +46,8 @@
 #define DEFAULT_TIP_FORMAT    "%A %x"
 #define DEFAULT_CLOCK_FORMAT  "%R"
 
+#define CLOCK_TEXT_PAD    6
+
 /* Private context for digital clock plugin. */
 typedef struct {
     GtkWidget * plugin;				/* Back pointer to plugin */
@@ -59,7 +61,7 @@ typedef struct {
     char * action;				/* Command to execute on a click */
     gboolean bold;				/* True if bold font */
     gboolean icon_only;				/* True if icon only (no clock value) */
-    gboolean center_text;
+    int center_text;
     guint timer;				/* Timer for periodic update */
     enum {
 	AWAITING_FIRST_CHANGE,			/* Experimenting to determine interval, waiting for first change */
@@ -77,6 +79,105 @@ static void dclock_destructor(gpointer user_data);
 static gboolean dclock_apply_configuration(gpointer user_data);
 static void dclock_on_panel_reconfigured(LXPanel *panel, GtkWidget *p);
 
+/* calculates how long (in pixels) a widget needs to be to hold the worst-case time in the current 24 hour period */
+static void set_clock_length (DClockPlugin *dc)
+{
+    struct timeval now;
+    struct tm *current_time;
+    int digit, maxval, maxdig, maxmin;
+    char clock_value[64];
+    GtkRequisition req;
+
+    // get today's date
+    gettimeofday (&now, NULL);
+    current_time = localtime (&now.tv_sec);
+
+        gtk_widget_set_size_request (dc->clock_label, -1,-1);
+    // find the longest digit
+    maxval = 0;
+    maxdig = 0;
+    for (digit = 0; digit < 10; digit++)
+    {
+        current_time->tm_min = digit;
+        strftime (clock_value, sizeof (clock_value), dc->clock_format, current_time);
+        gtk_label_set_text (GTK_LABEL (dc->clock_label), clock_value);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_get_preferred_size(dc->clock_label, NULL, &req);
+#else
+        gtk_widget_size_request (dc->clock_label, &req);
+#endif
+        if (req.width > maxval)
+        {
+            maxval = req.width;
+            maxdig = digit;
+        }
+    }
+
+    // maxdig now holds the widest digit - find the widest integer 00 - 59 for min and sec
+
+    if (maxdig < 6) maxmin = 10 * maxdig + maxdig;
+    else
+    {
+        maxmin = 0;
+        maxval = 0;
+        for (digit = 0; digit < 6; digit++)
+        {
+            current_time->tm_min = 10 * digit + maxdig;
+            strftime (clock_value, sizeof (clock_value), dc->clock_format, current_time);
+            gtk_label_set_text (GTK_LABEL (dc->clock_label), clock_value);
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_widget_get_preferred_size(dc->clock_label, NULL, &req);
+#else
+            gtk_widget_size_request (dc->clock_label, &req);
+#endif
+            if (req.width > maxval)
+            {
+                maxval = req.width;
+                maxmin = current_time->tm_min;
+            }
+        }
+    }
+
+    // maxmin now holds the longest minute and second value - find the longest hour, incl am and pm
+
+    current_time->tm_min = maxmin;
+    current_time->tm_sec = maxmin;
+    maxval = 0;
+    for (digit = 0; digit < 23; digit++)
+    {
+        current_time->tm_hour = digit;
+        strftime (clock_value, sizeof (clock_value), dc->clock_format, current_time);
+        gtk_label_set_text (GTK_LABEL (dc->clock_label), clock_value);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_get_preferred_size(dc->clock_label, NULL, &req);
+#else
+        gtk_widget_size_request (dc->clock_label, &req);
+#endif
+        if (req.width > maxval)
+        {
+            maxval = req.width;
+        }
+    }
+
+    // maxval is now width in pixels of longest time today...
+
+    // put the clock back to where it should be
+    gettimeofday (&now, NULL);
+    current_time = localtime (&now.tv_sec);
+    strftime (clock_value, sizeof (clock_value), dc->clock_format, current_time);
+    gtk_label_set_text (GTK_LABEL (dc->clock_label), clock_value);
+    gtk_widget_set_size_request (dc->clock_label, maxval + CLOCK_TEXT_PAD, -1);
+}
+
+/* Handler for "focus-out" signal on popup window. */
+static gboolean dclock_popup_focus_out(GtkWidget * widget, GdkEvent * event, DClockPlugin * dc)
+{
+    /* Hide the widget. */
+    gtk_widget_destroy(dc->calendar_window);
+    dc->calendar_window = NULL;
+    return FALSE;
+}
+
 /* Display a window containing the standard calendar widget. */
 static GtkWidget * dclock_create_calendar(DClockPlugin * dc)
 {
@@ -90,11 +191,20 @@ static GtkWidget * dclock_create_calendar(DClockPlugin * dc)
     gtk_container_set_border_width(GTK_CONTAINER(win), 5);
     gtk_window_set_skip_taskbar_hint(GTK_WINDOW(win), TRUE);
     gtk_window_set_skip_pager_hint(GTK_WINDOW(win), TRUE);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_window_set_type_hint(GTK_WINDOW(win), GDK_WINDOW_TYPE_HINT_DROPDOWN_MENU);
+    gtk_widget_set_name (win, "panelpopup");
+#else
     gtk_window_set_type_hint(GTK_WINDOW(win), GDK_WINDOW_TYPE_HINT_DIALOG);
+#endif
     gtk_window_stick(GTK_WINDOW(win));
 
     /* Create a vertical box as a child of the window. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * box = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
+#else
     GtkWidget * box = gtk_vbox_new(FALSE, 0);
+#endif
     gtk_container_add(GTK_CONTAINER(win), GTK_WIDGET(box));
 
     /* Create a standard calendar widget as a child of the vertical box. */
@@ -109,6 +219,9 @@ static GtkWidget * dclock_create_calendar(DClockPlugin * dc)
     lxpanel_plugin_popup_set_position_helper(dc->panel, dc->plugin, win, &x, &y);
     gtk_window_move(GTK_WINDOW(win), x, y);
 
+    /* Connect signals. */
+    g_signal_connect(G_OBJECT(win), "focus-out-event", G_CALLBACK(dclock_popup_focus_out), dc);
+
     /* Return the widget. */
     return win;
 }
@@ -131,8 +244,13 @@ static gboolean dclock_button_press_event(GtkWidget * widget, GdkEventButton * e
     {
         if (dc->calendar_window == NULL)
         {
-            dc->calendar_window = dclock_create_calendar(dc);
-            gtk_widget_show_all(dc->calendar_window);
+            gint x, y;
+            dc->calendar_window = dclock_create_calendar (dc);
+            gtk_window_iconify (GTK_WINDOW (dc->calendar_window));
+            gtk_widget_show_all (dc->calendar_window);
+            lxpanel_plugin_popup_set_position_helper (panel, widget, dc->calendar_window, &x, &y);
+            gdk_window_move (gtk_widget_get_window (dc->calendar_window), x, y);
+            gtk_window_present (GTK_WINDOW (dc->calendar_window));
         }
         else
         {
@@ -169,6 +287,21 @@ static void dclock_timer_set(DClockPlugin * dc, struct timeval *current_time)
     dc->timer = g_timeout_add(milliseconds, (GSourceFunc) dclock_update_display, (gpointer) dc);
 }
 
+/* Compare length and content of two strings to see how much they have in common */
+static int strdiff (char *str1, char *str2)
+{
+    int index, diffs = 0;
+    int l1 = strlen (str1);
+    int l2 = strlen (str2);
+
+    if (l1 != l2) return 1;
+    for (index = 0; index < l1; index++)
+        if (str1[index] != str2[index]) diffs++;
+
+    if (diffs > 3) return 1;
+    return 0;
+}
+
 /* Periodic timer callback.
  * Also used during initialization and configuration change to do a redraw. */
 static gboolean dclock_update_display(DClockPlugin * dc)
@@ -199,6 +332,12 @@ static gboolean dclock_update_display(DClockPlugin * dc)
     if (( ! dc->icon_only)
     && ((dc->prev_clock_value == NULL) || (strcmp(dc->prev_clock_value, clock_value) != 0)))
     {
+        // update the text widget length if the contents have changed significantly....
+        if (dc->prev_clock_value == NULL || strdiff (clock_value, dc->prev_clock_value))
+        {
+            set_clock_length (dc);
+        }
+
         /* Convert "\n" escapes in the user's format string to newline characters. */
         char * newlines_converted = NULL;
         if (strstr(clock_value, "\\n") != NULL)
@@ -311,26 +450,37 @@ static GtkWidget *dclock_constructor(LXPanel *panel, config_setting_t *settings)
     if (config_setting_lookup_int(settings, "IconOnly", &tmp_int))
         dc->icon_only = tmp_int != 0;
     if (config_setting_lookup_int(settings, "CenterText", &tmp_int))
-        dc->center_text = tmp_int != 0;
+        dc->center_text = tmp_int;
 
     /* Save construction pointers */
     dc->panel = panel;
     dc->settings = settings;
 
     /* Allocate top level widget and set into Plugin widget pointer. */
-    dc->plugin = p = gtk_event_box_new();
+    dc->plugin = p = gtk_button_new();
+    gtk_button_set_relief (GTK_BUTTON (dc->plugin), GTK_RELIEF_NONE);
     lxpanel_plugin_set_data(p, dc, dclock_destructor);
 
     /* Allocate a horizontal box as the child of the top level. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+    gtk_box_set_homogeneous (GTK_BOX(hbox), TRUE);
+#else
     GtkWidget * hbox = gtk_hbox_new(TRUE, 0);
+#endif
     gtk_container_add(GTK_CONTAINER(p), hbox);
     gtk_widget_show(hbox);
 
     /* Create a label and an image as children of the horizontal box.
      * Only one of these is visible at a time, controlled by user preference. */
     dc->clock_label = gtk_label_new(NULL);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (dc->clock_label, 4);
+    gtk_widget_set_margin_end (dc->clock_label, 4);
+#else
     gtk_misc_set_alignment(GTK_MISC(dc->clock_label), 0.5, 0.5);
     gtk_misc_set_padding(GTK_MISC(dc->clock_label), 4, 0);
+#endif
     gtk_container_add(GTK_CONTAINER(hbox), dc->clock_label);
     dc->clock_icon = lxpanel_image_new_for_icon(panel, "clock", -1, NULL);
     gtk_container_add(GTK_CONTAINER(hbox), dc->clock_icon);
@@ -389,16 +539,27 @@ static gboolean dclock_apply_configuration(gpointer user_data)
     {
         gtk_widget_show(dc->clock_label);
         gtk_widget_hide(dc->clock_icon);
+        set_clock_length (dc);
     }
 
-    if (dc->center_text)
-    {
-        gtk_label_set_justify(GTK_LABEL(dc->clock_label), GTK_JUSTIFY_CENTER);
-    }
+    if (dc->center_text == 2)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_label_set_xalign (GTK_LABEL(dc->clock_label), 1.0);
+#else
+        gtk_misc_set_alignment(GTK_MISC(dc->clock_label), 1.0, 0.5);
+#endif
+    else if (dc->center_text == 1)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_label_set_xalign (GTK_LABEL(dc->clock_label), 0.5);
+#else
+        gtk_misc_set_alignment(GTK_MISC(dc->clock_label), 0.5, 0.5);
+#endif
     else
-    {
-        gtk_label_set_justify(GTK_LABEL(dc->clock_label), GTK_JUSTIFY_LEFT);
-    }
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_label_set_xalign (GTK_LABEL(dc->clock_label), 0.0);
+#else
+        gtk_misc_set_alignment(GTK_MISC(dc->clock_label), 0.0, 0.5);
+#endif
 
     /* Rerun the experiment to determine update interval and update the display. */
     g_free(dc->prev_clock_value);
@@ -436,9 +597,12 @@ static GtkWidget *dclock_configure(LXPanel *panel, GtkWidget *p)
         _("Tooltip Format"), &dc->tooltip_format, CONF_TYPE_STR,
         _("Format codes: man 3 strftime; %n for line break"), NULL, CONF_TYPE_TRIM,
         _("Action when clicked (default: display calendar)"), &dc->action, CONF_TYPE_STR,
-        _("Bold font"), &dc->bold, CONF_TYPE_BOOL,
+        //_("Bold font"), &dc->bold, CONF_TYPE_BOOL,
         _("Tooltip only"), &dc->icon_only, CONF_TYPE_BOOL,
-        _("Center text"), &dc->center_text, CONF_TYPE_BOOL,
+        //_("Center text"), &dc->center_text, CONF_TYPE_BOOL,
+        _("Left align"), &dc->center_text, CONF_TYPE_RBUTTON,
+        _("Center text"), &dc->center_text, CONF_TYPE_RBUTTON,
+        _("Right align"), &dc->center_text, CONF_TYPE_RBUTTON,
         NULL);
 }
 
diff --git a/plugins/dirmenu.c b/plugins/dirmenu.c
index c7dbfbd..f5d3351 100644
--- a/plugins/dirmenu.c
+++ b/plugins/dirmenu.c
@@ -125,12 +125,20 @@ static GtkWidget * dirmenu_create_menu(DirMenuPlugin * dm, const char * path, gb
     {
         int w;
         int h;
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_icon_size_lookup (GTK_ICON_SIZE_MENU, &w, &h);
+#else
         gtk_icon_size_lookup_for_settings(gtk_widget_get_settings(menu), GTK_ICON_SIZE_MENU, &w, &h);
+#endif
         dm->folder_icon = gtk_icon_theme_load_icon(
             panel_get_icon_theme(dm->panel),
             "gnome-fs-directory", MAX(w, h), 0, NULL);
         if (dm->folder_icon == NULL)
+#if GTK_CHECK_VERSION(3, 0, 0)
+            dm->folder_icon = gtk_icon_theme_load_icon(panel_get_icon_theme(dm->panel), "gtk-directory", MAX(w, h), 0, NULL);
+#else
             dm->folder_icon = gtk_widget_render_icon(menu, GTK_STOCK_DIRECTORY, GTK_ICON_SIZE_MENU, NULL);
+#endif
     }
 
     g_object_set_data_full(G_OBJECT(menu), "path", g_strdup(path), g_free);
@@ -188,10 +196,14 @@ static GtkWidget * dirmenu_create_menu(DirMenuPlugin * dm, const char * path, gb
     while ((dir_cursor = dir_list) != NULL)
     {
         /* Create and initialize menu item. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        GtkWidget * item = gtk_menu_item_new_with_label(dir_cursor->directory_name);
+#else
         GtkWidget * item = gtk_image_menu_item_new_with_label(dir_cursor->directory_name);
         gtk_image_menu_item_set_image(
             GTK_IMAGE_MENU_ITEM(item),
             gtk_image_new_from_stock(GTK_STOCK_DIRECTORY, GTK_ICON_SIZE_MENU));
+#endif
         GtkWidget * dummy = gtk_menu_new();
         gtk_menu_item_set_submenu(GTK_MENU_ITEM(item), dummy);
         gtk_menu_shell_append(GTK_MENU_SHELL(menu), item);
@@ -208,7 +220,11 @@ static GtkWidget * dirmenu_create_menu(DirMenuPlugin * dm, const char * path, gb
     }
 
     /* Create "Open" and "Open in Terminal" items. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * item = gtk_menu_item_new_with_mnemonic( _("_Open") );
+#else
     GtkWidget * item = gtk_image_menu_item_new_from_stock( GTK_STOCK_OPEN, NULL );
+#endif
     g_signal_connect(item, "activate", G_CALLBACK(dirmenu_menuitem_open_directory), dm);
     GtkWidget * term = gtk_menu_item_new_with_mnemonic( _("Open in _Terminal") );
     g_signal_connect(term, "activate", G_CALLBACK(dirmenu_menuitem_open_in_terminal), dm);
@@ -239,7 +255,11 @@ static void dirmenu_show_menu(GtkWidget * widget, DirMenuPlugin * dm, int btn, g
     g_signal_connect(menu, "selection-done", G_CALLBACK(dirmenu_menu_selection_done), dm);
 
     /* Show the menu.  Use a positioning function to get it placed next to the top level widget. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_menu_popup_at_pointer (GTK_MENU(menu), NULL);
+#else
     gtk_menu_popup(GTK_MENU(menu), NULL, NULL, (GtkMenuPositionFunc) dirmenu_popup_set_position, widget, btn, time);
+#endif
 }
 
 /* Handler for button-press-event on top level widget. */
diff --git a/plugins/launch-button.c b/plugins/launch-button.c
index 1e6fbe0..a53fede 100644
--- a/plugins/launch-button.c
+++ b/plugins/launch-button.c
@@ -24,13 +24,14 @@
 #include "misc.h"
 
 #include <string.h>
+#include <gio/gdesktopappinfo.h>
 
 /* Representative of one launch button.
  * Note that the launch parameters come from the specified desktop file, or from the configuration file.
  * This structure is also used during the "add to launchtaskbar" dialog to hold menu items. */
 struct _LaunchButton
 {
-    GtkEventBox parent;
+    GtkButton parent;
     LXPanel * panel;                    /* Back pointer to panel (grandparent widget) */
     GtkWidget * plugin;                 /* Back pointer to the plugin */
     FmJob * job;                        /* Async job to retrieve file info */
@@ -63,6 +64,11 @@ static void launch_button_job_finished(FmJob *job, LaunchButton *self)
         g_warning("launchbar: desktop entry does not exist");
         return;
     }
+    if (g_desktop_app_info_new (fm_file_info_get_name (self->fi)) == NULL)
+    {
+        g_warning("launchbar: application in desktop entry is not valid");
+        return;
+    }
     image = lxpanel_image_new_for_fm_icon(self->panel, fm_file_info_get_icon(self->fi),
                                           -1, NULL);
     lxpanel_button_compose(GTK_WIDGET(self), image, NULL, NULL);
@@ -74,7 +80,7 @@ static void launch_button_job_finished(FmJob *job, LaunchButton *self)
  * Class implementation
  */
 
-G_DEFINE_TYPE(LaunchButton, launch_button, GTK_TYPE_EVENT_BOX)
+G_DEFINE_TYPE(LaunchButton, launch_button, GTK_TYPE_BUTTON)
 
 static void launch_button_dispose(GObject *object)
 {
@@ -114,6 +120,11 @@ static gboolean launch_button_release_event(GtkWidget *widget, GdkEventButton *e
     return FALSE;
 }
 
+static gboolean launch_button_press_event(GtkWidget *widget, GdkEventButton *event)
+{
+	return FALSE;
+}
+
 static void launch_button_init(LaunchButton *self)
 {
     gtk_container_set_border_width(GTK_CONTAINER(self), 0);
@@ -127,6 +138,7 @@ static void launch_button_class_init(LaunchButtonClass *klass)
 
     object_class->dispose = launch_button_dispose;
     widget_class->button_release_event = launch_button_release_event;
+    widget_class->button_press_event = launch_button_press_event;
 }
 
 
@@ -147,7 +159,7 @@ LaunchButton *launch_button_new(LXPanel *panel, GtkWidget *plugin, FmPath *id,
     if (id == NULL)
     {
         /* a bootstrap button */
-        image = lxpanel_image_new_for_icon(panel, GTK_STOCK_ADD, -1, NULL);
+        image = lxpanel_image_new_for_icon(panel, "gtk-add", -1, NULL);
         lxpanel_button_compose(GTK_WIDGET(self), image, NULL, NULL);
     }
     else
@@ -240,3 +252,8 @@ gboolean launch_button_wait_load(LaunchButton *btn)
     gtk_widget_destroy(GTK_WIDGET(btn));
     return FALSE;
 }
+
+void launch_button_update_icon (LaunchButton *btn, int size)
+{
+    if (btn->fi) lxpanel_button_update_icon (GTK_WIDGET(btn), fm_file_info_get_icon(btn->fi), size);
+}
diff --git a/plugins/launch-button.h b/plugins/launch-button.h
index d84bc9b..e7c3243 100644
--- a/plugins/launch-button.h
+++ b/plugins/launch-button.h
@@ -42,7 +42,7 @@ typedef struct _LaunchButtonClass           LaunchButtonClass;
 
 struct _LaunchButtonClass
 {
-    GtkEventBoxClass parent_class;
+    GtkButtonClass parent_class;
 };
 
 /* creates new button */
@@ -53,6 +53,7 @@ FmIcon *launch_button_get_icon(LaunchButton *btn);
 config_setting_t *launch_button_get_settings(LaunchButton *btn);
 void launch_button_set_settings(LaunchButton *btn, config_setting_t *settings);
 gboolean launch_button_wait_load(LaunchButton *btn);
+void launch_button_update_icon (LaunchButton *btn, int size);
 
 G_END_DECLS
 
diff --git a/plugins/launchtaskbar.c b/plugins/launchtaskbar.c
index 0b35d0f..303d8df 100644
--- a/plugins/launchtaskbar.c
+++ b/plugins/launchtaskbar.c
@@ -152,6 +152,7 @@ struct LaunchTaskBarPlugin {
     int              w, h;              /* override GtkBox bug with allocation */
 };
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
 static gchar *launchtaskbar_rc = "style 'launchtaskbar-style' = 'theme-panel'\n"
         "{\n"
         "GtkWidget::focus-padding=0\n"
@@ -161,6 +162,7 @@ static gchar *launchtaskbar_rc = "style 'launchtaskbar-style' = 'theme-panel'\n"
         "}\n"
         "widget '*launchbar.*' style 'launchtaskbar-style'\n"
         "widget '*taskbar.*' style 'launchtaskbar-style'";
+#endif
 
 #define DRAG_ACTIVE_DELAY    1000
 #define TASK_WIDTH_MAX       200
@@ -991,6 +993,12 @@ static void reset_timer_on_task(LaunchTaskBarPlugin *tb)
                                          on_gtk_cursor_blink_time_changed, tb);
 }
 
+static gboolean init_flash_timer (gpointer user_data)
+{
+    LaunchTaskBarPlugin *tb = (LaunchTaskBarPlugin *) user_data;
+    set_timer_on_task(tb);
+    return FALSE;
+}
 
 static void launchtaskbar_constructor_task(LaunchTaskBarPlugin *ltbp)
 {
@@ -1051,7 +1059,7 @@ static void launchtaskbar_constructor_task(LaunchTaskBarPlugin *ltbp)
 
         /* Start blinking timeout if configured */
         if (ltbp->flags.use_urgency_hint)
-            set_timer_on_task(ltbp);
+            g_idle_add (init_flash_timer, ltbp);   // need to delay start due to potential race condition
 
         /* Fetch the client list and redraw the taskbar.  Then determine what window has focus. */
         taskbar_net_client_list(NULL, ltbp);
@@ -1090,7 +1092,9 @@ static GtkWidget *_launchtaskbar_constructor(LXPanel *panel, config_setting_t *s
     LaunchTaskBarPlugin *ltbp;
     int height;
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_rc_parse_string(launchtaskbar_rc);
+#endif
 
     /* Allocate plugin context and set into Plugin private data pointer. */
     ltbp = g_new0(LaunchTaskBarPlugin, 1);
@@ -1120,12 +1124,16 @@ static GtkWidget *_launchtaskbar_constructor(LXPanel *panel, config_setting_t *s
                                    special_cases_filepath,
                                    G_KEY_FILE_KEEP_COMMENTS, NULL))
     {
-        launchtaskbar_constructor_add_default_special_case(ltbp, "synaptic", "synaptic-pkexec");
-        launchtaskbar_constructor_add_default_special_case(ltbp, "soffice.bin", "libreoffice");
-        launchtaskbar_constructor_add_default_special_case(ltbp, "x-terminal-emulator", "lxterminal");
-        gchar *key_file_data = g_key_file_to_data(ltbp->p_key_file_special_cases, NULL, NULL);
-        g_file_set_contents(special_cases_filepath, key_file_data, -1, NULL);
-        g_free(key_file_data);
+        // try the global location...
+        if (!g_key_file_load_from_file(ltbp->p_key_file_special_cases, "/etc/xdg/lxpanel/launchtaskbar.cfg", G_KEY_FILE_KEEP_COMMENTS, NULL))
+        {
+            launchtaskbar_constructor_add_default_special_case(ltbp, "synaptic", "synaptic-pkexec");
+            launchtaskbar_constructor_add_default_special_case(ltbp, "soffice.bin", "libreoffice");
+            launchtaskbar_constructor_add_default_special_case(ltbp, "x-terminal-emulator", "lxterminal");
+            gchar *key_file_data = g_key_file_to_data(ltbp->p_key_file_special_cases, NULL, NULL);
+            g_file_set_contents(special_cases_filepath, key_file_data, -1, NULL);
+            g_free(key_file_data);
+        }
     }
     g_free(special_cases_filepath);
 
@@ -1140,7 +1148,7 @@ static GtkWidget *_launchtaskbar_constructor(LXPanel *panel, config_setting_t *s
     gtk_box_pack_start(GTK_BOX(p), ltbp->lb_icon_grid, FALSE, TRUE, 0);
 
     /* Setup override on GtkBox bug */
-    g_signal_connect(p, "size-allocate", G_CALLBACK(on_size_allocation), ltbp);
+    //g_signal_connect(p, "size-allocate", G_CALLBACK(on_size_allocation), ltbp);
 
     /* Read parameters from the configuration file. */
     config_setting_lookup_int(settings, "LaunchTaskBarMode", &ltbp->mode);
@@ -1847,10 +1855,18 @@ static void launchtaskbar_panel_configuration_changed(LXPanel *panel, GtkWidget
     int height = panel_get_height(panel);
 
     if (ltbp->lb_built)
+    {
+        GList *l;
+        for (l = gtk_container_get_children(GTK_CONTAINER(ltbp->lb_icon_grid)); l != NULL; l = l->next)
+        {
+            LaunchButton *btn = (LaunchButton *) l->data;
+            launch_button_update_icon (btn, new_icon_size - ICON_BUTTON_TRIM);
+        }
         panel_icon_grid_set_geometry(PANEL_ICON_GRID(ltbp->lb_icon_grid),
                                      panel_get_orientation(panel),
                                      new_icon_size, new_icon_size,
                                      3, 0, height);
+    }
 
     /* Redraw all the labels.  Icon size or font color may have changed. */
     if (ltbp->tb_built)
@@ -1859,7 +1875,11 @@ static void launchtaskbar_panel_configuration_changed(LXPanel *panel, GtkWidget
         panel_icon_grid_set_geometry(PANEL_ICON_GRID(ltbp->tb_icon_grid),
             panel_get_orientation(panel),
             ((ltbp->flags.icons_only) ? ltbp->icon_size + ICON_ONLY_EXTRA : ltbp->task_width_max),
+#if GTK_CHECK_VERSION(3, 0, 0)
+            ((ltbp->flags.icons_only) ? ltbp->icon_size + ICON_ONLY_EXTRA : ltbp->icon_size),
+#else
             ((ltbp->flags.icons_only) ? ltbp->icon_size + ICON_ONLY_EXTRA : ltbp->icon_size + ICON_BUTTON_TRIM),
+#endif
             ltbp->spacing, 0, height);
         taskbar_reset_menu(ltbp);
         taskbar_redraw(ltbp);
@@ -1888,6 +1908,19 @@ static gboolean launchtaskbar_control(GtkWidget *p, const char *cmd)
                 config_setting_destroy(s);
         }
     }
+    if (ltbp->mode == TASKBAR)
+    {
+        if (strncmp(cmd, "mtw", 3) == 0)
+        {
+            int val;
+            if (sscanf (cmd, "mtw%d", &val) == 1 && val > 0 && val < 500)
+            {
+                ltbp->task_width_max = val;
+                taskbar_redraw (ltbp);
+                return TRUE;
+            }
+        }
+    }
     return FALSE;
 }
 
diff --git a/plugins/menu.c b/plugins/menu.c
index efe67b0..8166189 100644
--- a/plugins/menu.c
+++ b/plugins/menu.c
@@ -78,6 +78,7 @@ typedef struct {
     GtkWidget *menu, *box, *img, *label;
     char *fname, *caption;
     int iconsize;
+    int padding;
     gboolean has_system_menu;
     guint show_system_menu_idle;
     LXPanel *panel;
@@ -160,6 +161,8 @@ static void
 menu_pos(GtkMenu *menu, gint *x, gint *y, gboolean *push_in, GtkWidget *widget)
 {
     menup *m = lxpanel_plugin_get_data(widget);
+    int mon = panel_get_monitor (m->panel);
+    gtk_menu_set_monitor (menu, mon == -1 ? 0 : mon);
     lxpanel_plugin_popup_set_position_helper(m->panel, widget, GTK_WIDGET(menu), x, y);
     *push_in = TRUE;
 }
@@ -174,7 +177,12 @@ static void on_menu_item( GtkMenuItem* mi, menup* m )
 /* load icon when mapping the menu item to speed up */
 static void on_menu_item_map(GtkWidget *mi, menup *m)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GList *children = gtk_container_get_children (GTK_CONTAINER (gtk_bin_get_child (GTK_BIN (mi))));
+  GtkImage *img = children->data;  // this should always be the image...
+#else
   GtkImage* img = GTK_IMAGE(gtk_image_menu_item_get_image(GTK_IMAGE_MENU_ITEM(mi)));
+#endif
     if( img )
     {
         FmFileInfo *fi;
@@ -356,7 +364,6 @@ static gboolean on_menu_button_press(GtkWidget* mi, GdkEventButton* evt, menup*
         }
 
         p = GTK_MENU(gtk_menu_new());
-
         item = gtk_menu_item_new_with_label(_("Add to desktop"));
         g_signal_connect(item, "activate", G_CALLBACK(on_add_menu_item_to_desktop), mi);
         gtk_menu_shell_append(GTK_MENU_SHELL(p), item);
@@ -411,13 +418,29 @@ static GtkWidget* create_item(MenuCacheItem *item, menup *m)
 
         g_free(mpath);
         fm_path_unref(path);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        GtkWidget *box, *label;
+        mi = gtk_menu_item_new ();
+        box = gtk_box_new (GTK_ORIENTATION_HORIZONTAL, MENU_ICON_SPACE);
+        gtk_container_add (GTK_CONTAINER (mi), box);
+        label = gtk_label_new (menu_cache_item_get_name (item));
+        g_object_set_qdata_full(G_OBJECT(mi), SYS_MENU_ITEM_ID, fi,
+                                (GDestroyNotify)fm_file_info_unref);
+        img = gtk_image_new ();
+        gtk_container_add (GTK_CONTAINER (box), img);
+        gtk_container_add (GTK_CONTAINER (box), label);
+        gtk_widget_show_all (box);
+#else
         mi = gtk_image_menu_item_new_with_mnemonic( menu_cache_item_get_name(item) );
+        gtk_image_menu_item_set_always_show_image (GTK_IMAGE_MENU_ITEM (mi), TRUE);
         g_object_set_qdata_full(G_OBJECT(mi), SYS_MENU_ITEM_ID, fi,
                                 (GDestroyNotify)fm_file_info_unref);
         img = gtk_image_new();
         gtk_image_menu_item_set_image( GTK_IMAGE_MENU_ITEM(mi), img );
+#endif
         if( menu_cache_item_get_type(item) == MENU_CACHE_TYPE_APP )
         {
+            gtk_widget_set_name (mi, "syssubmenu");
             const char *comment = menu_cache_item_get_comment(item);
             if (comment != NULL)
                 gtk_widget_set_tooltip_text(mi, comment);
@@ -434,6 +457,16 @@ static GtkWidget* create_item(MenuCacheItem *item, menup *m)
     return mi;
 }
 
+gboolean check_close (GtkWidget *widget, GdkEventKey *event, gpointer userdata)
+{
+    if (event->keyval == 65515 && event->state == 0)
+    {
+        gtk_menu_popdown (GTK_MENU (userdata));
+        return TRUE;
+    }
+    return FALSE;
+}
+
 static int load_menu(menup* m, MenuCacheDir* dir, GtkWidget* menu, int pos )
 {
     GSList * l;
@@ -485,8 +518,13 @@ static int load_menu(menup* m, MenuCacheDir* dir, GtkWidget* menu, int pos )
 	    if (menu_cache_item_get_type(item) == MENU_CACHE_TYPE_DIR)
 	    {
                 GtkWidget* sub = gtk_menu_new();
+#if GTK_CHECK_VERSION(3, 0, 0)
+                gtk_menu_set_reserve_toggle_size (GTK_MENU (sub), FALSE);
+#endif
+            g_signal_connect(sub, "key-press-event", G_CALLBACK(check_close), m->menu);
 		/*  always pass -1 for position */
 		gint s_count = load_menu( m, MENU_CACHE_DIR(item), sub, -1 );
+                if (s_count) gtk_widget_set_name (mi, "sysmenu");
                 if (s_count)
 		    gtk_menu_item_set_submenu( GTK_MENU_ITEM(mi), sub );
 		else
@@ -528,6 +566,22 @@ static void _unload_old_icons(GtkMenu* menu, GtkIconTheme* theme, menup* m)
         {
             GtkImage* img;
             item = GTK_MENU_ITEM( child->data );
+#if GTK_CHECK_VERSION(3, 0, 0)
+            if (GTK_IS_MENU_ITEM (item))
+            {
+                GtkWidget *box = gtk_bin_get_child (GTK_BIN (item));
+                if (GTK_IS_BOX (box))
+                {
+                    GList *children = gtk_container_get_children (GTK_CONTAINER (box));
+                    if (GTK_IS_IMAGE (children->data))
+                    {
+                        img = GTK_IMAGE (children->data);
+                        gtk_image_clear(img);
+                        if (gtk_widget_get_mapped (GTK_WIDGET(img))) on_menu_item_map(GTK_WIDGET(item), m);
+                    }
+                }
+            }
+#else
             if( GTK_IS_IMAGE_MENU_ITEM(item) )
             {
 	        img = GTK_IMAGE(gtk_image_menu_item_get_image(GTK_IMAGE_MENU_ITEM(item)));
@@ -535,6 +589,7 @@ static void _unload_old_icons(GtkMenu* menu, GtkIconTheme* theme, menup* m)
                 if (gtk_widget_get_mapped(GTK_WIDGET(img)))
 		    on_menu_item_map(GTK_WIDGET(item), m);
             }
+#endif
         }
         else if( ( sub_menu = gtk_menu_item_get_submenu( item ) ) )
         {
@@ -628,10 +683,14 @@ reload_system_menu( menup* m, GtkMenu* menu )
 
 static void show_menu( GtkWidget* widget, menup* m, int btn, guint32 time )
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_menu_popup_at_widget (GTK_MENU(m->menu), widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, NULL);
+#else
     gtk_menu_popup(GTK_MENU(m->menu),
                    NULL, NULL,
                    (GtkMenuPositionFunc)menu_pos, widget,
                    btn, time);
+#endif
 }
 
 static gboolean
@@ -660,15 +719,19 @@ static gboolean show_system_menu_idle(gpointer user_data)
 static void show_system_menu(GtkWidget *p)
 {
     menup *m = lxpanel_plugin_get_data(p);
-
     if (m->has_system_menu && m->show_system_menu_idle == 0)
         /* FIXME: I've no idea why this doesn't work without timeout
                               under some WMs, like icewm. */
         m->show_system_menu_idle = g_timeout_add(200, show_system_menu_idle, m);
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+static GtkWidget *
+make_button(menup *m, const gchar *fname, const gchar *name, GdkRGBA* tint, GtkWidget *menu)
+#else
 static GtkWidget *
 make_button(menup *m, const gchar *fname, const gchar *name, GdkColor* tint, GtkWidget *menu)
+#endif
 {
     char* title = NULL;
 
@@ -696,10 +759,14 @@ make_button(menup *m, const gchar *fname, const gchar *name, GdkColor* tint, Gtk
     }
     else
     {
-        m->img = lxpanel_button_new_for_icon(m->panel, fname, tint, NULL);
+        m->img = gtk_image_new ();
+        lxpanel_plugin_set_taskbar_icon (m->panel, m->img, m->fname);
     }
 
+    gtk_widget_set_visible (m->img, TRUE);
+    if (m->padding) gtk_widget_set_size_request (m->img, m->iconsize + 2 * m->padding, -1);
     gtk_container_add(GTK_CONTAINER(m->box), m->img);
+    gtk_widget_set_tooltip_text (m->box, _("Click here to open applications menu"));
 
     m->ds = fm_dnd_src_new(NULL);
 
@@ -728,6 +795,9 @@ read_item(menup *m, config_setting_t *s)
     GtkWidget *item;
     Command *cmd_entry = NULL;
     char *tmp;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *box, *label;
+#endif
 
     ENTER;
     name = fname = action = NULL;
@@ -749,18 +819,41 @@ read_item(menup *m, config_setting_t *s)
     /* menu button */
     if( cmd_entry ) /* built-in commands */
     {
-        item = gtk_image_menu_item_new_with_label( _(cmd_entry->disp_name) );
+#if GTK_CHECK_VERSION(3, 0, 0)
+        item = gtk_menu_item_new ();
+        box = gtk_box_new (GTK_ORIENTATION_HORIZONTAL, MENU_ICON_SPACE);
+        gtk_container_add (GTK_CONTAINER (item), box);
+        if (name == NULL)
+            label = gtk_label_new ( _(cmd_entry->disp_name) );
+        else
+            label = gtk_label_new (name);
+#else
+        if (name == NULL)
+            item = gtk_image_menu_item_new_with_label( _(cmd_entry->disp_name) );
+        else
+            item = gtk_image_menu_item_new_with_label (name);
+#endif
         g_signal_connect(G_OBJECT(item), "activate", (GCallback)run_command, cmd_entry->cmd);
     }
     else if (action)
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        item = gtk_menu_item_new ();
+        box = gtk_box_new (GTK_ORIENTATION_HORIZONTAL, MENU_ICON_SPACE);
+        gtk_container_add (GTK_CONTAINER (item), box);
+        label = gtk_label_new (name ? name : "");
+#else
         item = gtk_image_menu_item_new_with_label(name ? name : "");
+#endif
         tmp = g_strdup(action);
         g_object_weak_ref(G_OBJECT(item), (GWeakNotify)g_free, tmp);
         g_signal_connect(G_OBJECT(item), "activate", (GCallback)spawn_app, tmp);
     }
     else
         goto error;
+#if !GTK_CHECK_VERSION(3, 0, 0)
+    gtk_image_menu_item_set_always_show_image (GTK_IMAGE_MENU_ITEM (item), TRUE);
+#endif
     gtk_container_set_border_width(GTK_CONTAINER(item), 0);
     if (fname) {
         GtkWidget *img;
@@ -768,9 +861,18 @@ read_item(menup *m, config_setting_t *s)
         tmp = expand_tilda(fname);
         img = lxpanel_image_new_for_icon(m->panel, tmp, m->iconsize, NULL);
         gtk_widget_show(img);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_container_add (GTK_CONTAINER (box), img);
+        gtk_container_add (GTK_CONTAINER (box), label);
+#else
         gtk_image_menu_item_set_image(GTK_IMAGE_MENU_ITEM(item), img);
+#endif
         g_free(tmp);
     }
+#if GTK_CHECK_VERSION(3, 0, 0)
+    else gtk_container_add (GTK_CONTAINER (box), label);
+    gtk_widget_show_all (box);
+#endif
     RET(item);
 
  error:
@@ -849,25 +951,37 @@ read_include(Plugin *p, char **fp)
 #endif
 
 static GtkWidget *
-read_submenu(menup *m, config_setting_t *s, gboolean as_item)
+read_submenu(menup *m, config_setting_t *s, int as_item)
 {
     GtkWidget *mi, *menu;
     const gchar *name, *fname, *str;
     config_setting_t *list = config_setting_add(s, "", PANEL_CONF_TYPE_LIST);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA color={0.0, 0.141, 0.376, 1.0};
+#else
     GdkColor color={0, 0, 36 * 0xffff / 0xff, 96 * 0xffff / 0xff};
+#endif
     guint i;
 
     ENTER;
 
     menu = gtk_menu_new ();
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_menu_set_reserve_toggle_size (GTK_MENU (menu), FALSE);
+#endif
     gtk_container_set_border_width(GTK_CONTAINER(menu), 0);
+    g_signal_connect(menu, "key-press-event", G_CALLBACK(check_close), menu);
 
     fname = NULL;
     name = NULL;
     config_setting_lookup_string(s, "name", &name);
     config_setting_lookup_string(s, "image", &fname);
     if (config_setting_lookup_string(s, "tintcolor", &str))
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_rgba_parse(&color, str);
+#else
         gdk_color_parse(str, &color);
+#endif
 
     for (i = 0; (s = config_setting_get_elem(list, i)) != NULL; i++)
     {
@@ -894,19 +1008,38 @@ read_submenu(menup *m, config_setting_t *s, gboolean as_item)
             g_warning("menu: can't create menu item");
             goto error;
         }
+        gtk_widget_set_name (mi, "sysmenu");
         gtk_widget_show(mi);
         gtk_menu_shell_append (GTK_MENU_SHELL (menu), mi);
     }
+    if (as_item == 2) return menu;
     if (as_item) {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        GtkWidget *box, *label;
+        mi = gtk_menu_item_new ();
+        box = gtk_box_new (GTK_ORIENTATION_HORIZONTAL, MENU_ICON_SPACE);
+        gtk_container_add (GTK_CONTAINER (mi), box);
+        label = gtk_label_new (name);
+#else
         mi = gtk_image_menu_item_new_with_label(name);
+#endif
         if (fname) {
             GtkWidget *img;
             char *expanded = expand_tilda(fname);
             img = lxpanel_image_new_for_icon(m->panel, expanded, m->iconsize, NULL);
             gtk_widget_show(img);
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_container_add (GTK_CONTAINER (box), img);
+            gtk_container_add (GTK_CONTAINER (box), label);
+#else
             gtk_image_menu_item_set_image(GTK_IMAGE_MENU_ITEM(mi), img);
+#endif
             g_free(expanded);
         }
+#if GTK_CHECK_VERSION(3, 0, 0)
+        else gtk_container_add (GTK_CONTAINER (box), label);
+        gtk_widget_show_all (box);
+#endif
         gtk_menu_item_set_submenu (GTK_MENU_ITEM (mi), menu);
     } else {
         m->fname = fname ? expand_tilda(fname) : g_strdup(DEFAULT_MENU_ICON);
@@ -929,13 +1062,20 @@ menu_constructor(LXPanel *panel, config_setting_t *settings)
     config_setting_t *s;
     int iw, ih;
 
+#ifdef ENABLE_NLS
+    setlocale (LC_ALL, "");
+    bindtextdomain (GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
+    bind_textdomain_codeset (GETTEXT_PACKAGE, "UTF-8");
+    textdomain (GETTEXT_PACKAGE);
+#endif
+
     m = g_new0(menup, 1);
     g_return_val_if_fail(m != NULL, 0);
 
-    gtk_icon_size_lookup( GTK_ICON_SIZE_MENU, &iw, &ih );
-    m->iconsize = MAX(iw, ih);
+    m->iconsize = panel_get_safe_icon_size (panel);
 
-    m->box = gtk_event_box_new();
+    m->box = gtk_button_new();
+    gtk_button_set_relief (GTK_BUTTON (m->box), GTK_RELIEF_NONE);
     gtk_widget_set_has_window(m->box, FALSE);
     lxpanel_plugin_set_data(m->box, m, menu_destructor);
 
@@ -943,6 +1083,9 @@ menu_constructor(LXPanel *panel, config_setting_t *settings)
     m->panel = panel;
     m->settings = settings;
 
+    m->padding = 0;
+    if (config_setting_lookup_int (settings, "padding", &iw))
+        m->padding = iw;
     /* Check if configuration exists */
     settings = config_setting_add(settings, "", PANEL_CONF_TYPE_LIST);
     if (config_setting_get_elem(settings, 0) == NULL)
@@ -974,12 +1117,24 @@ static gboolean apply_config(gpointer user_data)
     GtkWidget *p = user_data;
     menup* m = lxpanel_plugin_get_data(p);
 
+    m->iconsize = panel_get_safe_icon_size (m->panel);
+
     if( m->fname ) {
-        lxpanel_button_set_icon(m->img, m->fname, -1);
+        lxpanel_plugin_set_taskbar_icon (m->panel, m->img, m->fname);
+        if (m->padding) gtk_widget_set_size_request (m->img, m->iconsize + 2 * m->padding, -1);
     }
     config_group_set_string(m->settings, "image", m->fname);
     /* config_group_set_int(m->settings, "panelSize", m->match_panel); */
     config_group_set_string(m->settings, "name", m->caption);
+    config_group_set_int(m->settings, "padding", m->padding);
+    if (m->menu) gtk_widget_destroy(m->menu);
+    if( m->menu_cache )
+    {
+        menu_cache_remove_reload_notify(m->menu_cache, m->reload_notify);
+        menu_cache_unref( m->menu_cache );
+    }
+    m->menu_cache = NULL;
+    m->menu = read_submenu(m, m->settings, 2);
     return FALSE;
 }
 
@@ -987,20 +1142,36 @@ static GtkWidget *menu_config(LXPanel *panel, GtkWidget *p)
 {
     menup* menu = lxpanel_plugin_get_data(p);
     return lxpanel_generic_config_dlg(_("Menu"), panel, apply_config, p,
-                                      _("Icon"), &menu->fname, CONF_TYPE_FILE_ENTRY,
+                                      _("Icon"), &menu->fname, CONF_TYPE_STR,
+                                      _("Padding"), &menu->padding, CONF_TYPE_INT,
                                       /* _("Use panel size as icon size"), &menu->match_panel, CONF_TYPE_INT, */
                                       /* _("Caption"), &menu->caption, CONF_TYPE_STR, */
                                       NULL);
 }
 
+/* Callback when panel configuration changes. */
+static void menu_panel_configuration_changed(LXPanel *panel, GtkWidget *p)
+{
+#ifdef ENABLE_NLS
+    setlocale (LC_ALL, "");
+    bindtextdomain (GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
+    bind_textdomain_codeset (GETTEXT_PACKAGE, "UTF-8");
+    textdomain (GETTEXT_PACKAGE);
+#endif
+
+    apply_config(p);
+}
+
 LXPanelPluginInit lxpanel_static_plugin_menu = {
     .name = N_("Menu"),
     .description = N_("Application Menu"),
 
     .new_instance = menu_constructor,
     .config = menu_config,
+    .reconfigure = menu_panel_configuration_changed,
     .button_press_event = menu_button_press_event,
-    .show_system_menu = show_system_menu
+    .show_system_menu = show_system_menu,
+    .gettext_package = GETTEXT_PACKAGE
 };
 
 /* vim: set sw=4 et sts=4 : */
diff --git a/plugins/monitors/monitors.c b/plugins/monitors/monitors.c
index 524b526..d5fc35a 100644
--- a/plugins/monitors/monitors.c
+++ b/plugins/monitors/monitors.c
@@ -101,7 +101,11 @@
 typedef float stats_set;
 
 struct Monitor {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA     foreground_color;  /* Foreground color for drawing area      */
+#else
     GdkColor     foreground_color;  /* Foreground color for drawing area      */
+#endif
     GtkWidget    *da;               /* Drawing area                           */
     cairo_surface_t    *pixmap;     /* Pixmap to be drawn on drawing area     */
     gint         pixmap_width;      /* Width and size of the buffer           */
@@ -214,7 +218,11 @@ monitor_set_foreground_color(MonitorsPlugin *mp, Monitor *m, const gchar *color)
 {
     g_free(m->color);
     m->color = g_strndup(color, COLOR_SIZE - 1);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_rgba_parse(&m->foreground_color, color);
+#else
     gdk_color_parse(color, &m->foreground_color);
+#endif
 }
 /******************************************************************************
  *                          End of monitor functions                          *
@@ -543,15 +551,25 @@ redraw_pixmap (Monitor *m)
 {
     int i;
     cairo_t *cr = cairo_create(m->pixmap);
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkStyle *style = gtk_widget_get_style(m->da);
+#endif
 
     cairo_set_line_width (cr, 1.0);
 
     /* Erase pixmap */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    cairo_set_source_rgb(cr, 0, 0, 0); // FIXME: use black color from style
+#else
     gdk_cairo_set_source_color(cr, &style->black);
+#endif
     cairo_paint(cr);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_cairo_set_source_rgba(cr, &m->foreground_color);
+#else
     gdk_cairo_set_source_color(cr, &m->foreground_color);
+#endif
     for (i = 0; i < m->pixmap_width; i++)
     {
         unsigned int drawing_cursor = (m->ring_cursor + i) % m->pixmap_width;
@@ -653,7 +671,12 @@ monitors_constructor(LXPanel *panel, config_setting_t *settings)
     mp->panel = panel;
     mp->settings = settings;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    p = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 2);
+    gtk_box_set_homogeneous (GTK_BOX (p), TRUE);
+#else
     p = gtk_hbox_new(TRUE, 2);
+#endif
     lxpanel_plugin_set_data(p, mp, monitors_destructor);
 
     /* First time we use this plugin : only display CPU usage */
diff --git a/plugins/netstat/netstat.c b/plugins/netstat/netstat.c
index f0764ad..15894e9 100644
--- a/plugins/netstat/netstat.c
+++ b/plugins/netstat/netstat.c
@@ -170,7 +170,11 @@ wireless_menu(netdev_info *ni)
 
             /* create a new item */
             menu_item = gtk_menu_item_new();
+#if GTK_CHECK_VERSION(3, 0, 0)
+            item_box = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+#else
             item_box = gtk_hbox_new(FALSE, 0);
+#endif
 
             /* Encryption */
             if (aps->apinfo->haskey) {
@@ -185,7 +189,12 @@ wireless_menu(netdev_info *ni)
                 essid_label = gtk_label_new(aps->apinfo->essid);
 
             gtk_label_set_justify(GTK_LABEL(essid_label), GTK_JUSTIFY_LEFT);
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_widget_set_margin_start (essid_label, 2);
+            gtk_widget_set_margin_end (essid_label, 2);
+#else
             gtk_misc_set_padding(GTK_MISC(essid_label), 2, 0);
+#endif
             gtk_box_pack_start(GTK_BOX(item_box), essid_label, TRUE, FALSE, 0);
 
             /* Quality */
@@ -241,7 +250,11 @@ static gint menupopup(GtkWidget *widget, GdkEvent *event, netdev_info *ni)
 //        if (event_button->button == 1) {
             /* wireless device */
             if (ni->netdev_list->info.wireless) {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                gtk_menu_popup_at_widget (GTK_MENU(wireless_menu(ni)), widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, event);
+#else
                 gtk_menu_popup(GTK_MENU(wireless_menu(ni)), NULL, NULL, NULL, NULL, event_button->button, event_button->time);
+#endif
 //            }
             return TRUE;
         } else {
@@ -264,7 +277,11 @@ static gint menupopup(GtkWidget *widget, GdkEvent *event, netdev_info *ni)
 
             gtk_widget_show_all(menu);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_menu_popup_at_widget (GTK_MENU(menu), widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, event);
+#else
             gtk_menu_popup(GTK_MENU(menu), NULL, NULL, NULL, NULL, event_button->button, event_button->time);
+#endif
             return TRUE;
         }
     }
diff --git a/plugins/netstat/passwd_gui.c b/plugins/netstat/passwd_gui.c
index 83c02b0..5687c06 100644
--- a/plugins/netstat/passwd_gui.c
+++ b/plugins/netstat/passwd_gui.c
@@ -54,10 +54,12 @@ static void passwd_gui_on_response(GtkDialog* dlg, gint response, struct passwd_
     gtk_widget_destroy((GtkWidget*)dlg);
 }
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
 void passwd_gui_set_style(struct pgui *pg, GtkStyle *style)
 {
     gtk_widget_set_style(pg->dlg, style);
 }
+#endif
 
 static void passwd_gui_free(gpointer ptr, GObject *dummy)
 {
@@ -90,8 +92,13 @@ struct pgui *passwd_gui_new(ap_setting *aps)
     pwdgui->dlg = gtk_dialog_new_with_buttons(_("Setting Encryption Key"),
                                        NULL,
                                        GTK_DIALOG_NO_SEPARATOR,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                       _("_OK"), GTK_RESPONSE_OK,
+                                       _("_Cancel"), GTK_RESPONSE_CANCEL,
+#else
                                        GTK_STOCK_OK, GTK_RESPONSE_OK,
                                        GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
+#endif
                                        NULL );
     gtk_dialog_set_default_response(GTK_DIALOG(pwdgui->dlg), GTK_RESPONSE_OK);
     gtk_window_set_position(GTK_WINDOW(pwdgui->dlg), GTK_WIN_POS_CENTER);
@@ -102,7 +109,11 @@ struct pgui *passwd_gui_new(ap_setting *aps)
     gtk_box_pack_start(dialog_vbox, msg, FALSE, FALSE, 8);
 
     /* entry Box */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    inputbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+#else
     inputbox = gtk_hbox_new(FALSE, 0);
+#endif
     inputlabel = gtk_label_new(_("Encryption Key:"));
     gtk_box_pack_start(GTK_BOX(inputbox), inputlabel, TRUE, TRUE, 4);
     pwdgui->pentry = gtk_entry_new();
diff --git a/plugins/netstat/passwd_gui.h b/plugins/netstat/passwd_gui.h
index 9db717a..9802172 100644
--- a/plugins/netstat/passwd_gui.h
+++ b/plugins/netstat/passwd_gui.h
@@ -4,6 +4,8 @@
 #include "netstat.h"
 
 struct pgui *passwd_gui_new(ap_setting *aps);
+#if !GTK_CHECK_VERSION(3, 0, 0)
 void passwd_gui_set_style(struct pgui *pg, GtkStyle *style);
+#endif
 void passwd_gui_destroy(struct pgui *pg);
 #endif
diff --git a/plugins/netstatus/netstatus-dialog.c b/plugins/netstatus/netstatus-dialog.c
index 979d6a8..c53d7e0 100644
--- a/plugins/netstatus/netstatus-dialog.c
+++ b/plugins/netstatus/netstatus-dialog.c
@@ -228,14 +228,18 @@ netstatus_dialog_update_inet4_support (NetstatusDialogData *data)
       /* Address */
       if (addr)
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 0, 6);
+#endif
 	  gtk_label_set_text (GTK_LABEL (data->inet4_addr), addr);
 	  gtk_widget_show (data->inet4_addr);
 	  gtk_widget_show (data->inet4_addr_title);
 	}
       else
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 0, 0);
+#endif
 	  gtk_widget_hide (data->inet4_addr);
 	  gtk_widget_hide (data->inet4_addr_title);
 	}
@@ -243,14 +247,18 @@ netstatus_dialog_update_inet4_support (NetstatusDialogData *data)
       /* Destination */
       if (dest)
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 1, 6);
+#endif
 	  gtk_label_set_text (GTK_LABEL (data->inet4_dest), dest);
 	  gtk_widget_show (data->inet4_dest);
 	  gtk_widget_show (data->inet4_dest_title);
 	}
       else
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 1, 0);
+#endif
 	  gtk_widget_hide (data->inet4_dest);
 	  gtk_widget_hide (data->inet4_dest_title);
 	}
@@ -258,14 +266,18 @@ netstatus_dialog_update_inet4_support (NetstatusDialogData *data)
       /* Broadcast */
       if (bcast)
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 2, 6);
+#endif
 	  gtk_label_set_text (GTK_LABEL (data->inet4_bcast), bcast);
 	  gtk_widget_show (data->inet4_bcast);
 	  gtk_widget_show (data->inet4_bcast_title);
 	}
       else
 	{
+#if !GTK_CHECK_VERSION(3, 0, 0)
 	  gtk_table_set_row_spacing (GTK_TABLE (data->inet4_table), 2, 0);
+#endif
 	  gtk_widget_hide (data->inet4_bcast);
 	  gtk_widget_hide (data->inet4_bcast_title);
 	}
@@ -719,7 +731,11 @@ netstatus_dialog_set_icon (GtkWidget *dialog)
       gtk_window_set_icon_from_file (GTK_WINDOW (dialog),
 				     gtk_icon_info_get_filename (icon_info),
 				     NULL);
+#if GTK_CHECK_VERSION(3, 0, 0)
+      g_object_unref (icon_info);
+#else
       gtk_icon_info_free (icon_info);
+#endif
     }
 }
 
diff --git a/plugins/netstatus/netstatus-fallback-pixbuf.h b/plugins/netstatus/netstatus-fallback-pixbuf.h
index 44aa8fd..7c0abb1 100644
--- a/plugins/netstatus/netstatus-fallback-pixbuf.h
+++ b/plugins/netstatus/netstatus-fallback-pixbuf.h
@@ -9,6 +9,7 @@ static const guint8 fallback_icon_data[] __attribute__ ((__aligned__ (4))) =
 static const guint8 fallback_icon_data[] = 
 #endif
 { ""
+#if !GTK_CHECK_VERSION(3, 0, 0)
   /* Pixbuf magic (0x47646b50) */
   "GdkP"
   /* length: header (24) + pixel_data (9216) */
@@ -21,6 +22,7 @@ static const guint8 fallback_icon_data[] =
   "\0\0\0""0"
   /* height (48) */
   "\0\0\0""0"
+#endif
   /* pixel_data: */
   "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
   "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
diff --git a/plugins/netstatus/netstatus-icon.c b/plugins/netstatus/netstatus-icon.c
index 33116ef..b87f921 100644
--- a/plugins/netstatus/netstatus-icon.c
+++ b/plugins/netstatus/netstatus-icon.c
@@ -101,10 +101,14 @@ netstatus_icon_get_default_pixbuf (NetstatusIcon *icon __attribute__((unused)))
 
   if (!fallback_pixbuf)
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+      fallback_pixbuf = gdk_pixbuf_new_from_data (fallback_icon_data, GDK_COLORSPACE_RGB, TRUE, 8, 48, 48, 192, NULL, NULL);
+#else
       fallback_pixbuf = gdk_pixbuf_new_from_inline (-1,
 						    fallback_icon_data,
 						    FALSE,
 						    NULL);
+#endif
       g_object_add_weak_pointer (G_OBJECT (fallback_pixbuf),
 				 (gpointer) &fallback_pixbuf);
 
@@ -178,7 +182,11 @@ netstatus_icon_lookup_icon_theme (NetstatusIcon *icon,
     {
       filename = g_strdup (gtk_icon_info_get_filename (icon_info));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      g_object_unref (icon_info);
+#else
       gtk_icon_info_free (icon_info);
+#endif
     }
 
   return filename;
@@ -588,7 +596,11 @@ netstatus_icon_scale_icons (NetstatusIcon  *icon,
 static inline GObjectClass *
 get_box_class (GtkOrientation orientation)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+  return g_type_class_peek(GTK_TYPE_BOX);
+#else
   return g_type_class_peek(orientation == GTK_ORIENTATION_HORIZONTAL ? GTK_TYPE_HBOX : GTK_TYPE_VBOX);
+#endif
 }
 
 #if !GTK_CHECK_VERSION(3, 0, 0)
@@ -699,9 +711,11 @@ netstatus_icon_realize (GtkWidget *widget)
   gtk_widget_set_window (widget, window);
   gdk_window_set_user_data (window, widget);
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
   gtk_widget_ensure_style (widget);
   style = gtk_widget_get_style (widget);
   gtk_style_set_background (style, window, GTK_STATE_NORMAL);
+#endif
 }
 
 static gboolean
diff --git a/plugins/netstatus/netstatus.c b/plugins/netstatus/netstatus.c
index 0f9c81d..97a0fff 100644
--- a/plugins/netstatus/netstatus.c
+++ b/plugins/netstatus/netstatus.c
@@ -94,7 +94,9 @@ static gboolean on_button_press( GtkWidget* widget, GdkEventButton* evt, LXPanel
             ns->dlg = netstatus_dialog_new(iface);
 
             /* fix background */
+#if !GTK_CHECK_VERSION(3, 0, 0)
             gtk_widget_set_style(ns->dlg, panel_get_defstyle(p));
+#endif
 
             netstatus_dialog_set_configuration_tool( ns->dlg, ns->config_tool );
             g_signal_connect( ns->dlg, "response", G_CALLBACK(on_response), ns );
diff --git a/plugins/pager.c b/plugins/pager.c
index fb560c2..d1e535d 100644
--- a/plugins/pager.c
+++ b/plugins/pager.c
@@ -53,7 +53,11 @@ static void on_realize(GtkWidget *p, LXPanel *panel)
     /* set geometry */
     wnck_pager_set_orientation(d->pager, panel_get_orientation(panel));
     if (panel_get_orientation(panel) == GTK_ORIENTATION_VERTICAL)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        h *= ((gfloat) screen_height (NULL) / (gfloat) screen_width (NULL));
+#else
         h *= ((gfloat) gdk_screen_height() / (gfloat) gdk_screen_width());
+#endif
     rows = h / (panel_get_icon_size(panel) * 2) + 1; /* min */
     r = (h - 2) / panel_get_icon_size(panel); /* max */
     /* g_debug("pager for height %d and icon size %d: %d to %d",panel_get_height(panel),panel_get_icon_size(panel),r,rows); */
diff --git a/plugins/separator.c b/plugins/separator.c
index 6f4c1b3..f5cd428 100644
--- a/plugins/separator.c
+++ b/plugins/separator.c
@@ -50,6 +50,18 @@ static void separator_reconfigure(LXPanel *panel, GtkWidget *instance)
 {
     /* Determine if the orientation changed in a way that requires action. */
     GtkWidget * sep = gtk_bin_get_child(GTK_BIN(instance));
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (gtk_orientable_get_orientation (GTK_ORIENTABLE (sep)) == GTK_ORIENTATION_VERTICAL)
+    {
+        if (panel_get_orientation(panel) == GTK_ORIENTATION_HORIZONTAL)
+            return;
+    }
+    else
+    {
+        if (panel_get_orientation(panel) == GTK_ORIENTATION_VERTICAL)
+            return;
+    }
+#else
     if (GTK_IS_VSEPARATOR(sep))
     {
         if (panel_get_orientation(panel) == GTK_ORIENTATION_HORIZONTAL)
@@ -60,6 +72,7 @@ static void separator_reconfigure(LXPanel *panel, GtkWidget *instance)
         if (panel_get_orientation(panel) == GTK_ORIENTATION_VERTICAL)
             return;
     }
+#endif
 
     /* If the orientation changed, recreate the separator. */
     gtk_widget_destroy(sep);
diff --git a/plugins/task-button.c b/plugins/task-button.c
index 3744cc7..2013fa6 100644
--- a/plugins/task-button.c
+++ b/plugins/task-button.c
@@ -130,7 +130,14 @@ static gint get_window_monitor(Window win)
     g_assert(display);
     gwin = gdk_x11_window_foreign_new_for_display(display,win);
     g_assert(gwin);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    m = -1;
+    GdkMonitor *mon = gdk_display_get_monitor_at_window (gdk_window_get_display (gwin), gwin);
+    for (int i = 0; i < gdk_display_get_n_monitors (gdk_window_get_display (gwin)); i++)
+        if (gdk_display_get_monitor (gdk_window_get_display (gwin), i) == mon) m = i;
+#else
     m = gdk_screen_get_monitor_at_window(gdk_window_get_screen(gwin),gwin);
+#endif
     g_object_unref(gwin);
     return m;
 }
@@ -203,7 +210,6 @@ static gboolean task_is_visible(TaskButton *b, TaskDetails *task)
     /* Not on same monitor */
     if (b->flags.same_monitor_only && b->monitor != task->monitor && b->monitor >= 0)
         return FALSE;
-
     /* Desktop placement. */
     return ((task->desktop == ALL_WORKSPACES) ||
             (task->desktop == b->desktop) ||
@@ -626,15 +632,30 @@ static void taskbar_close_all_windows(GtkWidget * widget, TaskButton *tb)
 static void assemble_gui(TaskButton *self)
 {
     /* Create a box to contain the application icon and window title. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * container = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 1);
+#else
     GtkWidget * container = gtk_hbox_new(FALSE, 1);
+#endif
     gtk_container_set_border_width(GTK_CONTAINER(container), 0);
 
     /* Add the image to contain the application icon to the box. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (self->image, 0);
+    gtk_widget_set_margin_end (self->image, 0);
+    gtk_widget_set_margin_top (self->image, 0);
+    gtk_widget_set_margin_bottom (self->image, 0);
+#else
     gtk_misc_set_padding(GTK_MISC(self->image), 0, 0);
+#endif
     gtk_box_pack_start(GTK_BOX(container), self->image, FALSE, FALSE, 0);
 
     /* Add the label to contain the window title to the box. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_label_set_xalign (GTK_LABEL(self->label), 0.0);
+#else
     gtk_misc_set_alignment(GTK_MISC(self->label), 0.0, 0.5);
+#endif
     gtk_label_set_ellipsize(GTK_LABEL(self->label), PANGO_ELLIPSIZE_END);
     gtk_box_pack_start(GTK_BOX(container), self->label, TRUE, TRUE, 0);
 
@@ -730,7 +751,9 @@ static GdkPixbuf * _wnck_gdk_pixbuf_get_from_pixmap(GdkScreen *screen, Pixmap xp
   surface = NULL;
   xdisplay = GDK_DISPLAY_XDISPLAY(gdk_display_get_default());
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
   gdk_error_trap_push();
+#endif
 
   if (!XGetWindowAttributes (xdisplay, win, &attrs))
     goto TRAP_POP;
@@ -755,9 +778,13 @@ static GdkPixbuf * _wnck_gdk_pixbuf_get_from_pixmap(GdkScreen *screen, Pixmap xp
   cairo_surface_destroy (surface);
 
 TRAP_POP:
+#if GTK_CHECK_VERSION(3, 0, 0)
+  gdk_display_flush(gdk_display_get_default());
+#else
   gdk_flush();
   if (gdk_error_trap_pop())
     g_warning("task button : X error");
+#endif
 
   return pixbuf;
 }
@@ -1189,8 +1216,8 @@ static gboolean task_update_visibility(TaskButton *task)
         details->visible = task_is_visible(task, details);
         if (!details->visible)
             continue;
-        if (details->monitor == task->monitor && !details->iconified)
-            /* window is visible on the current desktop */
+        if (!details->iconified)
+            /* window is visible */
             task->visible = TRUE;
         /* Compute the visible name.  If all visible windows have the same title, use that.
          * Otherwise, use the class name.  This follows WNCK. */
@@ -1245,6 +1272,9 @@ static gboolean task_button_button_press_event(GtkWidget *widget, GdkEventButton
     GtkWidget *menu, *mi;
     TaskButton *tb = PANEL_TASK_BUTTON(widget);
 
+#ifdef ENABLE_NLS
+    textdomain ( GETTEXT_PACKAGE );
+#endif
     if (event->button == 3) /* Right click */
     {
         if (tb->n_visible > 1)
@@ -1267,8 +1297,12 @@ static gboolean task_button_button_press_event(GtkWidget *widget, GdkEventButton
             gtk_menu_detach(GTK_MENU(menu));
         /* attach menu to the widget and show it */
         gtk_menu_attach_to_widget(GTK_MENU(menu), widget, NULL);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_menu_popup_at_widget (GTK_MENU(menu), widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, (GdkEvent *) event);
+#else
         gtk_menu_popup(GTK_MENU(menu), NULL, NULL, taskbar_popup_set_position,
                        tb, event->button, event->time);
+#endif
     }
     return TRUE;
 }
@@ -1301,6 +1335,9 @@ static gboolean task_button_button_release_event(GtkWidget *widget, GdkEventButt
                 gtk_menu_detach(tb->menu_list);
             }
             tb->menu_list = GTK_MENU(gtk_menu_new());
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_menu_set_reserve_toggle_size (GTK_MENU (tb->menu_list), FALSE);
+#endif
             g_object_add_weak_pointer(G_OBJECT(tb->menu_list), (void **)&tb->menu_list);
             g_signal_connect(G_OBJECT(tb->menu_list), "selection-done",
                              G_CALLBACK(on_menu_list_selection_done), tb);
@@ -1313,6 +1350,15 @@ static gboolean task_button_button_release_event(GtkWidget *widget, GdkEventButt
                     /* The menu item has the name, or the iconified name, and
                      * the icon of the application window. */
                     name = task->iconified ? g_strdup_printf("[%s]", task->name) : NULL;
+#if GTK_CHECK_VERSION(3, 0, 0)
+                    task->menu_item = lxpanel_plugin_new_menu_item (tb->panel, name ? name : task->name, 0, NULL);
+                    g_free(name);
+                    if (task->icon)
+                    {
+                        GtkWidget *im = gtk_image_new_from_pixbuf(task->icon);
+                        lxpanel_plugin_update_menu_icon (task->menu_item, im);
+                    }
+#else
                     task->menu_item = gtk_image_menu_item_new_with_label(name ? name : task->name);
                     g_free(name);
                     if (task->icon)
@@ -1320,6 +1366,7 @@ static gboolean task_button_button_release_event(GtkWidget *widget, GdkEventButt
                         GtkWidget *im = gtk_image_new_from_pixbuf(task->icon);
                         gtk_image_menu_item_set_image(GTK_IMAGE_MENU_ITEM(task->menu_item), im);
                     }
+#endif
                     g_signal_connect(task->menu_item, "button-press-event",
                                      G_CALLBACK(taskbar_popup_activate_event), tb);
                     g_signal_connect(task->menu_item, "select",
@@ -1336,8 +1383,12 @@ static gboolean task_button_button_release_event(GtkWidget *widget, GdkEventButt
              * positioned with respect to the button. */
             gtk_widget_show_all(GTK_WIDGET(tb->menu_list));
             gtk_menu_attach_to_widget(tb->menu_list, widget, NULL);
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_menu_popup_at_widget (tb->menu_list, widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, (GdkEvent *) event);
+#else
             gtk_menu_popup(tb->menu_list, NULL, NULL, taskbar_popup_set_position,
                            tb, event->button, event->time);
+#endif
         }
     }
     else
@@ -1348,7 +1399,11 @@ static gboolean task_button_button_release_event(GtkWidget *widget, GdkEventButt
 
     /* As a matter of policy, avoid showing selected or prelight states on flat buttons. */
     if (tb->flags.flat_button)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_set_state_flags(widget, GTK_STATE_FLAG_NORMAL, TRUE);
+#else
         gtk_widget_set_state(widget, GTK_STATE_NORMAL);
+#endif
     return TRUE;
 }
 
@@ -1457,7 +1512,11 @@ static void task_button_init(TaskButton *self)
     gtk_container_set_border_width(GTK_CONTAINER(self), 0);
     gtk_widget_set_can_focus(GTK_WIDGET(self), FALSE);
     gtk_widget_set_can_default(GTK_WIDGET(self), FALSE);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_state_flags(GTK_WIDGET(self), GTK_STATE_FLAG_NORMAL, TRUE);
+#else
     gtk_widget_set_state(GTK_WIDGET(self), GTK_STATE_NORMAL);
+#endif
 #if GTK_CHECK_VERSION(3, 0, 0)
     gtk_widget_add_events(GTK_WIDGET(self), GDK_SCROLL_MASK);
 #endif
@@ -1690,7 +1749,7 @@ gboolean task_button_window_focus_changed(TaskButton *button, Window *win)
         if (!button->flags.flat_button)
             gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(button), TRUE);
         /* if focus changed that means button widgets may need update */
-        task_update_icon(button, button->last_focused, a_NET_ACTIVE_WINDOW);
+        task_update_icon(button, button->last_focused, None);
         task_redraw_label(button);
         // FIXME: test if need to update menu
     }
@@ -1808,8 +1867,13 @@ void task_button_set_flash_state(TaskButton *button, gboolean state)
             /* don't ever touch selected menu item, it makes odd effects */
             && button->menu_target != details->win)
             /* if submenu exists and mapped then set state too */
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_widget_set_state_flags(details->menu_item,
+                                 m_state ? GTK_STATE_FLAG_SELECTED : GTK_STATE_FLAG_NORMAL, TRUE);
+#else
             gtk_widget_set_state(details->menu_item,
                                  m_state ? GTK_STATE_SELECTED : GTK_STATE_NORMAL);
+#endif
     }
     /* Set state on the button and redraw. */
     if (button->flags.flat_button)
@@ -1822,13 +1886,23 @@ void task_button_set_flash_state(TaskButton *button, gboolean state)
         }
     }
     else if (has_flash)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_set_state_flags(GTK_WIDGET(button),
+                             state ? GTK_STATE_FLAG_SELECTED : GTK_STATE_FLAG_NORMAL, TRUE);
+#else
         gtk_widget_set_state(GTK_WIDGET(button),
                              state ? GTK_STATE_SELECTED : GTK_STATE_NORMAL);
+#endif
     else if (!button->entered_state && button->has_flash)
         /* if flash state just disappeared and button isn't hovered then
            update the state, otherwise it will be updated on mouse leave */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_set_state_flags(GTK_WIDGET(button),
+                             button->last_focused == NULL ? GTK_STATE_FLAG_NORMAL : GTK_STATE_FLAG_ACTIVE, TRUE);
+#else
         gtk_widget_set_state(GTK_WIDGET(button),
                              button->last_focused == NULL ? GTK_STATE_NORMAL : GTK_STATE_ACTIVE);
+#endif
     button->has_flash = has_flash;
 }
 
diff --git a/plugins/thermal/thermal.c b/plugins/thermal/thermal.c
index 75dba03..ace5ddd 100644
--- a/plugins/thermal/thermal.c
+++ b/plugins/thermal/thermal.c
@@ -66,9 +66,15 @@ typedef struct thermal {
          *str_cl_warning1,
          *str_cl_warning2;
     unsigned int timer;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA cl_normal,
+             cl_warning1,
+             cl_warning2;
+#else
     GdkColor cl_normal,
              cl_warning1,
              cl_warning2;
+#endif
     int numsensors;
     char *sensor_array[MAX_NUM_SENSORS];
     char *sensor_name[MAX_NUM_SENSORS];
@@ -264,7 +270,11 @@ update_display(thermal *th)
     char buffer [60];
     int i;
     int temp;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA color;
+#else
     GdkColor color;
+#endif
     gchar *separator;
 
     temp = get_temperature(th, &i);
@@ -444,9 +454,15 @@ static gboolean applyConfig(gpointer p)
     int critical;
     ENTER;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (th->str_cl_normal) gdk_rgba_parse(&th->cl_normal, th->str_cl_normal);
+    if (th->str_cl_warning1) gdk_rgba_parse(&th->cl_warning1, th->str_cl_warning1);
+    if (th->str_cl_warning2) gdk_rgba_parse(&th->cl_warning2, th->str_cl_warning2);
+#else
     if (th->str_cl_normal) gdk_color_parse(th->str_cl_normal, &th->cl_normal);
     if (th->str_cl_warning1) gdk_color_parse(th->str_cl_warning1, &th->cl_warning1);
     if (th->str_cl_warning2) gdk_color_parse(th->str_cl_warning2, &th->cl_warning2);
+#endif
 
     remove_all_sensors(th);
     /* FIXME: support wildcards in th->sensor */
diff --git a/plugins/tray.c b/plugins/tray.c
index 3e66b81..58ca8b1 100644
--- a/plugins/tray.c
+++ b/plugins/tray.c
@@ -219,7 +219,9 @@ static void balloon_message_display(TrayPlugin * tr, BalloonMessage * msg)
     tr->balloon_message_popup = gtk_window_new(GTK_WINDOW_POPUP);
     GtkWidget * balloon_text = gtk_label_new(msg->string);
     gtk_label_set_line_wrap(GTK_LABEL(balloon_text), TRUE);
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_misc_set_alignment(GTK_MISC(balloon_text), 0.5, 0.5);
+#endif
     gtk_container_add(GTK_CONTAINER(tr->balloon_message_popup), balloon_text);
     gtk_widget_show(balloon_text);
     gtk_container_set_border_width(GTK_CONTAINER(tr->balloon_message_popup), 4);
@@ -567,7 +569,11 @@ static GtkWidget *tray_constructor(LXPanel *panel, config_setting_t *settings)
     GdkDisplay * display = gdk_screen_get_display(screen);
 
     /* Create the selection atom.  This has the screen number in it, so cannot be done ahead of time. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    char * selection_atom_name = g_strdup_printf("_NET_SYSTEM_TRAY_S0");
+#else
     char * selection_atom_name = g_strdup_printf("_NET_SYSTEM_TRAY_S%d", gdk_screen_get_number(screen));
+#endif
     Atom selection_atom = gdk_x11_get_xatom_by_name_for_display(display, selection_atom_name);
     GdkAtom gdk_selection_atom = gdk_atom_intern(selection_atom_name, FALSE);
     g_free(selection_atom_name);
@@ -631,7 +637,7 @@ static GtkWidget *tray_constructor(LXPanel *panel, config_setting_t *settings)
     /* Add GDK event filter. */
     gdk_window_add_filter(NULL, (GdkFilterFunc) tray_event_filter, tr);
     /* Reference the window since it is never added to a container. */
-    tr->invisible = g_object_ref_sink(G_OBJECT(invisible));
+    tr->invisible = invisible;
     tr->invisible_window = GDK_WINDOW_XID(gtk_widget_get_window(invisible));
 
     /* Allocate top level widget and set into Plugin widget pointer. */
diff --git a/plugins/volumealsa/volumealsa.c b/plugins/volumealsa/volumealsa.c
index 5c41051..bb1862a 100644
--- a/plugins/volumealsa/volumealsa.c
+++ b/plugins/volumealsa/volumealsa.c
@@ -901,11 +901,19 @@ static void volumealsa_build_popup_window(GtkWidget *p)
     gtk_container_add(GTK_CONTAINER(viewport), frame);
 
     /* Create a vertical box as the child of the frame. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * box = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
+#else
     GtkWidget * box = gtk_vbox_new(FALSE, 0);
+#endif
     gtk_container_add(GTK_CONTAINER(frame), box);
 
     /* Create a vertical scale as the child of the vertical box. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    vol->volume_scale = gtk_scale_new(GTK_ORIENTATION_VERTICAL, GTK_ADJUSTMENT(gtk_adjustment_new(100, 0, 100, 0, 0, 0)));
+#else
     vol->volume_scale = gtk_vscale_new(GTK_ADJUSTMENT(gtk_adjustment_new(100, 0, 100, 0, 0, 0)));
+#endif
     gtk_scale_set_draw_value(GTK_SCALE(vol->volume_scale), FALSE);
     gtk_range_set_inverted(GTK_RANGE(vol->volume_scale), TRUE);
     gtk_box_pack_start(GTK_BOX(box), vol->volume_scale, TRUE, TRUE, 0);
@@ -1542,10 +1550,14 @@ static void volumealsa_panel_configuration_changed(LXPanel *panel, GtkWidget *p)
 
 static gboolean volumealsa_update_context_menu(GtkWidget *plugin, GtkMenu *menu)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *menu_item = gtk_menu_item_new_with_label(_("Launch Mixer"));
+#else
     GtkWidget *img = gtk_image_new_from_stock("gtk-directory", GTK_ICON_SIZE_MENU);
     GtkWidget *menu_item = gtk_image_menu_item_new_with_label(_("Launch Mixer"));
     //FIXME: precheck and disable if MixerCommand not set
     gtk_image_menu_item_set_image((GtkImageMenuItem *)menu_item, img);
+#endif
     g_signal_connect_swapped(menu_item, "activate", G_CALLBACK(volume_run_mixer),
                              lxpanel_plugin_get_data(plugin));
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
diff --git a/plugins/weather/weatherwidget.c b/plugins/weather/weatherwidget.c
index bee91ec..33b6754 100644
--- a/plugins/weather/weatherwidget.c
+++ b/plugins/weather/weatherwidget.c
@@ -37,8 +37,12 @@
 #include "gtk-compat.h"
 
 /* Private structure, property and signal definitions. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+#define GTK_WEATHER_GET_PRIVATE(obj) ((GtkWeatherPrivate *)((GTK_WEATHER (obj))->priv))
+#else
 #define GTK_WEATHER_GET_PRIVATE(obj) (G_TYPE_INSTANCE_GET_PRIVATE ((obj), \
                                       GTK_WEATHER_TYPE, GtkWeatherPrivate))
+#endif
 
 /* This will exit the app gracefully... */
 #ifdef DEBUG
@@ -269,7 +273,9 @@ gtk_weather_class_init(GtkWeatherClass * klass)
   widget_class->size_allocate      = gtk_weather_size_allocate;
   widget_class->button_press_event = gtk_weather_button_pressed;
   
+#if !GTK_CHECK_VERSION(3, 0, 0)
   g_type_class_add_private(klass, sizeof(GtkWeatherPrivate));
+#endif
 
   g_object_class_install_property(gobject_class, PROP_LOCATION,
                                   g_param_spec_pointer("location",
@@ -317,12 +323,23 @@ gtk_weather_init(GtkWeather * weather)
 {
   LXW_LOG(LXW_DEBUG, "GtkWeather::init()");
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  weather->priv = (GtkWeatherPrivate *) g_malloc0 (sizeof (GtkWeatherPrivate));
+#endif
   GtkWeatherPrivate * priv = GTK_WEATHER_GET_PRIVATE(weather);
 
   /* Box layout internals */
+#if GTK_CHECK_VERSION(3, 0, 0)
+  priv->hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 1);
+#else
   priv->hbox = gtk_hbox_new(FALSE, 1);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  priv->image = gtk_image_new_from_icon_name("gtk-dialog-error", GTK_ICON_SIZE_BUTTON);
+#else
   priv->image = gtk_image_new_from_stock(GTK_STOCK_DIALOG_ERROR, GTK_ICON_SIZE_BUTTON);
+#endif
 
   priv->label = gtk_label_new(GTK_WEATHER_NOT_AVAILABLE_LABEL);
 
@@ -387,6 +404,14 @@ gtk_weather_destroy(GObject * object)
   priv->previous_location = NULL;
   priv->location = NULL;
   priv->forecast = NULL;
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+  if (priv != NULL)
+  {
+    g_free (priv);
+    weather->priv = NULL;
+  }
+#endif
 }
 
 /**
@@ -472,7 +497,11 @@ gtk_weather_render(GtkWeather * weather)
 
       GtkRequisition req;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_widget_get_preferred_size(GTK_WIDGET(priv->hbox), NULL, &req);
+#else
       gtk_widget_size_request(GTK_WIDGET(priv->hbox), &req);
+#endif
 
       /* req will hold valid data for painted widget, so disregard if we're
        * running in a single app 
@@ -510,15 +539,27 @@ gtk_weather_render(GtkWeather * weather)
       /* N/A */
       if (priv->location)
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+          gtk_image_set_from_icon_name(GTK_IMAGE(priv->image),
+                                   "gtk-dialog-warning",
+                                   GTK_ICON_SIZE_BUTTON);
+#else
           gtk_image_set_from_stock(GTK_IMAGE(priv->image), 
                                    GTK_STOCK_DIALOG_WARNING, 
                                    GTK_ICON_SIZE_BUTTON);
+#endif
         }
       else
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+          gtk_image_set_from_icon_name(GTK_IMAGE(priv->image),
+                                   "gtk-dialog-error",
+                                   GTK_ICON_SIZE_BUTTON);
+#else
           gtk_image_set_from_stock(GTK_IMAGE(priv->image), 
                                    GTK_STOCK_DIALOG_ERROR, 
                                    GTK_ICON_SIZE_BUTTON);
+#endif
         }
 
       weather_set_label_text(GTK_WIDGET(weather), priv->label,
@@ -806,8 +847,13 @@ gtk_weather_change_location(GtkWidget * widget, GdkEventButton * event)
   GtkWidget * dialog = gtk_dialog_new_with_buttons(_("Enter New Location"),
                                                    GTK_WINDOW(priv->preferences_data.dialog),
                                                    GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                   _("_OK"), GTK_RESPONSE_ACCEPT,
+                                                   _("_Cancel"), GTK_RESPONSE_REJECT,
+#else
                                                    GTK_STOCK_OK, GTK_RESPONSE_ACCEPT,
                                                    GTK_STOCK_CANCEL, GTK_RESPONSE_REJECT,
+#endif
                                                    NULL);
 
   /* Set dialog window icon */
@@ -826,23 +872,39 @@ gtk_weather_change_location(GtkWidget * widget, GdkEventButton * event)
                    G_CALLBACK(gtk_weather_key_pressed),
                    (gpointer)dialog);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * image = gtk_image_new_from_icon_name("gtk-dialog-info", GTK_ICON_SIZE_DIALOG);
+#else
   GtkWidget * image = gtk_image_new_from_stock(GTK_STOCK_DIALOG_INFO, GTK_ICON_SIZE_DIALOG);
+#endif
 
   GtkWidget * description_label = gtk_label_new(_("Enter the:\n- city, or\n- city and state/country, or\n- postal code\nfor which to retrieve the weather forecast."));
 
   gtk_label_set_justify(GTK_LABEL(description_label), GTK_JUSTIFY_LEFT);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * entry_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);
+#else
   GtkWidget * entry_hbox = gtk_hbox_new(FALSE, 10);
+#endif
 
   gtk_box_pack_start(GTK_BOX(entry_hbox), location_label, FALSE, FALSE, 5);
   gtk_box_pack_end(GTK_BOX(entry_hbox), location_entry, FALSE, FALSE, 5);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * entry_vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 10);
+#else
   GtkWidget * entry_vbox = gtk_vbox_new(FALSE, 10);
+#endif
 
   gtk_box_pack_start(GTK_BOX(entry_vbox), description_label, FALSE, FALSE, 5);
   gtk_box_pack_start(GTK_BOX(entry_vbox), entry_hbox, FALSE, FALSE, 5);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * label_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);
+#else
   GtkWidget * label_hbox = gtk_hbox_new(FALSE, 10);
+#endif
 
   gtk_box_pack_start(GTK_BOX(label_hbox), image, FALSE, FALSE, 5);
   gtk_box_pack_start(GTK_BOX(label_hbox), entry_vbox, FALSE, FALSE, 5);
@@ -1253,8 +1315,13 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
   priv->preferences_data.dialog = gtk_dialog_new_with_buttons(_("Weather Preferences"),
                                                               NULL,
                                                               GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                              _("_OK"), GTK_RESPONSE_ACCEPT,
+                                                              _("_Cancel"), GTK_RESPONSE_REJECT,
+#else
                                                               GTK_STOCK_OK, GTK_RESPONSE_ACCEPT,
                                                               GTK_STOCK_CANCEL, GTK_RESPONSE_REJECT,
+#endif
                                                               NULL);
 
   /* Set dialog window icon */
@@ -1266,7 +1333,11 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
 
   GtkWidget * location_frame = gtk_frame_new(_("Current Location"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * location_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 1);
+#else
   GtkWidget * location_hbox = gtk_hbox_new(FALSE, 1);
+#endif
 
   priv->preferences_data.location_label = gtk_label_new(_("None configured"));
 
@@ -1293,7 +1364,11 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
 
   GtkWidget * display_frame = gtk_frame_new(_("Display"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * display_table = gtk_grid_new();
+#else
   GtkWidget * display_table = gtk_table_new(2, 2, FALSE);
+#endif
 
   GtkWidget * alias_label = gtk_label_new(_("Name:"));
 
@@ -1301,7 +1376,12 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
 
   GtkWidget * button_label = gtk_label_new(_("Units:"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * button_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);
+  gtk_box_set_homogeneous (GTK_BOX (button_hbox), TRUE);
+#else
   GtkWidget * button_hbox = gtk_hbox_new(TRUE, 10);
+#endif
 
   priv->preferences_data.c_button = gtk_radio_button_new_with_mnemonic(NULL, _("_Metric (\302\260C)"));
 
@@ -1310,6 +1390,23 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
   gtk_box_pack_end(GTK_BOX(button_hbox), priv->preferences_data.c_button, FALSE, FALSE, 1);
   gtk_box_pack_end(GTK_BOX(button_hbox), priv->preferences_data.f_button, FALSE, FALSE, 1);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  gtk_grid_attach(GTK_GRID(display_table), 
+                   alias_label,
+                   0,0,1,1);
+
+  gtk_grid_attach(GTK_GRID(display_table), 
+                   priv->preferences_data.alias_entry,
+                   1,0,1,1);
+
+  gtk_grid_attach(GTK_GRID(display_table), 
+                   button_label,
+                   0,1,1,1);
+
+  gtk_grid_attach(GTK_GRID(display_table), 
+                   button_hbox,
+                   1,1,1,1);
+#else
   gtk_table_attach(GTK_TABLE(display_table), 
                    alias_label,
                    0,1,0,1,
@@ -1337,16 +1434,26 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
                    GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                    GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                    10,5);
+#endif
 
   gtk_container_add(GTK_CONTAINER(display_frame), display_table);
 
   GtkWidget * forecast_frame = gtk_frame_new(_("Forecast"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * forecast_table = gtk_grid_new();
+#else
   GtkWidget * forecast_table = gtk_table_new(2, 2, FALSE);
+#endif
 
   GtkWidget * update_label = gtk_label_new(_("Updates:"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * update_vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 10);
+  gtk_box_set_homogeneous (GTK_BOX (update_vbox), TRUE);
+#else
   GtkWidget * update_vbox = gtk_vbox_new(TRUE, 10);
+#endif
 
   priv->preferences_data.manual_button = gtk_radio_button_new_with_mnemonic(NULL, _("Ma_nual"));
 
@@ -1369,7 +1476,11 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
                            G_CALLBACK(gtk_weather_auto_update_toggled),
                            weather);*/
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  GtkWidget * auto_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 2);
+#else
   GtkWidget * auto_hbox = gtk_hbox_new(FALSE, 2);
+#endif
 
   priv->preferences_data.auto_spin_button = gtk_spin_button_new_with_range(20, 120, 10);
   
@@ -1410,6 +1521,23 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
   gtk_cell_layout_set_attributes(GTK_CELL_LAYOUT(provider_button), column, "text", 0, NULL);
   gtk_combo_box_set_active(GTK_COMBO_BOX(provider_button), provider_active);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  gtk_grid_attach(GTK_GRID(forecast_table), 
+                   update_label,
+                   0,0,1,1);
+
+  gtk_grid_attach(GTK_GRID(forecast_table), 
+                   update_vbox,
+                   1,0,1,1);
+
+  gtk_grid_attach(GTK_GRID(forecast_table), 
+                   source_label,
+                   0,1,1,1);
+
+  gtk_grid_attach(GTK_GRID(forecast_table), 
+                   provider_button,
+                   1,1,1,1);
+#else
   gtk_table_attach(GTK_TABLE(forecast_table), 
                    update_label,
                    0,1,0,1,
@@ -1437,6 +1565,7 @@ gtk_weather_create_preferences_dialog(GtkWeather * weather, provider_callback_in
                    GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                    GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                    10,5);
+#endif
 
   gtk_container_add(GTK_CONTAINER(forecast_frame), forecast_table);
 
@@ -1615,16 +1744,33 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * dialog = gtk_dialog_new_with_buttons(dialog_title,
                                                        NULL,
                                                        GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                       _("_Refresh"), GTK_RESPONSE_APPLY,
+                                                       _("_OK"), GTK_RESPONSE_ACCEPT,
+#else
                                                        GTK_STOCK_REFRESH, GTK_RESPONSE_APPLY,
                                                        GTK_STOCK_OK, GTK_RESPONSE_ACCEPT,
+#endif
                                                        NULL);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      GtkWidget * everything_hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 5);
+#else
       GtkWidget * everything_hbox = gtk_hbox_new(FALSE, 5);
+#endif
 
       /* This vbox gets filled-in when the table is populated */
+#if GTK_CHECK_VERSION(3, 0, 0)
+      GtkWidget * icon_vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 1);
+#else
       GtkWidget * icon_vbox = gtk_vbox_new(FALSE, 1);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      GtkWidget * forecast_table = gtk_grid_new();
+#else
       GtkWidget * forecast_table = gtk_table_new(9, 2, FALSE);
+#endif
 
       gchar * location_label_text = g_strconcat((location->pcCity_)?location->pcCity_:"",
                                                 (location->pcCity_ && location->pcState_)?", ":"",
@@ -1636,12 +1782,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * location_name_label = gtk_label_new(_("Location:"));
       GtkWidget * location_name_text  = gtk_label_new(location_label_text);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (location_name_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (location_name_text), 0.0);
+#else
       GtkWidget * label_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       GtkWidget * text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
 
       gtk_container_add(GTK_CONTAINER(label_alignment), location_name_label);
       gtk_container_add(GTK_CONTAINER(text_alignment), location_name_text);
+#endif
       
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       location_name_label,
+                       0,0,1,1);
+
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       location_name_text,
+                       1,0,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        label_alignment,
                        0,1,0,1,
@@ -1655,16 +1815,31 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       GtkWidget * updated_label = gtk_label_new(_("Last updated:"));
       GtkWidget * updated_text = gtk_label_new(forecast->pcTime_);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (updated_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (updated_text), 0.0);
+#else
       GtkWidget * updated_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       GtkWidget * updated_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
 
       gtk_container_add(GTK_CONTAINER(updated_alignment), updated_label);
       gtk_container_add(GTK_CONTAINER(updated_text_alignment), updated_text);
+#endif
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       updated_label,
+                       0,1,1,1);
 
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       updated_text,
+                       1,1,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        updated_alignment,
                        0,1,1,2,
@@ -1678,6 +1853,7 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       gchar * feels = NULL;
 
@@ -1693,12 +1869,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
           GtkWidget * feels_label = gtk_label_new(_("Feels like:"));
           GtkWidget * feels_text = gtk_label_new(feels);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+          gtk_label_set_xalign (GTK_LABEL (feels_label), 0.0);
+          gtk_label_set_xalign (GTK_LABEL (feels_text), 0.0);
+#else
           GtkWidget * feels_alignment = gtk_alignment_new(0, 0.5, 0, 0);
           gtk_container_add(GTK_CONTAINER(feels_alignment), feels_label);
 
           GtkWidget * feels_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
           gtk_container_add(GTK_CONTAINER(feels_text_alignment), feels_text);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+          gtk_grid_attach(GTK_GRID(forecast_table), 
+                           feels_label,
+                           0,2,1,1);
+
+          gtk_grid_attach(GTK_GRID(forecast_table), 
+                           feels_text,
+                           1,2,1,1);
+#else
           gtk_table_attach(GTK_TABLE(forecast_table),
                            feels_alignment,
                            0,1,2,3,
@@ -1712,6 +1902,7 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                            GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                            GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                            2,2);
+#endif
         }
 
       gchar * humidity = g_strdup_printf("%d%%", forecast->iHumidity_);
@@ -1719,12 +1910,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * humidity_label = gtk_label_new(_("Humidity:"));
       GtkWidget * humidity_text = gtk_label_new(humidity);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (humidity_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (humidity_text), 0.0);
+#else
       GtkWidget * humidity_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(humidity_alignment), humidity_label);
 
       GtkWidget * humidity_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(humidity_text_alignment), humidity_text);
+#endif
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       humidity_label,
+                       0,3,1,1);
 
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       humidity_text,
+                       1,3,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        humidity_alignment,
                        0,1,3,4,
@@ -1738,6 +1943,7 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       gchar * pressure = g_strdup_printf("%4.2f %s", 
                                          forecast->dPressure_,
@@ -1746,12 +1952,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * pressure_label = gtk_label_new(_("Pressure:"));
       GtkWidget * pressure_text = gtk_label_new(pressure);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (pressure_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (pressure_text), 0.0);
+#else
       GtkWidget * pressure_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(pressure_alignment), pressure_label);
 
       GtkWidget * pressure_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(pressure_text_alignment), pressure_text);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       pressure_label,
+                       0,4,1,1);
+
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       pressure_text,
+                       1,4,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        pressure_alignment,
                        0,1,4,5,
@@ -1765,6 +1985,7 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       gchar * visibility = g_strdup_printf("%4.2f %s", 
                                          forecast->dVisibility_,
@@ -1773,12 +1994,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * visibility_label = gtk_label_new(_("Visibility:"));
       GtkWidget * visibility_text = gtk_label_new(visibility);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (visibility_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (visibility_text), 0.0);
+#else
       GtkWidget * visibility_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(visibility_alignment), visibility_label);
 
       GtkWidget * visibility_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(visibility_text_alignment), visibility_text);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       visibility_label,
+                       0,5,1,1);
+
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       visibility_text,
+                       1,5,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        visibility_alignment,
                        0,1,5,6,
@@ -1792,6 +2027,7 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       gchar * wind = g_strdup_printf("%s, %d %s",
                                      forecast->pcWindDirection_,
@@ -1801,12 +2037,26 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       GtkWidget * wind_label = gtk_label_new(_("Wind:"));
       GtkWidget * wind_text = gtk_label_new(wind);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (wind_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (wind_text), 0.0);
+#else
       GtkWidget * wind_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(wind_alignment), wind_label);
 
       GtkWidget * wind_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(wind_text_alignment), wind_text);
+#endif
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       wind_label,
+                       0,6,1,1);
 
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       wind_text,
+                       1,6,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        wind_alignment,
                        0,1,6,7,
@@ -1820,16 +2070,31 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       GtkWidget * sunrise_label = gtk_label_new(_("Sunrise:"));
       GtkWidget * sunrise_text = gtk_label_new(forecast->pcSunrise_);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (sunrise_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (sunrise_text), 0.0);
+#else
       GtkWidget * sunrise_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(sunrise_alignment), sunrise_label);
 
       GtkWidget * sunrise_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(sunrise_text_alignment), sunrise_text);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       sunrise_label,
+                       0,7,1,1);
+
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       sunrise_text,
+                       1,7,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        sunrise_alignment,
                        0,1,7,8,
@@ -1843,16 +2108,31 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       GtkWidget * sunset_label = gtk_label_new(_("Sunset:"));
       GtkWidget * sunset_text = gtk_label_new(forecast->pcSunset_);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_label_set_xalign (GTK_LABEL (sunset_label), 0.0);
+      gtk_label_set_xalign (GTK_LABEL (sunset_text), 0.0);
+#else
       GtkWidget * sunset_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(sunset_alignment), sunset_label);
 
       GtkWidget * sunset_text_alignment = gtk_alignment_new(0, 0.5, 0, 0);
       gtk_container_add(GTK_CONTAINER(sunset_text_alignment), sunset_text);
+#endif
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       sunset_label,
+                       0,8,1,1);
 
+      gtk_grid_attach(GTK_GRID(forecast_table), 
+                       sunset_text,
+                       1,8,1,1);
+#else
       gtk_table_attach(GTK_TABLE(forecast_table), 
                        sunset_alignment,
                        0,1,8,9,
@@ -1866,12 +2146,18 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        GTK_EXPAND | GTK_FILL | GTK_SHRINK,
                        2,2);
+#endif
 
       /* Image and conditions label. Image is filled after dialog is shown 
        * to nicely scale the image pixbuf.
        */
+#if GTK_CHECK_VERSION(3, 0, 0)
+      GtkWidget * icon_image = gtk_image_new_from_icon_name("gtk-missing-image",
+                                                        GTK_ICON_SIZE_MENU);
+#else
       GtkWidget * icon_image = gtk_image_new_from_stock(GTK_STOCK_MISSING_IMAGE,
                                                         GTK_ICON_SIZE_MENU);
+#endif
 
       gchar * conditions_label_text = g_strdup_printf("<b>%d \302\260%s %s%s%s</b>", 
                                                       forecast->iTemperature_,
@@ -1917,7 +2203,11 @@ gtk_weather_run_conditions_dialog(GtkWeather * weather)
       /* Get dimensions to create proper icon... */
       GtkRequisition req;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+      gtk_widget_get_preferred_size(dialog, NULL, &req);
+#else
       gtk_widget_size_request(dialog, &req);
+#endif
 
       /* Need the minimum */
       gint dim = (req.width < req.height) ? req.width/2 : req.height/2;
@@ -1983,13 +2273,19 @@ gtk_weather_show_location_progress_bar(GtkWeather * weather)
   GtkWidget * dialog = gtk_dialog_new_with_buttons(progress_str,
                                                    GTK_WINDOW(priv->preferences_data.dialog),
                                                    GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                   _("_Cancel"),
+#else
                                                    GTK_STOCK_CANCEL,
+#endif
                                                    GTK_RESPONSE_CANCEL,
                                                    NULL);
 
   //  gtk_window_set_decorated(GTK_WINDOW(dialog), FALSE);
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
   GtkWidget * alignment = gtk_alignment_new(0.5, 0.5, 0.5, 0.5);
+#endif
 
   GtkWidget * progress_bar = gtk_progress_bar_new();
 
@@ -2001,9 +2297,15 @@ gtk_weather_show_location_progress_bar(GtkWeather * weather)
 
   gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(progress_bar), 0.5);
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
   gtk_container_add(GTK_CONTAINER(alignment), progress_bar);
+#endif
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+  gtk_box_pack_start(GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), progress_bar, TRUE, TRUE, 0);
+#else
   gtk_box_pack_start(GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), alignment, TRUE, TRUE, 0);
+#endif
 
   int timer = g_timeout_add(500, gtk_weather_update_location_progress_bar, &priv->location_data);
 
@@ -2110,8 +2412,13 @@ gtk_weather_show_location_list(GtkWeather * weather, GList * list)
   GtkWidget * dialog = gtk_dialog_new_with_buttons(dialog_str,
                                                    GTK_WINDOW(priv->preferences_data.dialog),
                                                    GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                   _("_OK"), GTK_RESPONSE_ACCEPT,
+                                                   _("_Cancel"), GTK_RESPONSE_REJECT,
+#else
                                                    GTK_STOCK_OK, GTK_RESPONSE_ACCEPT,
                                                    GTK_STOCK_CANCEL, GTK_RESPONSE_REJECT,
+#endif
                                                    NULL);
 
   gtk_widget_set_size_request(dialog, 300, 250);
diff --git a/plugins/weather/weatherwidget.h b/plugins/weather/weatherwidget.h
index c12913b..e896cb0 100644
--- a/plugins/weather/weatherwidget.h
+++ b/plugins/weather/weatherwidget.h
@@ -46,6 +46,9 @@ typedef struct _GtkWeatherClass GtkWeatherClass;
 struct _GtkWeather
 {
   GtkEventBox widget;
+#if GTK_CHECK_VERSION(3, 0, 0)
+  gpointer priv;
+#endif
 };
 
 struct _GtkWeatherClass
diff --git a/plugins/xkb/xkb-plugin.c b/plugins/xkb/xkb-plugin.c
index 5b4d4a7..aeeb587 100644
--- a/plugins/xkb/xkb-plugin.c
+++ b/plugins/xkb/xkb-plugin.c
@@ -272,7 +272,11 @@ static GtkWidget *xkb_constructor(LXPanel *panel, config_setting_t *settings)
     lxpanel_plugin_set_data(p, p_xkb, xkb_destructor);
 
     /* Create a horizontal box as the child of the button. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+#else
     GtkWidget * hbox = gtk_hbox_new(FALSE, 0);
+#endif
     gtk_container_set_border_width(GTK_CONTAINER(hbox), 3);
     gtk_container_add(GTK_CONTAINER(p), hbox);
     gtk_widget_show(hbox);
@@ -396,7 +400,11 @@ static void on_xkb_checkbutton_keep_system_layouts_toggled(GtkToggleButton *tb,
 
         if(!p_xkb->keep_system_layouts)
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_entry_set_icon_from_icon_name(GTK_ENTRY(p_xkb->p_entry_advanced_opt), GTK_ENTRY_ICON_SECONDARY, "gtk-save");
+#else
             gtk_entry_set_icon_from_stock(GTK_ENTRY(p_xkb->p_entry_advanced_opt), GTK_ENTRY_ICON_SECONDARY, "gtk-save");
+#endif
             xkb_update_layouts_n_variants(p_xkb);
         }
         else
@@ -590,8 +598,13 @@ static void on_button_kbd_model_clicked(GtkButton *p_button, gpointer *p_data)
     GtkWidget *p_dialog = gtk_dialog_new_with_buttons(_("Select Keyboard Model"),
                             p_xkb->p_dialog_config,
                             GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                            _("_Cancel"), GTK_RESPONSE_CANCEL,
+                            _("_OK"), GTK_RESPONSE_OK,
+#else
                             GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                             GTK_STOCK_OK, GTK_RESPONSE_OK,
+#endif
                             NULL);
 
     // scrolledwindow
@@ -605,7 +618,9 @@ static void on_button_kbd_model_clicked(GtkButton *p_button, gpointer *p_data)
     GtkListStore *p_liststore_kbd_model = gtk_list_store_new(NUM_MODEL_COLUMNS, G_TYPE_STRING, G_TYPE_STRING);
     GtkWidget *p_treeview_kbd_model = gtk_tree_view_new_with_model(GTK_TREE_MODEL(p_liststore_kbd_model));
     g_object_unref(G_OBJECT(p_liststore_kbd_model));
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_tree_view_set_rules_hint(GTK_TREE_VIEW(p_treeview_kbd_model), TRUE);
+#endif
     gtk_container_add(GTK_CONTAINER(p_scrolledwindow_kbd_model), p_treeview_kbd_model);
     GtkCellRenderer *p_renderer;
     GtkTreeViewColumn *p_column;
@@ -714,8 +729,13 @@ static void on_button_kbd_change_layout_clicked(GtkButton *p_button, gpointer *p
     GtkWidget *p_dialog = gtk_dialog_new_with_buttons(_("Select Layout Change Type"),
                             p_xkb->p_dialog_config,
                             GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                            _("_Cancel"), GTK_RESPONSE_CANCEL,
+                            _("_OK"), GTK_RESPONSE_OK,
+#else
                             GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                             GTK_STOCK_OK, GTK_RESPONSE_OK,
+#endif
                             NULL);
 
     // scrolledwindow
@@ -729,7 +749,9 @@ static void on_button_kbd_change_layout_clicked(GtkButton *p_button, gpointer *p
     GtkListStore *p_liststore_kbd_change = gtk_list_store_new(NUM_CHANGE_COLUMNS, G_TYPE_STRING, G_TYPE_STRING, G_TYPE_BOOLEAN, G_TYPE_INT);
     GtkWidget *p_treeview_kbd_change = gtk_tree_view_new_with_model(GTK_TREE_MODEL(p_liststore_kbd_change));
     g_object_unref(G_OBJECT(p_liststore_kbd_change));
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_tree_view_set_rules_hint(GTK_TREE_VIEW(p_treeview_kbd_change), TRUE);
+#endif
     gtk_container_add(GTK_CONTAINER(p_scrolledwindow_kbd_change), p_treeview_kbd_change);
     GtkCellRenderer *p_renderer;
     GtkTreeViewColumn *p_column;
@@ -887,8 +909,13 @@ static void on_button_add_layout_clicked(GtkButton *p_button, gpointer *p_data)
     GtkWidget *p_dialog = gtk_dialog_new_with_buttons(_("Add Keyboard Layout"),
                             p_xkb->p_dialog_config,
                             GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                            _("_Cancel"), GTK_RESPONSE_CANCEL,
+                            _("_OK"), GTK_RESPONSE_OK,
+#else
                             GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                             GTK_STOCK_OK, GTK_RESPONSE_OK,
+#endif
                             NULL);
 
     // scrolledwindow
@@ -1212,16 +1239,27 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
         _("Keyboard Layout Handler"),
         NULL,
         GTK_DIALOG_NO_SEPARATOR,
+#if GTK_CHECK_VERSION(3, 0, 0)
+        _("_Close"),
+#else
         GTK_STOCK_CLOSE,
+#endif
         GTK_RESPONSE_OK,
         NULL);
     p_xkb->p_dialog_config = GTK_WINDOW(dlg);
     panel_apply_icon(p_xkb->p_dialog_config);
 
     // main vbox of the config dialog
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * p_hbox_main = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+    gtk_box_set_homogeneous (GTK_BOX (p_hbox_main), TRUE);
+    GtkWidget * p_vbox_left = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
+    GtkWidget * p_vbox_right = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
+#else
     GtkWidget * p_hbox_main = gtk_hbox_new(TRUE, 0);
     GtkWidget * p_vbox_left = gtk_vbox_new(FALSE, 0);
     GtkWidget * p_vbox_right = gtk_vbox_new(FALSE, 0);
+#endif
     gtk_container_add(GTK_CONTAINER(gtk_dialog_get_content_area(GTK_DIALOG(dlg))),
                       p_hbox_main);
     gtk_box_pack_start(GTK_BOX(p_hbox_main), p_vbox_left, FALSE, TRUE, 0);
@@ -1234,20 +1272,30 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_label_kbd_model = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Keyboard Model"));
     gtk_label_set_markup(GTK_LABEL(p_label_kbd_model), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_kbd_model, 1);
+    gtk_widget_set_margin_end (p_label_kbd_model, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_kbd_model), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_xkb->p_frame_kbd_model), p_label_kbd_model);
     gtk_frame_set_shadow_type(GTK_FRAME(p_xkb->p_frame_kbd_model), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_left), p_xkb->p_frame_kbd_model, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_xkb->p_frame_kbd_model), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_kbd_model = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_kbd_model), p_alignment_kbd_model);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_kbd_model), 4, 4, 10, 10);
+#endif
     p_xkb->p_button_kbd_model = gtk_button_new_with_label(p_xkb->kbd_model);
     g_signal_connect(p_xkb->p_button_kbd_model, "clicked", G_CALLBACK(on_button_kbd_model_clicked), p_xkb);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_kbd_model), p_xkb->p_button_kbd_model);
+#else
     gtk_container_add(GTK_CONTAINER(p_alignment_kbd_model), p_xkb->p_button_kbd_model);
-
+#endif
 
     // 'KEYBOARD LAYOUTS' frame
     p_xkb->p_frame_kbd_layouts = gtk_frame_new(NULL);
@@ -1255,7 +1303,12 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_label_kbd_layouts = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Keyboard Layouts"));
     gtk_label_set_markup(GTK_LABEL(p_label_kbd_layouts), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_kbd_layouts, 1);
+    gtk_widget_set_margin_end (p_label_kbd_layouts, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_kbd_layouts), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_xkb->p_frame_kbd_layouts), p_label_kbd_layouts);
     gtk_frame_set_shadow_type(GTK_FRAME(p_xkb->p_frame_kbd_layouts), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_left), p_xkb->p_frame_kbd_layouts, TRUE, TRUE, 2);
@@ -1263,23 +1316,41 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     gtk_widget_set_size_request(GTK_WIDGET(p_xkb->p_frame_kbd_layouts), 300, 180);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_kbd_layouts = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_kbd_layouts), p_alignment_kbd_layouts);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_kbd_layouts), 4, 4, 10, 10);
+#endif
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * p_hbox_kbd_layouts = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+    gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_kbd_layouts), p_hbox_kbd_layouts);
+#else
     GtkWidget * p_hbox_kbd_layouts = gtk_hbox_new(FALSE, 0);
     gtk_container_add(GTK_CONTAINER(p_alignment_kbd_layouts), p_hbox_kbd_layouts);
+#endif
 
     // scrolledwindow and buttons
     GtkWidget * p_scrolledwindow_kbd_layouts = gtk_scrolled_window_new(NULL, NULL);
     gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(p_scrolledwindow_kbd_layouts),
                                    GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);
     gtk_box_pack_start(GTK_BOX(p_hbox_kbd_layouts), p_scrolledwindow_kbd_layouts, TRUE, TRUE, 2);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * p_vbox_kbd_layouts = gtk_box_new(GTK_ORIENTATION_VERTICAL, 2);
+#else
     GtkWidget * p_vbox_kbd_layouts = gtk_vbox_new(FALSE, 2);
+#endif
     gtk_box_pack_start(GTK_BOX(p_hbox_kbd_layouts), p_vbox_kbd_layouts, FALSE, TRUE, 4);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * p_button_add_layout = gtk_button_new_with_label(_("_Add"));
+    GtkWidget * p_button_up_layout = gtk_button_new_with_label(_("_Up"));
+    GtkWidget * p_button_down_layout = gtk_button_new_with_label(_("_Down"));
+    p_xkb->p_button_rm_layout = gtk_button_new_with_label(_("_Remove"));
+#else
     GtkWidget * p_button_add_layout = gtk_button_new_from_stock(GTK_STOCK_ADD);
     GtkWidget * p_button_up_layout = gtk_button_new_from_stock(GTK_STOCK_GO_UP);
     GtkWidget * p_button_down_layout = gtk_button_new_from_stock(GTK_STOCK_GO_DOWN);
     p_xkb->p_button_rm_layout = gtk_button_new_from_stock(GTK_STOCK_REMOVE);
+#endif
     g_signal_connect(p_button_add_layout, "clicked", G_CALLBACK(on_button_add_layout_clicked), p_xkb);
     g_signal_connect(p_xkb->p_button_rm_layout, "clicked", G_CALLBACK(on_button_rm_layout_clicked), p_xkb);
     g_signal_connect(p_button_up_layout, "clicked", G_CALLBACK(on_button_up_layout_clicked), p_xkb);
@@ -1318,43 +1389,69 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_label_change_layout = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Change Layout Option"));
     gtk_label_set_markup(GTK_LABEL(p_label_change_layout), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_change_layout, 1);
+    gtk_widget_set_margin_end (p_label_change_layout, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_change_layout), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_xkb->p_frame_change_layout), p_label_change_layout);
     gtk_frame_set_shadow_type(GTK_FRAME(p_xkb->p_frame_change_layout), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_left), p_xkb->p_frame_change_layout, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_xkb->p_frame_change_layout), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_change_layout = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_change_layout), p_alignment_change_layout);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_change_layout), 4, 4, 10, 10);
+#endif
     p_xkb->p_button_change_layout = gtk_button_new_with_label(p_xkb->kbd_change_option);
     g_signal_connect(p_xkb->p_button_change_layout, "clicked", G_CALLBACK(on_button_kbd_change_layout_clicked), p_xkb);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_container_add(GTK_CONTAINER(p_xkb->p_frame_change_layout), p_xkb->p_button_change_layout);
+#else
     gtk_container_add(GTK_CONTAINER(p_alignment_change_layout), p_xkb->p_button_change_layout);
-
+#endif
 
     // 'ADVANCED setxkbmap OPTIONS' frame
     GtkWidget * p_frame_advanced_opt = gtk_frame_new(NULL);
     GtkWidget * p_label_advanced_opt = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Advanced setxkbmap Options"));
     gtk_label_set_markup(GTK_LABEL(p_label_advanced_opt), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_advanced_opt, 1);
+    gtk_widget_set_margin_end (p_label_advanced_opt, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_advanced_opt), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_frame_advanced_opt), p_label_advanced_opt);
     gtk_frame_set_shadow_type(GTK_FRAME(p_frame_advanced_opt), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_right), p_frame_advanced_opt, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_frame_advanced_opt), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_advanced_opt = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_frame_advanced_opt), p_alignment_advanced_opt);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_advanced_opt), 4, 4, 10, 10);
+#endif
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget * p_vbox_advanced_opt = gtk_box_new(GTK_ORIENTATION_VERTICAL, 0);
+    gtk_container_add(GTK_CONTAINER(p_frame_advanced_opt), p_vbox_advanced_opt);
+#else
     GtkWidget * p_vbox_advanced_opt = gtk_vbox_new(FALSE, 0);
     gtk_container_add(GTK_CONTAINER(p_alignment_advanced_opt), p_vbox_advanced_opt);
+#endif
     p_xkb->p_entry_advanced_opt = gtk_entry_new();
     gtk_widget_set_sensitive(p_xkb->p_entry_advanced_opt, !p_xkb->keep_system_layouts);
     if (p_xkb->kbd_advanced_options)
         gtk_entry_set_text(GTK_ENTRY(p_xkb->p_entry_advanced_opt), p_xkb->kbd_advanced_options);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_entry_set_icon_from_icon_name(GTK_ENTRY(p_xkb->p_entry_advanced_opt), GTK_ENTRY_ICON_SECONDARY, "gtk-save");
+#else
     gtk_entry_set_icon_from_stock(GTK_ENTRY(p_xkb->p_entry_advanced_opt), GTK_ENTRY_ICON_SECONDARY, "gtk-save");
+#endif
     g_signal_connect(p_xkb->p_entry_advanced_opt, "icon-press", G_CALLBACK(on_xkb_entry_advanced_opt_icon_press), p_xkb);
     gtk_box_pack_start(GTK_BOX(p_vbox_advanced_opt), p_xkb->p_entry_advanced_opt, FALSE, TRUE, 0);
     p_xkb->p_checkbutton_no_reset_opt = gtk_check_button_new_with_mnemonic(_("Do _not reset existing options"));
@@ -1373,40 +1470,62 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_label_perapp_layout = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Per Window Settings"));
     gtk_label_set_markup(GTK_LABEL(p_label_perapp_layout), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_perapp_layout, 1);
+    gtk_widget_set_margin_end (p_label_perapp_layout, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_perapp_layout), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_frame_perapp_layout), p_label_perapp_layout);
     gtk_frame_set_shadow_type(GTK_FRAME(p_frame_perapp_layout), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_right), p_frame_perapp_layout, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_frame_perapp_layout), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_perapp_layout = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_frame_perapp_layout), p_alignment_perapp_layout);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_perapp_layout), 4, 4, 10, 10);
+#endif
     GtkWidget *p_checkbutton_per_app = gtk_check_button_new_with_mnemonic(_("_Remember layout for each window"));
     gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(p_checkbutton_per_app), p_xkb->enable_perwin);
     g_signal_connect(p_checkbutton_per_app, "toggled", G_CALLBACK(on_xkb_checkbutton_per_app_toggled), p_xkb);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_container_add(GTK_CONTAINER(p_frame_perapp_layout), p_checkbutton_per_app);
+#else
     gtk_container_add(GTK_CONTAINER(p_alignment_perapp_layout), p_checkbutton_per_app);
-
+#endif
 
     // 'SHOW LAYOUT AS' frame
     GtkWidget * p_frame_display_type = gtk_frame_new(NULL);
     GtkWidget * p_label_show_layout_as = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Show Layout as"));
     gtk_label_set_markup(GTK_LABEL(p_label_show_layout_as), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_show_layout_as, 1);
+    gtk_widget_set_margin_end (p_label_show_layout_as, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_show_layout_as), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_frame_display_type), p_label_show_layout_as);
     gtk_frame_set_shadow_type(GTK_FRAME(p_frame_display_type), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_right), p_frame_display_type, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_frame_display_type), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_display_type = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_frame_display_type), p_alignment_display_type);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_display_type), 4, 4, 10, 10);
+#endif
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *p_table = gtk_grid_new();
+    gtk_container_add(GTK_CONTAINER(p_frame_display_type), p_table);
+#else
     GtkWidget *p_table = gtk_table_new(3, 2, FALSE);
     gtk_table_set_col_spacings(GTK_TABLE(p_table), 10);
     gtk_container_add(GTK_CONTAINER(p_alignment_display_type), p_table);
+#endif
 
     // radiobuttons
     GtkWidget * p_image_disp_type_image = gtk_image_new();
@@ -1456,6 +1575,17 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_radiobutton_disp_type_image_cust = gtk_radio_button_new_with_label_from_widget(GTK_RADIO_BUTTON(p_radiobutton_disp_type_image), (const gchar *)_("Custom Image"));
     GtkWidget * p_radiobutton_disp_type_text = gtk_radio_button_new_with_label_from_widget(GTK_RADIO_BUTTON(p_radiobutton_disp_type_image), (const gchar *)_("Text"));
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_grid_attach(GTK_GRID(p_table), p_image_disp_type_image, 0, 0, 1, 1);
+    gtk_grid_attach(GTK_GRID(p_table), p_radiobutton_disp_type_image, 1, 0, 1, 1);
+    if(p_xkb->cust_dir_exists)
+    {
+        gtk_grid_attach(GTK_GRID(p_table), p_image_disp_type_image_cust, 0, 1, 1, 1);
+        gtk_grid_attach(GTK_GRID(p_table), p_radiobutton_disp_type_image_cust, 1, 1, 1, 1);
+    }
+    gtk_grid_attach(GTK_GRID(p_table), p_label_disp_type_text, 0, 2, 1, 1);
+    gtk_grid_attach(GTK_GRID(p_table), p_radiobutton_disp_type_text, 1, 2, 1, 1);
+#else
     gtk_table_attach(GTK_TABLE(p_table), p_image_disp_type_image, 0, 1, 0, 1, GTK_FILL, GTK_FILL, 0, 0);
     gtk_table_attach(GTK_TABLE(p_table), p_radiobutton_disp_type_image, 1, 2, 0, 1, GTK_FILL, GTK_FILL, 0, 0);
     if(p_xkb->cust_dir_exists)
@@ -1465,6 +1595,7 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     }
     gtk_table_attach(GTK_TABLE(p_table), p_label_disp_type_text, 0, 1, 2, 3, GTK_FILL, GTK_FILL, 0, 0);
     gtk_table_attach(GTK_TABLE(p_table), p_radiobutton_disp_type_text, 1, 2, 2, 3, GTK_FILL, GTK_FILL, 0, 0);
+#endif
 
     g_signal_connect(p_radiobutton_disp_type_image, "toggled", G_CALLBACK(on_radiobutton_disp_type_image_toggled), p_xkb);
     if(p_xkb->cust_dir_exists)
@@ -1482,18 +1613,30 @@ static GtkWidget *xkb_configure(LXPanel *panel, GtkWidget *p)
     GtkWidget * p_label_flag_size = gtk_label_new(NULL);
     snprintf(markup_str, MAX_MARKUP_LEN, "<b>%s</b>", _("Panel Icon Size"));
     gtk_label_set_markup(GTK_LABEL(p_label_flag_size), markup_str);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (p_label_flag_size, 1);
+    gtk_widget_set_margin_end (p_label_flag_size, 1);
+#else
     gtk_misc_set_padding(GTK_MISC(p_label_flag_size), 1, 0);
+#endif
     gtk_frame_set_label_widget(GTK_FRAME(p_frame_flag_size), p_label_flag_size);
     gtk_frame_set_shadow_type(GTK_FRAME(p_frame_flag_size), GTK_SHADOW_NONE);
     gtk_box_pack_start(GTK_BOX(p_vbox_right), p_frame_flag_size, TRUE, TRUE, 2);
     gtk_container_set_border_width(GTK_CONTAINER(p_frame_flag_size), 3);
 
     // frame alignment
+#if !GTK_CHECK_VERSION(3, 0, 0)
     GtkWidget * p_alignment_flag_size = gtk_alignment_new(0.5, 0.5, 1, 1);
     gtk_container_add(GTK_CONTAINER(p_frame_flag_size), p_alignment_flag_size);
     gtk_alignment_set_padding(GTK_ALIGNMENT(p_alignment_flag_size), 4, 4, 10, 10);
+#endif
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *p_hbox_flag_size = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 2);
+    gtk_container_add(GTK_CONTAINER(p_frame_flag_size), p_hbox_flag_size);
+#else
     GtkWidget *p_hbox_flag_size = gtk_hbox_new(FALSE, 2);
     gtk_container_add(GTK_CONTAINER(p_alignment_flag_size), p_hbox_flag_size);
+#endif
 
     GtkWidget *p_radiobutton_flag_size_1 = gtk_radio_button_new_with_label(NULL, "1");
     GtkWidget *p_radiobutton_flag_size_2 = gtk_radio_button_new_with_label_from_widget(GTK_RADIO_BUTTON(p_radiobutton_flag_size_1), "2");
diff --git a/po/en_GB.po b/po/en_GB.po
index 4736660..954cc1c 100644
--- a/po/en_GB.po
+++ b/po/en_GB.po
@@ -1,27 +1,23 @@
-# SOME DESCRIPTIVE TITLE.
-# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER
-# This file is distributed under the same license as the PACKAGE package.
-# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
 #
 msgid ""
 msgstr ""
 "Project-Id-Version: LxPanel\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2019-03-01 01:38+0200\n"
+"POT-Creation-Date: 2020-04-29 13:37+0200\n"
 "PO-Revision-Date: 2012-10-24 14:43+0200\n"
 "Last-Translator: Steve <yorvik.ubunto@gmail.com>\n"
 "Language-Team: English UK en_GB <yorvik.ubunto@googlemail.com>\n"
-"Language: \n"
+"Language: en_GB\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 "Plural-Forms: nplurals=2; plural=(n != 1);\n"
 "X-Generator: Pootle 2.0.5\n"
-"X-Pootle-Revision: 0\n"
-"X-Pootle-Path: /en_GB/lxpanel/po/en_GB.po\n"
 "X-Poedit-Language: English\n"
 "X-Poedit-SourceCharset: utf-8\n"
 "X-Poedit-Country: UNITED KINGDOM\n"
+"X-Pootle-Path: /en_GB/lxpanel/po/en_GB.po\n"
+"X-Pootle-Revision: 0\n"
 
 #: ../src/configurator.c:148
 msgid ""
@@ -49,23 +45,23 @@ msgstr "Available plugins"
 msgid "Logout command is not set"
 msgstr "Logout command is not set"
 
-#: ../src/configurator.c:1495
+#: ../src/configurator.c:1519
 msgid "Select a directory"
 msgstr "Select a directory"
 
-#: ../src/configurator.c:1495 ../src/configurator.c:1607
+#: ../src/configurator.c:1519 ../src/configurator.c:1633
 msgid "Select a file"
 msgstr "Select a file"
 
-#: ../src/configurator.c:1640
+#: ../src/configurator.c:1692
 msgid "_Browse"
 msgstr "_Browse"
 
-#: ../src/panel.c:1292
+#: ../src/panel.c:1403
 msgid "There is no room for another panel. All the edges are taken."
 msgstr ""
 
-#: ../src/panel.c:1318
+#: ../src/panel.c:1429
 msgid ""
 "Really delete this panel?\n"
 "<b>Warning: This can not be recovered.</b>"
@@ -73,150 +69,149 @@ msgstr ""
 "Really delete this panel?\n"
 "<b>WARNING: This can not be recovered.</b>"
 
-#: ../src/panel.c:1320
+#: ../src/panel.c:1431
 msgid "Confirm"
 msgstr "Confirm"
 
 #. TRANSLATORS: Replace this string with your names, one name per line.
-#: ../src/panel.c:1355
+#: ../src/panel.c:1466
 msgid "translator-credits"
 msgstr "translator-credits"
 
-#: ../src/panel.c:1360
+#: ../src/panel.c:1471
 msgid "LXPanel"
 msgstr "LXPanel"
 
-#: ../src/panel.c:1378
-msgid "Copyright (C) 2008-2021"
-msgstr "Copyright  2008-2021"
+#: ../src/panel.c:1489
+msgid "Copyright (C) 2008-2019"
+msgstr "Copyright  2008-2019"
 
-#: ../src/panel.c:1379
+#: ../src/panel.c:1490
 msgid "Desktop panel for LXDE project"
 msgstr "Desktop panel for LXDE project"
 
-#: ../src/panel.c:1421
-#, c-format
+#: ../src/panel.c:1532
 msgid "\"%s\" Settings"
 msgstr "\"%s\" Settings"
 
-#: ../src/panel.c:1442
+#: ../src/panel.c:1553
 msgid "Add / Remove Panel Items"
 msgstr "Add / Remove Panel Items"
 
-#: ../src/panel.c:1450
+#: ../src/panel.c:1561
 #, c-format
 msgid "Remove \"%s\" From Panel"
 msgstr "Remove \"%s\" From Panel"
 
-#: ../src/panel.c:1462
+#: ../src/panel.c:1573
 msgid "Panel Settings"
 msgstr "Panel Settings"
 
-#: ../src/panel.c:1468
+#: ../src/panel.c:1579
 msgid "Create New Panel"
 msgstr "Create New Panel"
 
-#: ../src/panel.c:1474
+#: ../src/panel.c:1585
 msgid "Delete This Panel"
 msgstr "Delete This Panel"
 
-#: ../src/panel.c:1485
+#: ../src/panel.c:1596
 msgid "About"
 msgstr "About"
 
-#: ../src/panel.c:1492
+#: ../src/panel.c:1603
 msgid "Panel"
 msgstr "Panel"
 
-#: ../src/panel.c:1710 ../src/panel.c:1718 ../data/ui/panel-pref.glade.h:22
+#: ../src/panel.c:1821 ../src/panel.c:1829 ../data/ui/panel-pref.glade.h:22
 msgid "Height:"
 msgstr "Height:"
 
-#: ../src/panel.c:1711 ../src/panel.c:1717 ../data/ui/panel-pref.glade.h:21
+#: ../src/panel.c:1822 ../src/panel.c:1828 ../data/ui/panel-pref.glade.h:21
 msgid "Width:"
 msgstr "Width:"
 
-#: ../src/panel.c:1712 ../data/ui/panel-pref.glade.h:13
+#: ../src/panel.c:1823 ../data/ui/panel-pref.glade.h:13
 msgid "Left"
 msgstr "Left"
 
-#: ../src/panel.c:1713 ../data/ui/panel-pref.glade.h:14
+#: ../src/panel.c:1824 ../data/ui/panel-pref.glade.h:14
 msgid "Right"
 msgstr "Right"
 
-#: ../src/panel.c:1719 ../data/ui/panel-pref.glade.h:12
+#: ../src/panel.c:1830 ../data/ui/panel-pref.glade.h:12
 msgid "Top"
 msgstr "Top"
 
-#: ../src/panel.c:1720 ../data/ui/panel-pref.glade.h:11
+#: ../src/panel.c:1831 ../data/ui/panel-pref.glade.h:11
 msgid "Bottom"
 msgstr "Bottom"
 
-#: ../src/plugin.c:348
+#: ../src/plugin.c:353
 msgid "No file manager is configured."
 msgstr ""
 
 #. { "configure", N_("Preferences"), configure },
-#: ../src/gtk-run.c:385 ../src/main.c:69 ../plugins/menu.c:718
+#: ../src/gtk-run.c:385 ../src/main.c:70 ../plugins/menu.c:731
 msgid "Run"
-msgstr "Run"
+msgstr "Run..."
 
 #: ../src/gtk-run.c:399
 msgid "Enter the command you want to execute:"
 msgstr "Enter the command you want to execute:"
 
-#: ../src/main.c:70 ../plugins/menu.c:719
+#: ../src/main.c:71 ../plugins/menu.c:732
 msgid "Restart"
 msgstr "Restart"
 
-#: ../src/main.c:71 ../plugins/menu.c:720
+#: ../src/main.c:72 ../plugins/menu.c:733
 msgid "Logout"
-msgstr "Logout"
+msgstr "Shutdown..."
 
-#: ../src/main.c:323
-#, c-format, fuzzy
-msgid "lxpanel %s - lightweight GTK+ panel for UNIX desktops\n"
+#: ../src/main.c:505
+#, c-format
+msgid "lxpanel %s - lightweight GTK2+ panel for UNIX desktops\n"
 msgstr "lxpanel %s - lightweight GTK2+ panel for Linux & UNIX desktops\n"
 
-#: ../src/main.c:324
+#: ../src/main.c:506
 #, c-format
 msgid "Command line options:\n"
 msgstr "Command line options:\n"
 
-#: ../src/main.c:325
+#: ../src/main.c:507
 #, c-format
 msgid " --help      -- print this help and exit\n"
 msgstr " --help      -- print this help and exit\n"
 
-#: ../src/main.c:326
+#: ../src/main.c:508
 #, c-format
 msgid " --version   -- print version and exit\n"
 msgstr " --version   -- print version and exit\n"
 
 #. g_print(_(" --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"));
 #. g_print(_(" --configure -- launch configuration utility\n"));
-#: ../src/main.c:329
+#: ../src/main.c:511
 #, c-format
 msgid " --profile name -- use specified profile\n"
 msgstr " --profile name -- use specified profile\n"
 
-#: ../src/main.c:331
+#: ../src/main.c:513
 #, c-format
 msgid " -h  -- same as --help\n"
 msgstr " -h  -- same as --help\n"
 
-#: ../src/main.c:332
+#: ../src/main.c:514
 #, c-format
 msgid " -p  -- same as --profile\n"
 msgstr " -p  -- same as --profile\n"
 
-#: ../src/main.c:333
+#: ../src/main.c:515
 #, c-format
 msgid " -v  -- same as --version\n"
 msgstr " -v  -- same as --version\n"
 
 #. g_print(_(" -C  -- same as --configure\n"));
-#: ../src/main.c:335
+#: ../src/main.c:517
 #, c-format
 msgid ""
 "\n"
@@ -285,7 +280,7 @@ msgstr "Size"
 msgid "Allocate space"
 msgstr "Allocate space"
 
-#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2482
+#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2507
 #, fuzzy
 msgid "Application Launch and Task Bar"
 msgstr "Application Launch Bar"
@@ -617,11 +612,27 @@ msgstr "<b>Log level</b>"
 msgid "Advanced"
 msgstr "Advanced"
 
-#: ../plugins/cpu/cpu.c:310
+#: ../plugins/cpu/cpu.c:368
+msgid "CPU Usage"
+msgstr "CPU Usage"
+
+#: ../plugins/cpu/cpu.c:370
+msgid "Show usage as percentage"
+msgstr "Show usage as percentage"
+
+#: ../plugins/cpu/cpu.c:371
+msgid "Foreground colour"
+msgstr "Foreground colour"
+
+#: ../plugins/cpu/cpu.c:372
+msgid "Background colour"
+msgstr "Background colour"
+
+#: ../plugins/cpu/cpu.c:380
 msgid "CPU Usage Monitor"
 msgstr "CPU Usage Monitor"
 
-#: ../plugins/cpu/cpu.c:311 ../plugins/monitors/monitors.c:734
+#: ../plugins/cpu/cpu.c:382 ../plugins/monitors/monitors.c:734
 msgid "Display CPU usage"
 msgstr "Display CPU usage"
 
@@ -629,7 +640,7 @@ msgstr "Display CPU usage"
 msgid "Desktop Number / Workspace Name"
 msgstr "Desktop Number / Workspace Name"
 
-#: ../plugins/deskno/deskno.c:212 ../plugins/dclock.c:439
+#: ../plugins/deskno/deskno.c:212
 msgid "Bold font"
 msgstr "Bold font"
 
@@ -641,148 +652,156 @@ msgstr "Display desktop names"
 msgid "Display workspace number, by cmeury@users.sf.net"
 msgstr "Display workspace number, by cmeury@users.sf.net"
 
-#: ../plugins/launchtaskbar.c:1831 ../plugins/launchtaskbar.c:2452
+#: ../plugins/launchtaskbar.c:1835 ../plugins/launchtaskbar.c:2477
 msgid "Application Launch Bar"
 msgstr "Application Launch Bar"
 
-#: ../plugins/launchtaskbar.c:1834 ../plugins/launchtaskbar.c:2462
+#: ../plugins/launchtaskbar.c:1838 ../plugins/launchtaskbar.c:2487
 msgid "Task Bar (Window List)"
 msgstr "Task Bar (Window List)"
 
-#: ../plugins/launchtaskbar.c:1985
+#: ../plugins/launchtaskbar.c:2010
 msgid "A_dd to Launcher"
 msgstr ""
 
-#: ../plugins/launchtaskbar.c:1987
+#: ../plugins/launchtaskbar.c:2012
 #, fuzzy
 msgid "Rem_ove from Launcher"
 msgstr "Remove \"%s\" From Panel"
 
-#: ../plugins/launchtaskbar.c:1989
+#: ../plugins/launchtaskbar.c:2014
 msgid "_New Instance"
 msgstr ""
 
-#: ../plugins/launchtaskbar.c:2453
+#: ../plugins/launchtaskbar.c:2478
 msgid "Bar with buttons to launch application"
 msgstr "Bar with buttons to launch application"
 
-#: ../plugins/launchtaskbar.c:2463
-#, fuzzy
+#: ../plugins/launchtaskbar.c:2488
 msgid ""
-"Taskbar shows all opened windows and allows to iconify them, shade or get "
+"Taskbar shows all opened windows and allow to iconify them, shade or get "
 "focus"
 msgstr ""
 "Taskbar shows all opened windows and allow to iconify them, shade or get "
 "focus"
 
-#: ../plugins/launchtaskbar.c:2483
+#: ../plugins/launchtaskbar.c:2508
 #, fuzzy
 msgid "Bar with buttons to launch application and/or show all opened windows"
 msgstr "Bar with buttons to launch application"
 
 #. Add Raise menu item.
-#: ../plugins/task-button.c:352
+#: ../plugins/task-button.c:351
 msgid "_Raise"
 msgstr "_Raise"
 
 #. Add Restore menu item.
-#: ../plugins/task-button.c:357
+#: ../plugins/task-button.c:356
 msgid "R_estore"
 msgstr "R_estore"
 
 #. Add Maximize menu item.
-#: ../plugins/task-button.c:362
+#: ../plugins/task-button.c:361
 msgid "Ma_ximize"
 msgstr "Ma_ximise"
 
 #. Add Iconify menu item.
-#: ../plugins/task-button.c:367
+#: ../plugins/task-button.c:366
 msgid "Ico_nify"
 msgstr "Mi_nimise"
 
-#: ../plugins/task-button.c:388
+#: ../plugins/task-button.c:387
 #, c-format
 msgid "Workspace _%d"
 msgstr "Workspace _%d"
 
-#: ../plugins/task-button.c:393
+#: ../plugins/task-button.c:392
 #, c-format
 msgid "Workspace %d"
 msgstr "Workspace %d"
 
 #. Add "move to all workspaces" item.  This causes the window to be visible no matter what desktop is active.
-#: ../plugins/task-button.c:410
+#: ../plugins/task-button.c:409
 msgid "_All workspaces"
 msgstr "_All workspaces"
 
 #. FIXME: add "Current workspace" item, active if not on a current
 #. Add Move to Workspace menu item as a submenu.
-#: ../plugins/task-button.c:418
+#: ../plugins/task-button.c:417
 msgid "_Move to Workspace"
 msgstr "_Move to Workspace"
 
-#: ../plugins/task-button.c:433
+#: ../plugins/task-button.c:432
 msgid "_Close Window"
 msgstr "_Close Window"
 
-#: ../plugins/task-button.c:1256
+#: ../plugins/task-button.c:1258
 #, fuzzy
 msgid "_Close all windows"
 msgstr "_Close Window"
 
-#: ../plugins/dclock.c:433 ../plugins/dclock.c:453
+#: ../plugins/dclock.c:551 ../plugins/dclock.c:574
 msgid "Digital Clock"
 msgstr "Digital Clock"
 
-#: ../plugins/dclock.c:435
+#: ../plugins/dclock.c:553
 msgid "Clock Format"
 msgstr "Clock Format"
 
-#: ../plugins/dclock.c:436
+#: ../plugins/dclock.c:554
 msgid "Tooltip Format"
 msgstr "Tooltip Format"
 
-#: ../plugins/dclock.c:437
-#, c-format
+#: ../plugins/dclock.c:555
 #, fuzzy, c-format
 msgid "Format codes: man 3 strftime; %n for line break"
-msgstr ""
-"Format codes: man 3 strftime; \\n"
-" for line break"
+msgstr "Format codes: man 3 strftime; \\n for line break"
 
-#: ../plugins/dclock.c:438
+#: ../plugins/dclock.c:556
 msgid "Action when clicked (default: display calendar)"
 msgstr "Action when clicked (default: display calendar)"
 
-#: ../plugins/dclock.c:440
+#: ../plugins/dclock.c:558
 msgid "Tooltip only"
 msgstr "Tooltip only"
 
-#: ../plugins/dclock.c:441
+#: ../plugins/dclock.c:560
+msgid "Left align"
+msgstr "Left align"
+
+#: ../plugins/dclock.c:561
 msgid "Center text"
 msgstr "Centre text"
 
-#: ../plugins/dclock.c:454
+#: ../plugins/dclock.c:562
+msgid "Right align"
+msgstr "Right align"
+
+#: ../plugins/dclock.c:575
 msgid "Display digital clock and tooltip"
 msgstr "Display digital clock and tooltip"
 
-#: ../plugins/menu.c:360
+#: ../plugins/menu.c:362
 msgid "Add to desktop"
 msgstr "Add to desktop"
 
-#: ../plugins/menu.c:367
+#: ../plugins/menu.c:369
 msgid "Properties"
 msgstr "Properties"
 
-#: ../plugins/menu.c:989 ../plugins/menu.c:997
+#: ../plugins/menu.c:715
+msgid "Click here to open applications menu"
+msgstr "Click here to open applications menu"
+
+#: ../plugins/menu.c:1018 ../plugins/menu.c:1032
 msgid "Menu"
 msgstr "Menu"
 
-#: ../plugins/menu.c:990 ../plugins/dirmenu.c:359
+#: ../plugins/menu.c:1019 ../plugins/dirmenu.c:359
 msgid "Icon"
 msgstr "Icon"
 
-#: ../plugins/menu.c:998
+#: ../plugins/menu.c:1033
 msgid "Application Menu"
 msgstr "Application Menu"
 
@@ -1012,7 +1031,7 @@ msgid "CPUFreq frontend"
 msgstr ""
 
 #: ../plugins/cpufreq/cpufreq.c:402
-msgid "Display CPU frequency and allow one to change governors and frequency"
+msgid "Display CPU frequency and allow to change governors and frequency"
 msgstr ""
 
 #: ../plugins/volumealsa/volumealsa.c:245
@@ -1031,8 +1050,8 @@ msgid ""
 "Error, you need to install an application to configure the sound "
 "(pavucontrol, alsamixer ...)"
 msgstr ""
-"Error, you need to install an application to configure the sound ("
-"pavucontol, alsamixer ...)"
+"Error, you need to install an application to configure the sound "
+"(pavucontol, alsamixer ...)"
 
 #. Create a frame as the child of the viewport.
 #: ../plugins/volumealsa/volumealsa.c:895
@@ -1590,19 +1609,16 @@ msgid "Sending/Receiving"
 msgstr "Sending/Receiving"
 
 #: ../plugins/batt/batt.c:156
-#, c-format
 #, fuzzy, c-format
 msgid "Battery %d: %d%% charged, %d:%02d until full"
 msgstr "Battery: %d%% charged, %d:%02d until full"
 
 #: ../plugins/batt/batt.c:170
-#, c-format
 #, fuzzy, c-format
 msgid "Battery %d: %d%% charged, %d:%02d left"
 msgstr "Battery: %d%% charged, %d:%02d left"
 
 #: ../plugins/batt/batt.c:177
-#, c-format
 #, fuzzy, c-format
 msgid "Battery %d: %d%% charged"
 msgstr "Battery: %d%% charged"
@@ -1990,7 +2006,6 @@ msgstr ""
 
 #: ../plugins/weather/weatherwidget.c:1964
 #: ../plugins/weather/weatherwidget.c:2311
-#, c-format
 #, fuzzy, c-format
 msgid "Location not set."
 msgstr "Logout command is not set"
diff --git a/po/hy.po b/po/hy.po
new file mode 100644
index 0000000..a3b39cc
--- /dev/null
+++ b/po/hy.po
@@ -0,0 +1,2178 @@
+#
+msgid ""
+msgstr ""
+"Project-Id-Version: LxPanel\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2020-04-29 13:37+0200\n"
+"PO-Revision-Date: 2012-10-24 14:43+0200\n"
+"Last-Translator: Avag <info@armath.am>\n"
+"Language-Team: Armenian\n"
+"Language: hy\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"Plural-Forms: nplurals=2; plural=(n != 1);\n"
+"X-Generator: Pootle 2.0.5\n"
+"X-Poedit-Language: Armenian\n"
+"X-Poedit-SourceCharset: utf-8\n"
+"X-Poedit-Country: Armenia\n"
+"X-Pootle-Path: /hy/lxpanel/po/hy.po\n"
+"X-Pootle-Revision: 0\n"
+
+#: ../src/configurator.c:148
+msgid ""
+"Space reservation is not available for this panel because there is another "
+"monitor beyond this edge and reservation would cover it if enabled."
+msgstr ""
+
+#: ../src/configurator.c:632
+msgid "Currently loaded plugins"
+msgstr "  "
+
+#: ../src/configurator.c:641
+msgid "Stretch"
+msgstr ""
+
+#: ../src/configurator.c:779
+msgid "Add plugin to panel"
+msgstr "  "
+
+#: ../src/configurator.c:807
+msgid "Available plugins"
+msgstr " "
+
+#: ../src/configurator.c:1427
+msgid "Logout command is not set"
+msgstr "    "
+
+#: ../src/configurator.c:1519
+msgid "Select a directory"
+msgstr " "
+
+#: ../src/configurator.c:1519 ../src/configurator.c:1633
+msgid "Select a file"
+msgstr " "
+
+#: ../src/configurator.c:1692
+msgid "_Browse"
+msgstr "_"
+
+#: ../src/panel.c:1403
+msgid "There is no room for another panel. All the edges are taken."
+msgstr ""
+
+#: ../src/panel.c:1429
+msgid ""
+"Really delete this panel?\n"
+"<b>Warning: This can not be recovered.</b>"
+msgstr ""
+"  \n"
+"<b>WARNING: This can not be recovered.</b>"
+
+#: ../src/panel.c:1431
+msgid "Confirm"
+msgstr ""
+
+#. TRANSLATORS: Replace this string with your names, one name per line.
+#: ../src/panel.c:1466
+msgid "translator-credits"
+msgstr " "
+
+#: ../src/panel.c:1471
+msgid "LXPanel"
+msgstr "LXPanel"
+
+#: ../src/panel.c:1489
+msgid "Copyright (C) 2008-2019"
+msgstr "   2008-2019"
+
+#: ../src/panel.c:1490
+msgid "Desktop panel for LXDE project"
+msgstr "  LXDE  "
+
+#: ../src/panel.c:1532
+msgid "\"%s\" Settings"
+msgstr "\"%s\" "
+
+#: ../src/panel.c:1553
+msgid "Add / Remove Panel Items"
+msgstr " /   "
+
+#: ../src/panel.c:1561
+#, c-format
+msgid "Remove \"%s\" From Panel"
+msgstr " \"%s\" "
+
+#: ../src/panel.c:1573
+msgid "Panel Settings"
+msgstr " "
+
+#: ../src/panel.c:1579
+msgid "Create New Panel"
+msgstr "  "
+
+#: ../src/panel.c:1585
+msgid "Delete This Panel"
+msgstr "  "
+
+#: ../src/panel.c:1596
+msgid "About"
+msgstr " "
+
+#: ../src/panel.c:1603
+msgid "Panel"
+msgstr ""
+
+#: ../src/panel.c:1821 ../src/panel.c:1829 ../data/ui/panel-pref.glade.h:22
+msgid "Height:"
+msgstr ""
+
+#: ../src/panel.c:1822 ../src/panel.c:1828 ../data/ui/panel-pref.glade.h:21
+msgid "Width:"
+msgstr ""
+
+#: ../src/panel.c:1823 ../data/ui/panel-pref.glade.h:13
+msgid "Left"
+msgstr ""
+
+#: ../src/panel.c:1824 ../data/ui/panel-pref.glade.h:14
+msgid "Right"
+msgstr ""
+
+#: ../src/panel.c:1830 ../data/ui/panel-pref.glade.h:12
+msgid "Top"
+msgstr ""
+
+#: ../src/panel.c:1831 ../data/ui/panel-pref.glade.h:11
+msgid "Bottom"
+msgstr ""
+
+#: ../src/plugin.c:353
+msgid "No file manager is configured."
+msgstr ""
+
+#. { "configure", N_("Preferences"), configure },
+#: ../src/gtk-run.c:385 ../src/main.c:70 ../plugins/menu.c:731
+msgid "Run"
+msgstr "..."
+
+#: ../src/gtk-run.c:399
+msgid "Enter the command you want to execute:"
+msgstr "  ,    "
+
+#: ../src/main.c:71 ../plugins/menu.c:732
+msgid "Restart"
+msgstr ""
+
+#: ../src/main.c:72 ../plugins/menu.c:733
+msgid "Logout"
+msgstr "..."
+
+#: ../src/main.c:505
+#, c-format
+msgid "lxpanel %s - lightweight GTK2+ panel for UNIX desktops\n"
+msgstr "lxpanel %s -  GTK2+  Linux  UNIX  \n"
+
+#: ../src/main.c:506
+#, c-format
+msgid "Command line options:\n"
+msgstr " \n"
+
+#: ../src/main.c:507
+#, c-format
+msgid " --help      -- print this help and exit\n"
+msgstr " --      --      \n"
+
+#: ../src/main.c:508
+#, c-format
+msgid " --version   -- print version and exit\n"
+msgstr " --   --     \n"
+
+#. g_print(_(" --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"));
+#. g_print(_(" --configure -- launch configuration utility\n"));
+#: ../src/main.c:511
+#, c-format
+msgid " --profile name -- use specified profile\n"
+msgstr " --  --   \n"
+
+#: ../src/main.c:513
+#, c-format
+msgid " -h  -- same as --help\n"
+msgstr " -h  --   --\n"
+
+#: ../src/main.c:514
+#, c-format
+msgid " -p  -- same as --profile\n"
+msgstr " -p  --   --\n"
+
+#: ../src/main.c:515
+#, c-format
+msgid " -v  -- same as --version\n"
+msgstr " -v  --   --\n"
+
+#. g_print(_(" -C  -- same as --configure\n"));
+#: ../src/main.c:517
+#, c-format
+msgid ""
+"\n"
+"Visit http://lxde.org/ for detail.\n"
+"\n"
+msgstr ""
+"\n"
+" http://lxde.org/   \n"
+"\n"
+
+#: ../src/input-button.c:147
+#, fuzzy
+msgid "LeftBtn"
+msgstr ""
+
+#: ../src/input-button.c:150
+msgid "MiddleBtn"
+msgstr ""
+
+#: ../src/input-button.c:153
+#, fuzzy
+msgid "RightBtn"
+msgstr ""
+
+#: ../src/input-button.c:156
+#, c-format
+msgid "Btn%s"
+msgstr ""
+
+#: ../src/input-button.c:228
+#, c-format
+msgid "Key combination '%s' cannot be used as a global hotkey, sorry."
+msgstr ""
+
+#: ../src/input-button.c:231 ../src/input-button.c:415
+#: ../plugins/netstatus/netstatus-iface.c:191
+#: ../plugins/netstatus/netstatus-util.c:167
+msgid "Error"
+msgstr ""
+
+#. GtkRadioButton "None"
+#: ../src/input-button.c:329 ../data/ui/panel-pref.glade.h:5
+msgid "None"
+msgstr " "
+
+#: ../src/input-button.c:336
+#, fuzzy
+msgid "Custom:"
+msgstr " "
+
+#: ../src/input-button.c:413
+#, c-format
+msgid "Cannot assign '%s' as a global hotkey: it is already bound."
+msgstr ""
+
+#: ../src/space.c:394 ../src/space.c:403
+msgid "Spacer"
+msgstr "Spacer"
+
+#: ../src/space.c:396 ../data/ui/panel-pref.glade.h:32
+#: ../plugins/batt/batt.c:714
+msgid "Size"
+msgstr ""
+
+#: ../src/space.c:404
+msgid "Allocate space"
+msgstr " "
+
+#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2507
+#, fuzzy
+msgid "Application Launch and Task Bar"
+msgstr "  "
+
+#. Launchtaskbar mode: launchbar, taskbar, or combined
+#: ../data/ui/launchtaskbar.glade.h:3
+#, fuzzy
+msgid "<b>Mode:</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/launchtaskbar.glade.h:4
+msgid "Launchers"
+msgstr ""
+
+#: ../data/ui/launchtaskbar.glade.h:5
+#, fuzzy
+msgid "<b>Launchbar</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/launchtaskbar.glade.h:6
+msgid "Show tooltips"
+msgstr "  "
+
+#: ../data/ui/launchtaskbar.glade.h:7
+msgid "Icons only"
+msgstr " "
+
+#: ../data/ui/launchtaskbar.glade.h:8
+msgid "Flat buttons"
+msgstr " "
+
+#: ../data/ui/launchtaskbar.glade.h:9
+msgid "Show windows from all desktops"
+msgstr "     "
+
+#: ../data/ui/launchtaskbar.glade.h:10
+msgid "Only show windows on the same monitor as the task bar"
+msgstr ""
+
+#: ../data/ui/launchtaskbar.glade.h:11
+msgid "Use mouse wheel"
+msgstr "  "
+
+#: ../data/ui/launchtaskbar.glade.h:12
+msgid "Flash when there is any window requiring attention"
+msgstr ",      "
+
+#: ../data/ui/launchtaskbar.glade.h:13
+msgid "Combine multiple application windows into a single button"
+msgstr "      "
+
+#: ../data/ui/launchtaskbar.glade.h:14
+msgid "Disable enlargement for small task icons"
+msgstr ""
+
+#: ../data/ui/launchtaskbar.glade.h:15
+msgid "Show task icons smaller than rest of panel icons"
+msgstr ""
+
+#: ../data/ui/launchtaskbar.glade.h:16
+msgid "Maximum width of task button"
+msgstr "   "
+
+#: ../data/ui/launchtaskbar.glade.h:17
+msgid "Spacing"
+msgstr ""
+
+#: ../data/ui/launchtaskbar.glade.h:18
+#, fuzzy
+msgid "<b>Taskbar</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/launchtaskbar.glade.h:19
+#, fuzzy
+msgid "Only Application Launch Bar"
+msgstr "  "
+
+#: ../data/ui/launchtaskbar.glade.h:20
+#, fuzzy
+msgid "Only Task Bar (Window List)"
+msgstr " ( )"
+
+#: ../data/ui/launchtaskbar.glade.h:21
+#, fuzzy
+msgid "Integrated Application Launch Bar and Task Bar"
+msgstr "  "
+
+#: ../data/ui/netstatus.glade.h:1
+msgid "<b>Connection</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/netstatus.glade.h:2
+msgid "Status:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:3
+msgid "_Name:"
+msgstr "_"
+
+#: ../data/ui/netstatus.glade.h:4
+msgid "<b>Activity</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/netstatus.glade.h:5
+msgid "Received:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:6
+msgid "Sent:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:7
+msgid "<b>Signal Strength</b>"
+msgstr "<b> </b>"
+
+#: ../data/ui/netstatus.glade.h:9
+#, no-c-format
+msgid "0%"
+msgstr "0%"
+
+#: ../data/ui/netstatus.glade.h:10
+msgid "General"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:11
+msgid "<b>Internet Protocol (IPv4)</b>"
+msgstr "<b>  (IPv4)</b>"
+
+#: ../data/ui/netstatus.glade.h:12
+msgid "Address:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:13
+msgid "Destination:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:14 ../plugins/netstat/netstat.c:372
+#: ../plugins/netstat/netstat.c:383
+msgid "Broadcast:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:15
+msgid "Subnet Mask:"
+msgstr "Subnet Mask:"
+
+#: ../data/ui/netstatus.glade.h:16
+msgid "<b>Internet Protocol (IPv6)</b>"
+msgstr "<b>  (IPv6)</b>"
+
+#: ../data/ui/netstatus.glade.h:17
+msgid "Scope:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:18
+msgid "<b>Network Device</b>"
+msgstr "<b> </b>"
+
+#: ../data/ui/netstatus.glade.h:19
+msgid "Type:"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:20
+msgid "Support"
+msgstr ""
+
+#: ../data/ui/netstatus.glade.h:21
+msgid "Con_figure"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:1
+msgid "Dynamic"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:2
+msgid "Pixels"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:4
+#, no-c-format
+msgid "% Percent"
+msgstr "% "
+
+#: ../data/ui/panel-pref.glade.h:6
+msgid "Err"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:7
+msgid "Warn"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:8
+msgid "Info"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:9
+msgid "All"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:10
+msgid "Panel Preferences"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:15
+msgid "Edge:"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:16 ../plugins/volumealsa/volumealsa.c:1313
+msgid "Center"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:17
+msgid "Alignment:"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:18
+msgid "Margin:"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:19
+#, fuzzy
+msgid "Monitor:"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:20
+msgid "<b>Position</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/panel-pref.glade.h:23
+msgid "Icon size:"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:24
+msgid "<b>Size</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/panel-pref.glade.h:25
+msgid "Geometry"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:26
+msgid "System theme"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:27
+msgid "Solid color (with opacity)"
+msgstr " ()"
+
+#: ../data/ui/panel-pref.glade.h:28 ../plugins/xkb/xkb-plugin.c:1455
+msgid "Image"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:29
+msgid "Select an image file"
+msgstr "  "
+
+#: ../data/ui/panel-pref.glade.h:30
+msgid "<b>Background</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/panel-pref.glade.h:31
+msgid "Custom color"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:33
+msgid "<b>Font</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/panel-pref.glade.h:34
+msgid "Appearance"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:35
+msgid "Panel Applets"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:36
+msgid "Logout Command:"
+msgstr "  "
+
+#: ../data/ui/panel-pref.glade.h:37
+msgid "Terminal Emulator:"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:38
+msgid "File Manager:"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:39
+msgid "<b>Set Preferred Applications</b>"
+msgstr "<b>  </b>"
+
+#: ../data/ui/panel-pref.glade.h:40
+msgid "Make window managers treat the panel as dock"
+msgstr "    ,  "
+
+#: ../data/ui/panel-pref.glade.h:41
+msgid "Reserve space, and not covered by maximized windows"
+msgstr " ,     "
+
+#: ../data/ui/panel-pref.glade.h:42
+msgid "<b>Properties</b>"
+msgstr "<b></b>"
+
+#: ../data/ui/panel-pref.glade.h:43
+msgid "Minimize panel when not in use"
+msgstr " ,    "
+
+#: ../data/ui/panel-pref.glade.h:44
+msgid "Size when minimized"
+msgstr "  "
+
+#: ../data/ui/panel-pref.glade.h:45
+msgid "pixels"
+msgstr ""
+
+#: ../data/ui/panel-pref.glade.h:46
+msgid "<b>Automatic hiding</b>"
+msgstr "<b> </b>"
+
+#: ../data/ui/panel-pref.glade.h:47
+msgid "Log level"
+msgstr " "
+
+#: ../data/ui/panel-pref.glade.h:48
+msgid "<b>Log level</b>"
+msgstr "<b> </b>"
+
+#: ../data/ui/panel-pref.glade.h:49
+msgid "Advanced"
+msgstr ""
+
+#: ../plugins/cpu/cpu.c:368
+msgid "CPU Usage"
+msgstr " "
+
+#: ../plugins/cpu/cpu.c:370
+msgid "Show usage as percentage"
+msgstr "    "
+
+#: ../plugins/cpu/cpu.c:371
+msgid "Foreground colour"
+msgstr "  "
+
+#: ../plugins/cpu/cpu.c:372
+msgid "Background colour"
+msgstr "  "
+
+#: ../plugins/cpu/cpu.c:380
+msgid "CPU Usage Monitor"
+msgstr "  "
+
+#: ../plugins/cpu/cpu.c:382 ../plugins/monitors/monitors.c:734
+msgid "Display CPU usage"
+msgstr "   "
+
+#: ../plugins/deskno/deskno.c:210 ../plugins/deskno/deskno.c:230
+msgid "Desktop Number / Workspace Name"
+msgstr "Desktop Number / Workspace Name"
+
+#: ../plugins/deskno/deskno.c:212
+msgid "Bold font"
+msgstr " "
+
+#: ../plugins/deskno/deskno.c:213
+msgid "Display desktop names"
+msgstr "  "
+
+#: ../plugins/deskno/deskno.c:231
+msgid "Display workspace number, by cmeury@users.sf.net"
+msgstr "  , cmeury@users.sf.net- "
+
+#: ../plugins/launchtaskbar.c:1835 ../plugins/launchtaskbar.c:2477
+msgid "Application Launch Bar"
+msgstr "  "
+
+#: ../plugins/launchtaskbar.c:1838 ../plugins/launchtaskbar.c:2487
+msgid "Task Bar (Window List)"
+msgstr " ( )"
+
+#: ../plugins/launchtaskbar.c:2010
+msgid "A_dd to Launcher"
+msgstr ""
+
+#: ../plugins/launchtaskbar.c:2012
+#, fuzzy
+msgid "Rem_ove from Launcher"
+msgstr " \"%s\" - "
+
+#: ../plugins/launchtaskbar.c:2014
+msgid "_New Instance"
+msgstr ""
+
+#: ../plugins/launchtaskbar.c:2478
+msgid "Bar with buttons to launch application"
+msgstr "    "
+
+#: ../plugins/launchtaskbar.c:2488
+msgid ""
+"Taskbar shows all opened windows and allow to iconify them, shade or get "
+"focus"
+msgstr ""
+"           ,"
+"   "
+
+#: ../plugins/launchtaskbar.c:2508
+#, fuzzy
+msgid "Bar with buttons to launch application and/or show all opened windows"
+msgstr "    "
+
+#. Add Raise menu item.
+#: ../plugins/task-button.c:351
+msgid "_Raise"
+msgstr "_"
+
+#. Add Restore menu item.
+#: ../plugins/task-button.c:356
+msgid "R_estore"
+msgstr ""
+
+#. Add Maximize menu item.
+#: ../plugins/task-button.c:361
+msgid "Ma_ximize"
+msgstr ""
+
+#. Add Iconify menu item.
+#: ../plugins/task-button.c:366
+msgid "Ico_nify"
+msgstr ""
+
+#: ../plugins/task-button.c:387
+#, c-format
+msgid "Workspace _%d"
+msgstr "_%d  "
+
+#: ../plugins/task-button.c:392
+#, c-format
+msgid "Workspace %d"
+msgstr "%d  "
+
+#. Add "move to all workspaces" item.  This causes the window to be visible no matter what desktop is active.
+#: ../plugins/task-button.c:409
+msgid "_All workspaces"
+msgstr "_  "
+
+#. FIXME: add "Current workspace" item, active if not on a current
+#. Add Move to Workspace menu item as a submenu.
+#: ../plugins/task-button.c:417
+msgid "_Move to Workspace"
+msgstr "_  "
+
+#: ../plugins/task-button.c:432
+msgid "_Close Window"
+msgstr "_ "
+
+#: ../plugins/task-button.c:1258
+#, fuzzy
+msgid "_Close all windows"
+msgstr "_ "
+
+#: ../plugins/dclock.c:551 ../plugins/dclock.c:574
+msgid "Digital Clock"
+msgstr " "
+
+#: ../plugins/dclock.c:553
+msgid "Clock Format"
+msgstr " "
+
+#: ../plugins/dclock.c:554
+msgid "Tooltip Format"
+msgstr "  "
+
+#: ../plugins/dclock.c:555
+#, fuzzy, c-format
+msgid "Format codes: man 3 strftime; %n for line break"
+msgstr "   3 strftime; \\n for line break"
+
+#: ../plugins/dclock.c:556
+msgid "Action when clicked (default: display calendar)"
+msgstr "  (:  )"
+
+#: ../plugins/dclock.c:558
+msgid "Tooltip only"
+msgstr "  "
+
+#: ../plugins/dclock.c:560
+msgid "Left align"
+msgstr " "
+
+#: ../plugins/dclock.c:561
+msgid "Center text"
+msgstr " "
+
+#: ../plugins/dclock.c:562
+msgid "Right align"
+msgstr " "
+
+#: ../plugins/dclock.c:575
+msgid "Display digital clock and tooltip"
+msgstr "     "
+
+#: ../plugins/menu.c:362
+msgid "Add to desktop"
+msgstr " "
+
+#: ../plugins/menu.c:369
+msgid "Properties"
+msgstr ""
+
+#: ../plugins/menu.c:715
+msgid "Click here to open applications menu"
+msgstr "     "
+
+#: ../plugins/menu.c:1018 ../plugins/menu.c:1032
+msgid "Menu"
+msgstr ""
+
+#: ../plugins/menu.c:1019 ../plugins/dirmenu.c:359
+msgid "Icon"
+msgstr ""
+
+#: ../plugins/menu.c:1033
+msgid "Application Menu"
+msgstr " "
+
+#: ../plugins/separator.c:73
+msgid "Separator"
+msgstr ""
+
+#: ../plugins/separator.c:74
+msgid "Add a separator to the panel"
+msgstr "   "
+
+#: ../plugins/pager.c:141
+msgid "Sorry, there was no window manager configuration program found."
+msgstr ""
+
+#: ../plugins/pager.c:193 ../plugins/pager.c:209
+msgid "Desktop Pager"
+msgstr " "
+
+#: ../plugins/pager.c:194 ../plugins/pager.c:210
+msgid "Simple pager plugin"
+msgstr "  "
+
+#: ../plugins/tray.c:691
+msgid "System Tray"
+msgstr " "
+
+#: ../plugins/tray.c:692
+msgid "System tray"
+msgstr " "
+
+#: ../plugins/xkb/xkb-plugin.c:409
+msgid "New session is required for this option to take effect"
+msgstr ""
+
+#. dialog
+#: ../plugins/xkb/xkb-plugin.c:590
+msgid "Select Keyboard Model"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:614 ../plugins/xkb/xkb-plugin.c:743
+#: ../plugins/xkb/xkb-plugin.c:921
+msgid "Description"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:619 ../plugins/xkb/xkb-plugin.c:750
+#, fuzzy
+msgid "Id"
+msgstr "Idle"
+
+#. dialog
+#: ../plugins/xkb/xkb-plugin.c:714
+msgid "Select Layout Change Type"
+msgstr "   "
+
+#. dialog
+#: ../plugins/xkb/xkb-plugin.c:887
+msgid "Add Keyboard Layout"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:911 ../plugins/xkb/xkb-plugin.c:1302
+msgid "Flag"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:916 ../plugins/xkb/xkb-plugin.c:1306
+msgid "Layout"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1212 ../plugins/xkb/xkb-plugin.c:1544
+msgid "Keyboard Layout Handler"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:1235
+msgid "Keyboard Model"
+msgstr " "
+
+#: ../plugins/xkb/xkb-plugin.c:1256
+msgid "Keyboard Layouts"
+msgstr " "
+
+#: ../plugins/xkb/xkb-plugin.c:1310
+msgid "Variant"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1319
+msgid "Change Layout Option"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:1339
+msgid "Advanced setxkbmap Options"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1360
+msgid "Do _not reset existing options"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1365
+msgid "Keep _system layouts"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1374
+msgid "Per Window Settings"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:1386
+msgid "_Remember layout for each window"
+msgstr "_   "
+
+#: ../plugins/xkb/xkb-plugin.c:1395
+msgid "Show Layout as"
+msgstr "   "
+
+#: ../plugins/xkb/xkb-plugin.c:1456
+msgid "Custom Image"
+msgstr " "
+
+#: ../plugins/xkb/xkb-plugin.c:1457
+msgid "Text"
+msgstr ""
+
+#: ../plugins/xkb/xkb-plugin.c:1483
+msgid "Panel Icon Size"
+msgstr "  "
+
+#: ../plugins/xkb/xkb-plugin.c:1545
+msgid "Handle keyboard layouts"
+msgstr "  "
+
+#: ../plugins/wincmd.c:207
+msgid "Left click to iconify all windows.  Middle click to shade them."
+msgstr "          "
+
+#: ../plugins/wincmd.c:245 ../plugins/wincmd.c:255
+msgid "Minimize All Windows"
+msgstr "  "
+
+#: ../plugins/wincmd.c:247
+msgid "Alternately iconify/shade and raise"
+msgstr " /  "
+
+#: ../plugins/wincmd.c:256
+msgid ""
+"Sends commands to all desktop windows.\n"
+"Supported commands are 1) iconify and 2) shade"
+msgstr ""
+"    :\n"
+"   1) iconify -   2) shade - "
+
+#: ../plugins/dirmenu.c:213
+msgid "Open in _Terminal"
+msgstr " "
+
+#: ../plugins/dirmenu.c:355 ../plugins/dirmenu.c:365
+msgid "Directory Menu"
+msgstr " "
+
+#: ../plugins/dirmenu.c:357
+msgid "Directory"
+msgstr ""
+
+#: ../plugins/dirmenu.c:358
+msgid "Label"
+msgstr ""
+
+#: ../plugins/dirmenu.c:366
+#, fuzzy
+msgid "Browse directory tree via menu (Author = PCMan)"
+msgstr "     ( PCMan)"
+
+#: ../plugins/thermal/thermal.c:563 ../plugins/thermal/thermal.c:581
+msgid "Temperature Monitor"
+msgstr " "
+
+#: ../plugins/thermal/thermal.c:565
+#, fuzzy
+msgid "Normal color"
+msgstr " "
+
+#: ../plugins/thermal/thermal.c:566
+#, fuzzy
+msgid "Warning1 color"
+msgstr "  1"
+
+#: ../plugins/thermal/thermal.c:567
+#, fuzzy
+msgid "Warning2 color"
+msgstr "  1"
+
+#: ../plugins/thermal/thermal.c:568
+msgid "Automatic sensor location"
+msgstr "  "
+
+#. FIXME: if off, disable next one
+#: ../plugins/thermal/thermal.c:569
+msgid "Sensor"
+msgstr ""
+
+#. FIXME: create a list to select instead
+#: ../plugins/thermal/thermal.c:570
+msgid "Automatic temperature levels"
+msgstr "  "
+
+#. FIXME: if off, disable two below
+#: ../plugins/thermal/thermal.c:571
+#, fuzzy
+msgid "Warning1 temperature"
+msgstr "1 "
+
+#: ../plugins/thermal/thermal.c:572
+#, fuzzy
+msgid "Warning2 temperature"
+msgstr "2 "
+
+#: ../plugins/thermal/thermal.c:582
+msgid "Display system temperature"
+msgstr "  "
+
+#: ../plugins/cpufreq/cpufreq.c:325
+#, c-format
+msgid ""
+"Frequency: %d MHz\n"
+"Governor: %s"
+msgstr ""
+
+#: ../plugins/cpufreq/cpufreq.c:401
+msgid "CPUFreq frontend"
+msgstr ""
+
+#: ../plugins/cpufreq/cpufreq.c:402
+msgid "Display CPU frequency and allow to change governors and frequency"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:245
+msgid "ALSA (or pulseaudio) had a problem. Please check the lxpanel logs."
+msgstr ""
+
+#. Display current level in tooltip.
+#: ../plugins/volumealsa/volumealsa.c:613
+#: ../plugins/volumealsa/volumealsa.c:973
+msgid "Volume control"
+msgstr " "
+
+#: ../plugins/volumealsa/volumealsa.c:701
+#, fuzzy
+msgid ""
+"Error, you need to install an application to configure the sound "
+"(pavucontrol, alsamixer ...)"
+msgstr ""
+",        "
+"(pavucontol, alsamixer ...)"
+
+#. Create a frame as the child of the viewport.
+#: ../plugins/volumealsa/volumealsa.c:895
+msgid "Volume"
+msgstr ""
+
+#. Create a check button as the child of the vertical box.
+#: ../plugins/volumealsa/volumealsa.c:914
+msgid "Mute"
+msgstr ""
+
+#. Just to have these translated
+#: ../plugins/volumealsa/volumealsa.c:1313
+msgid "Line"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1313
+msgid "LineOut"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1313
+msgid "Front"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1313
+msgid "Surround"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1313
+msgid "Speaker+LO"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1352
+msgid "default"
+msgstr ""
+
+#. desc, index
+#: ../plugins/volumealsa/volumealsa.c:1412
+msgid "Master"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1416
+msgid "PCM"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1420
+msgid "Headphone"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1442
+msgid "Click for Volume Slider"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1446
+msgid "Click for Toggle Mute"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1450
+msgid "Click for Open Mixer"
+msgstr ""
+
+#. setup hotkeys
+#: ../plugins/volumealsa/volumealsa.c:1454
+msgid "Hotkey for Volume Up"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1456
+msgid "Hotkey for Volume Down"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1458
+msgid "Hotkey for Volume Mute"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1514
+#: ../plugins/volumealsa/volumealsa.c:1553
+#: ../plugins/volumealsa/volumealsa.c:1574
+msgid "Volume Control"
+msgstr " "
+
+#: ../plugins/volumealsa/volumealsa.c:1516
+msgid "Audio Card"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1519
+msgid "Channel to Operate"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1527
+msgid "Command to Open Mixer"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1542
+msgid "Launch Mixer"
+msgstr ""
+
+#: ../plugins/volumealsa/volumealsa.c:1554
+#: ../plugins/volumealsa/volumealsa.c:1575
+msgid "Display and control volume"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:183
+msgid "<Hidden Access Point>"
+msgstr "<Hidden Access Point>"
+
+#: ../plugins/netstat/netstat.c:220
+msgid "Wireless Networks not found in range"
+msgstr "    "
+
+#. Repair
+#: ../plugins/netstat/netstat.c:256
+msgid "Repair"
+msgstr ""
+
+#. interface down
+#: ../plugins/netstat/netstat.c:261
+msgid "Disable"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:352
+msgid "Wireless Connection has no connectivity"
+msgstr "    "
+
+#: ../plugins/netstat/netstat.c:354
+msgid "Network cable is plugged out"
+msgstr "   "
+
+#: ../plugins/netstat/netstat.c:356
+msgid "Connection has limited or no connectivity"
+msgstr "     "
+
+#: ../plugins/netstat/netstat.c:360 ../plugins/netstat/netstat.c:371
+#: ../plugins/netstat/netstat.c:382
+msgid "IP Address:"
+msgstr "IP "
+
+#: ../plugins/netstat/netstat.c:361
+msgid "Remote IP:"
+msgstr " IP:"
+
+#: ../plugins/netstat/netstat.c:362 ../plugins/netstat/netstat.c:373
+#: ../plugins/netstat/netstat.c:384
+msgid "Netmask:"
+msgstr "Netmask:"
+
+#: ../plugins/netstat/netstat.c:363 ../plugins/netstat/netstat.c:375
+#: ../plugins/netstat/netstat.c:386
+msgid "Activity"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:363 ../plugins/netstat/netstat.c:375
+#: ../plugins/netstat/netstat.c:386
+msgid "Sent"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:363 ../plugins/netstat/netstat.c:375
+#: ../plugins/netstat/netstat.c:386
+msgid "Received"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:364 ../plugins/netstat/netstat.c:376
+#: ../plugins/netstat/netstat.c:387
+msgid "bytes"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:365 ../plugins/netstat/netstat.c:377
+#: ../plugins/netstat/netstat.c:388
+msgid "packets"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:368 ../plugins/netstatus/netstatus-iface.c:173
+msgid "Wireless"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:370
+msgid "Protocol:"
+msgstr ""
+
+#: ../plugins/netstat/netstat.c:374 ../plugins/netstat/netstat.c:385
+msgid "HW Address:"
+msgstr "HW "
+
+#: ../plugins/netstat/netstat.c:505
+msgid "Manage Networks"
+msgstr " "
+
+#: ../plugins/netstat/netstat.c:506
+msgid "Monitor and Manage networks"
+msgstr "   "
+
+#. create dialog
+#: ../plugins/netstat/passwd_gui.c:90
+msgid "Setting Encryption Key"
+msgstr " "
+
+#: ../plugins/netstat/passwd_gui.c:101
+msgid ""
+"This wireless network was encrypted.\n"
+"You must have the encryption key."
+msgstr ""
+"    \n"
+"  "
+
+#: ../plugins/netstat/passwd_gui.c:106
+msgid "Encryption Key:"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus.c:154 ../plugins/netstatus/netstatus.c:166
+msgid "Network Status Monitor"
+msgstr "  "
+
+#: ../plugins/netstatus/netstatus.c:156
+msgid "Interface to monitor"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus.c:157
+msgid "Config tool"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus.c:167
+msgid "Monitor network status"
+msgstr "  "
+
+#: ../plugins/netstatus/netstatus-dialog.c:52
+#: ../plugins/netstatus/netstatus-dialog.c:316
+msgid "Unknown"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-dialog.c:117
+msgid "Connection Properties"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-dialog.c:123
+#, c-format
+msgid "Connection Properties: %s"
+msgstr "  %s"
+
+#: ../plugins/netstatus/netstatus-dialog.c:136
+#, c-format
+msgid "%lu packet"
+msgid_plural "%lu packets"
+msgstr[0] "%lu "
+msgstr[1] "%lu "
+
+#: ../plugins/netstatus/netstatus-dialog.c:400
+#, c-format
+msgid ""
+"There was an error displaying help:\n"
+"%s"
+msgstr ""
+"    \n"
+"%s"
+
+#: ../plugins/netstatus/netstatus-icon.c:381
+#, c-format
+msgid "Network Connection: %s"
+msgstr "  %s"
+
+#: ../plugins/netstatus/netstatus-icon.c:386
+msgid "Network Connection"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-icon.c:847
+msgid "Interface"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-icon.c:848
+msgid "The current interface the icon is monitoring."
+msgstr " ,    "
+
+#: ../plugins/netstatus/netstatus-icon.c:855
+msgid "Orientation"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-icon.c:856
+msgid "The orientation of the tray."
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-icon.c:864
+msgid "Tooltips Enabled"
+msgstr "   "
+
+#: ../plugins/netstatus/netstatus-icon.c:865
+msgid "Whether or not the icon's tooltips are enabled."
+msgstr "    :"
+
+#: ../plugins/netstatus/netstatus-icon.c:872
+msgid "Show Signal"
+msgstr "  "
+
+#: ../plugins/netstatus/netstatus-icon.c:873
+msgid "Whether or not the signal strength should be displayed."
+msgstr "    "
+
+#: ../plugins/netstatus/netstatus-icon.c:982
+#, c-format
+msgid ""
+"Please contact your system administrator to resolve the following problem:\n"
+"\n"
+"%s"
+msgstr ""
+"Please contact your system administrator to resolve the following problem:\n"
+"\n"
+"%s"
+
+#: ../plugins/netstatus/netstatus-iface.c:148
+msgid "Name"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-iface.c:149
+msgid "The interface name"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-iface.c:156
+#: ../plugins/weather/weatherwidget.c:2137
+msgid "State"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-iface.c:157
+msgid "The interface state"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-iface.c:165
+msgid "Stats"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-iface.c:166
+msgid "The interface packets/bytes statistics"
+msgstr " / "
+
+#: ../plugins/netstatus/netstatus-iface.c:174
+msgid "Whether the interface is a wireless interface"
+msgstr " ,    "
+
+#: ../plugins/netstatus/netstatus-iface.c:181
+msgid "Signal"
+msgstr ""
+
+#: ../plugins/netstatus/netstatus-iface.c:182
+msgid "Wireless signal strength percentage"
+msgstr "   "
+
+#: ../plugins/netstatus/netstatus-iface.c:192
+msgid "The current error condition"
+msgstr "  "
+
+#: ../plugins/netstatus/netstatus-iface.c:440
+#: ../plugins/netstatus/netstatus-iface.c:1205
+#, c-format
+msgid "Unable to open socket: %s"
+msgstr "    %s"
+
+#: ../plugins/netstatus/netstatus-iface.c:502
+#: ../plugins/netstatus/netstatus-iface.c:1231
+#, c-format
+msgid "SIOCGIFFLAGS error: %s"
+msgstr "SIOCGIFFLAGS  %s"
+
+#: ../plugins/netstatus/netstatus-iface.c:879
+msgid "AMPR NET/ROM"
+msgstr "AMPR NET/ROM"
+
+#: ../plugins/netstatus/netstatus-iface.c:882
+msgid "Ethernet"
+msgstr "Ethernet"
+
+#: ../plugins/netstatus/netstatus-iface.c:888
+msgid "AMPR AX.25"
+msgstr "AMPR AX.25"
+
+#: ../plugins/netstatus/netstatus-iface.c:897
+#: ../plugins/netstatus/netstatus-iface.c:1017
+msgid "16/4 Mbps Token Ring"
+msgstr "16/4 Mbps Token Ring"
+
+#: ../plugins/netstatus/netstatus-iface.c:900
+msgid "ARCnet"
+msgstr "ARCnet"
+
+#: ../plugins/netstatus/netstatus-iface.c:906
+msgid "Frame Relay DLCI"
+msgstr "Frame Relay DLCI"
+
+#: ../plugins/netstatus/netstatus-iface.c:912
+msgid "Metricom Starmode IP"
+msgstr "Metricom Starmode IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:915
+msgid "Serial Line IP"
+msgstr "Serial Line IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:918
+msgid "VJ Serial Line IP"
+msgstr "VJ Serial Line IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:921
+msgid "6-bit Serial Line IP"
+msgstr "6-bit Serial Line IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:924
+msgid "VJ 6-bit Serial Line IP"
+msgstr "VJ 6-bit Serial Line IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:930
+msgid "Adaptive Serial Line IP"
+msgstr "Adaptive Serial Line IP"
+
+#: ../plugins/netstatus/netstatus-iface.c:933
+msgid "AMPR ROSE"
+msgstr "AMPR ROSE"
+
+#: ../plugins/netstatus/netstatus-iface.c:936
+msgid "Generic X.25"
+msgstr "Generic X.25"
+
+#: ../plugins/netstatus/netstatus-iface.c:939
+msgid "Point-to-Point Protocol"
+msgstr "Point-to-Point Protocol"
+
+#: ../plugins/netstatus/netstatus-iface.c:945
+msgid "(Cisco)-HDLC"
+msgstr "(Cisco)-HDLC"
+
+#: ../plugins/netstatus/netstatus-iface.c:948
+msgid "LAPB"
+msgstr "LAPB"
+
+#: ../plugins/netstatus/netstatus-iface.c:957
+msgid "IPIP Tunnel"
+msgstr "IPIP Tunnel"
+
+#: ../plugins/netstatus/netstatus-iface.c:963
+msgid "Frame Relay Access Device"
+msgstr "Frame Relay Access Device"
+
+#: ../plugins/netstatus/netstatus-iface.c:969
+msgid "Local Loopback"
+msgstr "Local Loopback"
+
+#: ../plugins/netstatus/netstatus-iface.c:975
+msgid "Fiber Distributed Data Interface"
+msgstr "Fibre Distributed Data Interface"
+
+#: ../plugins/netstatus/netstatus-iface.c:981
+msgid "IPv6-in-IPv4"
+msgstr "IPv6-in-IPv4"
+
+#: ../plugins/netstatus/netstatus-iface.c:993
+msgid "HIPPI"
+msgstr "HIPPI"
+
+#: ../plugins/netstatus/netstatus-iface.c:996
+msgid "Ash"
+msgstr "Ash"
+
+#: ../plugins/netstatus/netstatus-iface.c:999
+msgid "Econet"
+msgstr "Econet"
+
+#: ../plugins/netstatus/netstatus-iface.c:1002
+msgid "IrLAP"
+msgstr "IrLAP"
+
+#: ../plugins/netstatus/netstatus-iface.c:1163
+#, c-format
+msgid "SIOCGIFCONF error: %s"
+msgstr "SIOCGIFCONF error: %s"
+
+#: ../plugins/netstatus/netstatus-iface.c:1256
+#, c-format
+msgid "No network devices found"
+msgstr "   "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:180
+#, c-format
+msgid "Cannot open /proc/net/dev: %s"
+msgstr "   /proc/net/dev %s"
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:185
+#, fuzzy
+msgid "Could not parse /proc/net/dev. No data."
+msgstr "  /proc/net/dev -  "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:190
+msgid "Could not parse /proc/net/dev. Unknown format."
+msgstr "  /proc/net/dev.  "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:205
+#: ../plugins/netstatus/netstatus-sysdeps.c:332
+#, c-format
+msgid "Could not parse interface name from '%s'"
+msgstr " '%s' -  "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:218
+#: ../plugins/netstatus/netstatus-sysdeps.c:647
+#, c-format
+msgid ""
+"Could not parse interface statistics from '%s'. prx_idx = %d; ptx_idx = %d; "
+"brx_idx = %d; btx_idx = %d;"
+msgstr ""
+"  '%s' - . prx_idx = %d; ptx_idx = %d; "
+"brx_idx = %d; btx_idx = %d;"
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:312
+#, fuzzy
+msgid "Could not parse /proc/net/wireless. No data."
+msgstr "  /proc/net/wireless -.  ."
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:316
+msgid "Could not parse /proc/net/wireless.  "
+msgstr "  /proc/net/wireless.  "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:343
+#, c-format
+msgid "Could not parse wireless details from '%s'. link_idx = %d;"
+msgstr "  '%s'    link_idx = %d;"
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:416
+#, c-format
+msgid "Could not connect to interface, '%s'"
+msgstr "  '%s' "
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:422
+#, c-format
+msgid "Could not send ioctl to interface, '%s'"
+msgstr "  ioctl - , '%s'"
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:600
+#, c-format
+msgid "Could not parse command line '%s': %s"
+msgstr "  '%s'  %s"
+
+#: ../plugins/netstatus/netstatus-sysdeps.c:637
+msgid "Could not parse 'netstat' output. Unknown format"
+msgstr "  'netstat' .  "
+
+#: ../plugins/netstatus/netstatus-util.c:152
+msgid "Disconnected"
+msgstr " "
+
+#: ../plugins/netstatus/netstatus-util.c:155
+msgid "Idle"
+msgstr "Idle"
+
+#: ../plugins/netstatus/netstatus-util.c:158
+msgid "Sending"
+msgstr "Sending"
+
+#: ../plugins/netstatus/netstatus-util.c:161
+msgid "Receiving"
+msgstr "Receiving"
+
+#: ../plugins/netstatus/netstatus-util.c:164
+msgid "Sending/Receiving"
+msgstr "Sending/Receiving"
+
+#: ../plugins/batt/batt.c:156
+#, fuzzy, c-format
+msgid "Battery %d: %d%% charged, %d:%02d until full"
+msgstr " %d%%  , %d:%02d "
+
+#: ../plugins/batt/batt.c:170
+#, fuzzy, c-format
+msgid "Battery %d: %d%% charged, %d:%02d left"
+msgstr " %d%%  , %d:%02d  "
+
+#: ../plugins/batt/batt.c:177
+#, fuzzy, c-format
+msgid "Battery %d: %d%% charged"
+msgstr " %d%%  "
+
+#: ../plugins/batt/batt.c:187
+#, c-format
+msgid ""
+"\n"
+"%sEnergy full design:\t\t%5d mWh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:189
+#, c-format
+msgid ""
+"\n"
+"%sEnergy full:\t\t\t%5d mWh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:191
+#, c-format
+msgid ""
+"\n"
+"%sEnergy now:\t\t\t%5d mWh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:193
+#, c-format
+msgid ""
+"\n"
+"%sPower now:\t\t\t%5d mW"
+msgstr ""
+
+#: ../plugins/batt/batt.c:196
+#, c-format
+msgid ""
+"\n"
+"%sCharge full design:\t%5d mAh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:198
+#, c-format
+msgid ""
+"\n"
+"%sCharge full:\t\t\t%5d mAh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:200
+#, c-format
+msgid ""
+"\n"
+"%sCharge now:\t\t\t%5d mAh"
+msgstr ""
+
+#: ../plugins/batt/batt.c:202
+#, c-format
+msgid ""
+"\n"
+"%sCurrent now:\t\t\t%5d mA"
+msgstr ""
+
+#: ../plugins/batt/batt.c:205
+#, c-format
+msgid ""
+"\n"
+"%sCurrent Voltage:\t\t%.3lf V"
+msgstr ""
+
+#: ../plugins/batt/batt.c:243
+msgid "No batteries found"
+msgstr "  "
+
+#: ../plugins/batt/batt.c:546 ../plugins/batt/batt.c:679
+#, fuzzy
+msgid "Battery low"
+msgstr " "
+
+#: ../plugins/batt/batt.c:702 ../plugins/batt/batt.c:726
+msgid "Battery Monitor"
+msgstr " "
+
+#: ../plugins/batt/batt.c:704
+msgid "Hide if there is no battery"
+msgstr ",    "
+
+#: ../plugins/batt/batt.c:705
+msgid "Alarm command"
+msgstr " "
+
+#: ../plugins/batt/batt.c:706
+msgid "Alarm time (minutes left)"
+msgstr "  (  )"
+
+#: ../plugins/batt/batt.c:707
+msgid "Background color"
+msgstr " "
+
+#: ../plugins/batt/batt.c:708
+msgid "Charging color 1"
+msgstr "  1"
+
+#: ../plugins/batt/batt.c:709
+msgid "Charging color 2"
+msgstr "  2"
+
+#: ../plugins/batt/batt.c:710
+msgid "Discharging color 1"
+msgstr "  1"
+
+#: ../plugins/batt/batt.c:711
+msgid "Discharging color 2"
+msgstr "  2"
+
+#: ../plugins/batt/batt.c:712
+msgid "Border width"
+msgstr " "
+
+#: ../plugins/batt/batt.c:716
+msgid "Show Extended Information"
+msgstr ""
+
+#: ../plugins/batt/batt.c:717
+#, fuzzy
+msgid "Number of battery to monitor"
+msgstr " "
+
+#: ../plugins/batt/batt.c:727
+msgid "Display battery status using ACPI"
+msgstr "    ACPI"
+
+#: ../plugins/kbled/kbled.c:203 ../plugins/kbled/kbled.c:234
+msgid "Keyboard LED"
+msgstr "LED "
+
+#: ../plugins/kbled/kbled.c:205
+msgid "Show CapsLock"
+msgstr "  CapsLock -"
+
+#: ../plugins/kbled/kbled.c:206
+msgid "Show NumLock"
+msgstr "  NumLock -"
+
+#: ../plugins/kbled/kbled.c:207
+msgid "Show ScrollLock"
+msgstr "  ScrollLock -"
+
+#: ../plugins/kbled/kbled.c:235
+msgid "Indicators for CapsLock, NumLock, and ScrollLock keys"
+msgstr " CapsLock-, NumLock-  ScrollLock  "
+
+#. A label to allow for click through
+#: ../plugins/indicator/indicator.c:694
+msgid "No Indicators"
+msgstr "  "
+
+#: ../plugins/indicator/indicator.c:863 ../plugins/indicator/indicator.c:881
+msgid "Indicator applets"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:865
+msgid "Indicator Applications"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:866
+msgid "Clock Indicator"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:867
+msgid "Messaging Menu"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:868
+msgid "Network Menu"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:869
+msgid "Session Menu"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:870
+msgid "Sound Menu"
+msgstr " "
+
+#: ../plugins/indicator/indicator.c:882
+msgid "Add indicator applets to the panel"
+msgstr "    "
+
+#: ../plugins/monitors/monitors.c:285
+#, c-format
+msgid "CPU usage: %.2f%%"
+msgstr "  %.2f%%"
+
+#: ../plugins/monitors/monitors.c:386
+#, c-format
+msgid "RAM usage: %.1fMB (%.2f%%)"
+msgstr "RAM-  %.1fMB (%.2f%%)"
+
+#: ../plugins/monitors/monitors.c:732 ../plugins/monitors/monitors.c:821
+msgid "Resource monitors"
+msgstr " "
+
+#: ../plugins/monitors/monitors.c:735
+msgid "CPU color"
+msgstr " "
+
+#: ../plugins/monitors/monitors.c:736
+msgid "Display RAM usage"
+msgstr " RAM- "
+
+#: ../plugins/monitors/monitors.c:737
+msgid "RAM color"
+msgstr "RAM- "
+
+#: ../plugins/monitors/monitors.c:738
+msgid "Action when clicked (default: lxtask)"
+msgstr "  (: lxtask)"
+
+#: ../plugins/monitors/monitors.c:822
+msgid "Display monitors (CPU, RAM)"
+msgstr "  (CPU, RAM)"
+
+#: ../plugins/weather/weatherwidget.c:52
+msgid "[N/A]"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:806
+msgid "Enter New Location"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:820
+#, fuzzy
+msgid "_New Location:"
+msgstr " "
+
+#: ../plugins/weather/weatherwidget.c:831
+msgid ""
+"Enter the:\n"
+"- city, or\n"
+"- city and state/country, or\n"
+"- postal code\n"
+"for which to retrieve the weather forecast."
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:868
+#: ../plugins/weather/weatherwidget.c:1001
+msgid "You must specify a location."
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:915
+#, c-format
+msgid "Location '%s' not found!"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1074
+#, fuzzy
+msgid "Preferences"
+msgstr " "
+
+#: ../plugins/weather/weatherwidget.c:1080
+msgid "Refresh"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1086
+msgid "Quit"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1253
+#, fuzzy
+msgid "Weather Preferences"
+msgstr " "
+
+#: ../plugins/weather/weatherwidget.c:1267
+#, fuzzy
+msgid "Current Location"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1271
+#: ../plugins/weather/weatherwidget.c:1573
+#, fuzzy
+msgid "None configured"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1273
+#: ../plugins/weather/weatherwidget.c:1570
+msgid "_Set"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1294
+msgid "Display"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1298
+#, fuzzy
+msgid "Name:"
+msgstr "_"
+
+#: ../plugins/weather/weatherwidget.c:1302
+msgid "Units:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1306
+msgid "_Metric (C)"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1308
+msgid "_English (F)"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1343
+msgid "Forecast"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1347
+msgid "Updates:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1351
+msgid "Ma_nual"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1355
+msgid "_Automatic, every"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1376
+msgid "minutes"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1385
+msgid "Source:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1521
+#, fuzzy
+msgid "C_hange"
+msgstr " "
+
+#. Both are available
+#: ../plugins/weather/weatherwidget.c:1612
+#, c-format
+msgid "Current Conditions for %s"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1636
+msgid "Location:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1659
+msgid "Last updated:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1693
+msgid "Feels like:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1719
+msgid "Humidity:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1746
+#, fuzzy
+msgid "Pressure:"
+msgstr "IP "
+
+#: ../plugins/weather/weatherwidget.c:1773
+msgid "Visibility:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1801
+msgid "Wind:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1824
+msgid "Sunrise:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1847
+msgid "Sunset:"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1955
+#: ../plugins/weather/weatherwidget.c:2306
+#, c-format
+msgid "Forecast for %s unavailable."
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:1964
+#: ../plugins/weather/weatherwidget.c:2311
+#, fuzzy, c-format
+msgid "Location not set."
+msgstr "Logout command is not set"
+
+#: ../plugins/weather/weatherwidget.c:1981
+#, c-format
+msgid "Searching for '%s'..."
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:2107
+#, c-format
+msgid "Location matches for '%s'"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:2127
+msgid "City"
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:2147
+msgid "Country"
+msgstr ""
+
+#. make it nice and pretty
+#: ../plugins/weather/weatherwidget.c:2286
+#, fuzzy
+msgid "Currently in "
+msgstr "   "
+
+#: ../plugins/weather/weatherwidget.c:2292
+msgid "Today: "
+msgstr ""
+
+#: ../plugins/weather/weatherwidget.c:2293
+msgid "Tomorrow: "
+msgstr ""
+
+#: ../plugins/weather/weather.c:415
+#, fuzzy
+msgid "Weather Plugin"
+msgstr "WNCKpager "
+
+#: ../plugins/weather/weather.c:416
+msgid "Show weather conditions for a location."
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:51 ../plugins/weather/openweathermap.c:56
+msgid "N"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:52 ../plugins/weather/openweathermap.c:57
+msgid "NNE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:53 ../plugins/weather/openweathermap.c:58
+msgid "NE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:54 ../plugins/weather/openweathermap.c:59
+msgid "ENE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:55 ../plugins/weather/openweathermap.c:60
+msgid "E"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:56 ../plugins/weather/openweathermap.c:61
+msgid "ESE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:57 ../plugins/weather/openweathermap.c:62
+msgid "SE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:58 ../plugins/weather/openweathermap.c:63
+msgid "SSE"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:59 ../plugins/weather/openweathermap.c:64
+msgid "S"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:60 ../plugins/weather/openweathermap.c:65
+msgid "SSW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:61 ../plugins/weather/openweathermap.c:66
+msgid "SW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:62 ../plugins/weather/openweathermap.c:67
+msgid "WSW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:63 ../plugins/weather/openweathermap.c:68
+msgid "W"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:64 ../plugins/weather/openweathermap.c:69
+msgid "WNW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:65 ../plugins/weather/openweathermap.c:70
+msgid "NW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:66 ../plugins/weather/openweathermap.c:71
+msgid "NNW"
+msgstr ""
+
+#: ../plugins/weather/yahooutil.c:1086
+msgid "Yahoo! Weather"
+msgstr ""
+
+#: ../plugins/weather/openweathermap.c:365
+msgid "Mph"
+msgstr ""
+
+#: ../plugins/weather/openweathermap.c:365
+msgid "m/s"
+msgstr ""
+
+#: ../plugins/weather/openweathermap.c:535
+msgid "m"
+msgstr ""
+
+#: ../plugins/weather/openweathermap.c:932
+msgid "OpenWeatherMap"
+msgstr ""
+
+#~ msgid " --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"
+#~ msgstr " --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"
+
+#~ msgid "Display Image and Tooltip"
+#~ msgstr "Display Image and Tooltip"
+
+#~ msgid "Normal"
+#~ msgstr "Normal"
+
+#~ msgid "Warning1"
+#~ msgstr "Warning1"
+
+#~ msgid "Warning2"
+#~ msgstr "Warning2"
+
+#~ msgid "Failed to launch time configuration tool: %s"
+#~ msgstr "Failed to launch time configuration tool: %s"
+
+#~ msgid "Model"
+#~ msgstr "Model"
+
+#~ msgid "WNCKPager"
+#~ msgstr "WNCKPager"
+
+#~ msgid "<b>Icon</b>"
+#~ msgstr "<b>Icon</b>"
+
+#~ msgid "Configure Keyboard Layout Switcher"
+#~ msgstr "Configure Keyboard Layout Switcher"
+
+#~ msgid "image"
+#~ msgstr "image"
+
+#~ msgid "text"
+#~ msgstr "text"
+
+#~ msgid "Per application settings"
+#~ msgstr "Per application settings"
+
+#~ msgid "Default layout:"
+#~ msgstr "Default layout:"
diff --git a/po/is.po b/po/is.po
index 843661a..b8c7a9b 100644
--- a/po/is.po
+++ b/po/is.po
@@ -1,24 +1,25 @@
 # Icelandic translation for LXPanel package.
-# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER
-# This file is distributed under the same license as the PACKAGE package.
-# Sveinn  Felli <sv1@fellsnet.is>, 2014.
+# Copyright (C) 2021 Free Software Foundation, Inc.
+# This file is distributed under the same license as the LXPanel package.
+# Sveinn  Felli <sv1@fellsnet.is>, 2014, 2021.
+#
 msgid ""
 msgstr ""
 "Project-Id-Version: LXPanel 0.8\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2019-03-01 01:38+0200\n"
-"PO-Revision-Date: 2014-12-08 09:30+0000\n"
-"Last-Translator: Sveinn  Felli <sveinki@nett.is>\n"
+"POT-Creation-Date: 2019-02-22 00:29+0200\n"
+"PO-Revision-Date: 2021-03-05 08:34+0000\n"
+"Last-Translator: Sveinn  Felli <sv1@fellsnet.is>\n"
 "Language-Team: Icelandic <translation-team-is@lists.sourceforge.net>\n"
-"Language: \n"
+"Language: is\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 "Plural-Forms: nplurals=2; plural=(n != 1);\n"
-"X-Generator: Pootle 2.7.0-alpha1\n"
-"X-Pootle-Revision: 0\n"
-"X-Pootle-Path: /is/lxpanel/po/is.po\n"
+"X-Generator: Lokalize 2.0\n"
 "X-POOTLE-MTIME: 1418031016.000000\n"
+"X-Pootle-Path: /is/lxpanel/po/is.po\n"
+"X-Pootle-Revision: 0\n"
 
 #: ../src/configurator.c:148
 msgid ""
@@ -31,7 +32,7 @@ msgstr ""
 
 #: ../src/configurator.c:632
 msgid "Currently loaded plugins"
-msgstr "Hlain forrit"
+msgstr "Hlanar forritsvibtur"
 
 #: ../src/configurator.c:641
 msgid "Stretch"
@@ -39,11 +40,11 @@ msgstr "Teygja"
 
 #: ../src/configurator.c:779
 msgid "Add plugin to panel"
-msgstr "Bta forriti vi skjstiku"
+msgstr "Bta forritsvibt vi skjstiku"
 
 #: ../src/configurator.c:807
 msgid "Available plugins"
-msgstr "Tiltkar vibtur"
+msgstr "Tiltkar forritsvibtur"
 
 #: ../src/configurator.c:1427
 msgid "Logout command is not set"
@@ -87,9 +88,8 @@ msgid "LXPanel"
 msgstr "LXPanel"
 
 #: ../src/panel.c:1378
-#, fuzzy
-msgid "Copyright (C) 2008-2021"
-msgstr "Hfundarrttur (C) 2008-2014"
+msgid "Copyright (C) 2008-2019"
+msgstr "Hfundarrttur (C) 2008-2019"
 
 #: ../src/panel.c:1379
 msgid "Desktop panel for LXDE project"
@@ -129,27 +129,27 @@ msgstr "Um forriti"
 msgid "Panel"
 msgstr "Skjstika"
 
-#: ../src/panel.c:1710 ../src/panel.c:1718 ../data/ui/panel-pref.glade.h:22
+#: ../src/panel.c:1708 ../src/panel.c:1716 ../data/ui/panel-pref.glade.h:22
 msgid "Height:"
 msgstr "H:"
 
-#: ../src/panel.c:1711 ../src/panel.c:1717 ../data/ui/panel-pref.glade.h:21
+#: ../src/panel.c:1709 ../src/panel.c:1715 ../data/ui/panel-pref.glade.h:21
 msgid "Width:"
 msgstr "Breidd:"
 
-#: ../src/panel.c:1712 ../data/ui/panel-pref.glade.h:13
+#: ../src/panel.c:1710 ../data/ui/panel-pref.glade.h:13
 msgid "Left"
 msgstr "Vinstri"
 
-#: ../src/panel.c:1713 ../data/ui/panel-pref.glade.h:14
+#: ../src/panel.c:1711 ../data/ui/panel-pref.glade.h:14
 msgid "Right"
 msgstr "Hgri"
 
-#: ../src/panel.c:1719 ../data/ui/panel-pref.glade.h:12
+#: ../src/panel.c:1717 ../data/ui/panel-pref.glade.h:12
 msgid "Top"
 msgstr "Efst"
 
-#: ../src/panel.c:1720 ../data/ui/panel-pref.glade.h:11
+#: ../src/panel.c:1718 ../data/ui/panel-pref.glade.h:11
 msgid "Bottom"
 msgstr "Nest"
 
@@ -175,8 +175,8 @@ msgid "Logout"
 msgstr "Skr t"
 
 #: ../src/main.c:323
-#, c-format, fuzzy
-msgid "lxpanel %s - lightweight GTK+ panel for UNIX desktops\n"
+#, c-format
+msgid "lxpanel %s - lightweight GTK2+ panel for UNIX desktops\n"
 msgstr "lxpanel %s - ltt GTK2+ skjstika fyrir UNIX skjbor\n"
 
 #: ../src/main.c:324
@@ -277,7 +277,7 @@ msgid "Spacer"
 msgstr "Bil"
 
 #: ../src/space.c:396 ../data/ui/panel-pref.glade.h:32
-#: ../plugins/batt/batt.c:714
+#: ../plugins/batt/batt.c:710
 msgid "Size"
 msgstr "Str"
 
@@ -287,7 +287,7 @@ msgstr "thluta plssi"
 
 #: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2482
 msgid "Application Launch and Task Bar"
-msgstr "Forritarsi- og verkefnasl"
+msgstr "Forritarsi- og verkefnastika"
 
 #. Launchtaskbar mode: launchbar, taskbar, or combined
 #: ../data/ui/launchtaskbar.glade.h:3
@@ -300,7 +300,7 @@ msgstr "Forritarsar"
 
 #: ../data/ui/launchtaskbar.glade.h:5
 msgid "<b>Launchbar</b>"
-msgstr "<b>Rsisl</b>"
+msgstr "<b>Rsistika</b>"
 
 #: ../data/ui/launchtaskbar.glade.h:6
 msgid "Show tooltips"
@@ -320,7 +320,7 @@ msgstr "Sna glugga fr llum skjborum"
 
 #: ../data/ui/launchtaskbar.glade.h:10
 msgid "Only show windows on the same monitor as the task bar"
-msgstr "Einungis birta glugga af sama skj og verkefnaslin er "
+msgstr "Einungis birta glugga af sama skj og verkefnastikan er "
 
 #: ../data/ui/launchtaskbar.glade.h:11
 msgid "Use mouse wheel"
@@ -340,7 +340,7 @@ msgstr "Gera virkt a stkka litlar verkefnatknmyndir"
 
 #: ../data/ui/launchtaskbar.glade.h:15
 msgid "Show task icons smaller than rest of panel icons"
-msgstr ""
+msgstr "Sna verkefnatknmyndir minni en arar tknmyndir stikunnar"
 
 #: ../data/ui/launchtaskbar.glade.h:16
 msgid "Maximum width of task button"
@@ -352,19 +352,19 @@ msgstr "Millibil"
 
 #: ../data/ui/launchtaskbar.glade.h:18
 msgid "<b>Taskbar</b>"
-msgstr "<b>Verkefnasl</b>"
+msgstr "<b>Verkefnastika</b>"
 
 #: ../data/ui/launchtaskbar.glade.h:19
 msgid "Only Application Launch Bar"
-msgstr "Einungis forritarsisl"
+msgstr "Einungis forritarsistika"
 
 #: ../data/ui/launchtaskbar.glade.h:20
 msgid "Only Task Bar (Window List)"
-msgstr "Einungis verkefnasl (gluggalisti)"
+msgstr "Einungis verkefnastika (gluggalisti)"
 
 #: ../data/ui/launchtaskbar.glade.h:21
 msgid "Integrated Application Launch Bar and Task Bar"
-msgstr "Samtvinnu forritarsi- og verkefnasl"
+msgstr "Samtvinnu forritarsi- og verkefnastika"
 
 #: ../data/ui/netstatus.glade.h:1
 msgid "<b>Connection</b>"
@@ -599,11 +599,11 @@ msgstr "<b>Sjlfvirk felun</b>"
 
 #: ../data/ui/panel-pref.glade.h:47
 msgid "Log level"
-msgstr "Annlsstig"
+msgstr "Stig atvikaskrningar"
 
 #: ../data/ui/panel-pref.glade.h:48
 msgid "<b>Log level</b>"
-msgstr "<b>Annlsstig</b>"
+msgstr "<b>Stig atvikaskrningar</b>"
 
 #: ../data/ui/panel-pref.glade.h:49
 msgid "Advanced"
@@ -635,11 +635,11 @@ msgstr "Birta nmer skjbora, eftir cmeury@users.sf.net"
 
 #: ../plugins/launchtaskbar.c:1831 ../plugins/launchtaskbar.c:2452
 msgid "Application Launch Bar"
-msgstr "Forritarsisl"
+msgstr "Forritarsistika"
 
 #: ../plugins/launchtaskbar.c:1834 ../plugins/launchtaskbar.c:2462
 msgid "Task Bar (Window List)"
-msgstr "Verkefnasl (gluggalisti)"
+msgstr "Verkefnastika (gluggalisti)"
 
 #: ../plugins/launchtaskbar.c:1985
 msgid "A_dd to Launcher"
@@ -655,12 +655,11 @@ msgstr "_Ntt tilvik"
 
 #: ../plugins/launchtaskbar.c:2453
 msgid "Bar with buttons to launch application"
-msgstr "Sl me hnppum til a rsa forrit"
+msgstr "Stika me hnppum til a rsa forrit"
 
 #: ../plugins/launchtaskbar.c:2463
-#, fuzzy
 msgid ""
-"Taskbar shows all opened windows and allows to iconify them, shade or get "
+"Taskbar shows all opened windows and allow to iconify them, shade or get "
 "focus"
 msgstr ""
 "Verkefnasl birtir alla opna glugga og leyfir a tkngera , skyggja, ea "
@@ -668,7 +667,7 @@ msgstr ""
 
 #: ../plugins/launchtaskbar.c:2483
 msgid "Bar with buttons to launch application and/or show all opened windows"
-msgstr "Sl me hnppum til a rsa forrit og/ea sna alla opna glugga"
+msgstr "Stika me hnppum til a rsa forrit og/ea sna alla opna glugga"
 
 #. Add Raise menu item.
 #: ../plugins/task-button.c:352
@@ -995,13 +994,12 @@ msgid "CPUFreq frontend"
 msgstr "Vimt  CPUFreq"
 
 #: ../plugins/cpufreq/cpufreq.c:402
-#, fuzzy
-msgid "Display CPU frequency and allow one to change governors and frequency"
+msgid "Display CPU frequency and allow to change governors and frequency"
 msgstr "Sna tni rgjrva og leyfa a breytt s um stringar og tnir"
 
 #: ../plugins/volumealsa/volumealsa.c:245
 msgid "ALSA (or pulseaudio) had a problem. Please check the lxpanel logs."
-msgstr ""
+msgstr "ALSA (ea pulseaudio)   vandrum. Athugau lxpanel-atvikaskrrnar."
 
 #. Display current level in tooltip.
 #: ../plugins/volumealsa/volumealsa.c:613
@@ -1030,65 +1028,65 @@ msgstr "agga niur"
 #. Just to have these translated
 #: ../plugins/volumealsa/volumealsa.c:1313
 msgid "Line"
-msgstr ""
+msgstr "Lna"
 
 #: ../plugins/volumealsa/volumealsa.c:1313
 msgid "LineOut"
-msgstr ""
+msgstr "Lnat"
 
 #: ../plugins/volumealsa/volumealsa.c:1313
 msgid "Front"
-msgstr ""
+msgstr "Fram"
 
 #: ../plugins/volumealsa/volumealsa.c:1313
 msgid "Surround"
-msgstr ""
+msgstr "Surround hljumhverfi"
 
 #: ../plugins/volumealsa/volumealsa.c:1313
 msgid "Speaker+LO"
-msgstr ""
+msgstr "Htalari+L"
 
 #: ../plugins/volumealsa/volumealsa.c:1352
 msgid "default"
-msgstr ""
+msgstr "sjlfgefi"
 
 #. desc, index
 #: ../plugins/volumealsa/volumealsa.c:1412
 msgid "Master"
-msgstr ""
+msgstr "Aal"
 
 #: ../plugins/volumealsa/volumealsa.c:1416
 msgid "PCM"
-msgstr ""
+msgstr "PCM"
 
 #: ../plugins/volumealsa/volumealsa.c:1420
 msgid "Headphone"
-msgstr ""
+msgstr "Heyrnartl"
 
 #: ../plugins/volumealsa/volumealsa.c:1442
 msgid "Click for Volume Slider"
-msgstr ""
+msgstr "Smelltu fyrir hljstyrksslea"
 
 #: ../plugins/volumealsa/volumealsa.c:1446
 msgid "Click for Toggle Mute"
-msgstr ""
+msgstr "Smelltu til a vxla hlji af/"
 
 #: ../plugins/volumealsa/volumealsa.c:1450
 msgid "Click for Open Mixer"
-msgstr ""
+msgstr "Smelltu til a opna hljblandara"
 
 #. setup hotkeys
 #: ../plugins/volumealsa/volumealsa.c:1454
 msgid "Hotkey for Volume Up"
-msgstr ""
+msgstr "Fltilykill til a hkka hljstyrk"
 
 #: ../plugins/volumealsa/volumealsa.c:1456
 msgid "Hotkey for Volume Down"
-msgstr ""
+msgstr "Fltilykill til a lkka hljstyrk"
 
 #: ../plugins/volumealsa/volumealsa.c:1458
 msgid "Hotkey for Volume Mute"
-msgstr ""
+msgstr "Fltilykill til a agga hlj"
 
 #: ../plugins/volumealsa/volumealsa.c:1514
 #: ../plugins/volumealsa/volumealsa.c:1553
@@ -1098,26 +1096,24 @@ msgstr "Hljstillir"
 
 #: ../plugins/volumealsa/volumealsa.c:1516
 msgid "Audio Card"
-msgstr ""
+msgstr "Hljkort"
 
 #: ../plugins/volumealsa/volumealsa.c:1519
 msgid "Channel to Operate"
-msgstr ""
+msgstr "Hljrs sem  a keyra"
 
 #: ../plugins/volumealsa/volumealsa.c:1527
 msgid "Command to Open Mixer"
-msgstr ""
+msgstr "Skipun til a opna hljblandara"
 
 #: ../plugins/volumealsa/volumealsa.c:1542
-#, fuzzy
 msgid "Launch Mixer"
-msgstr "Forritarsar"
+msgstr "Rsa hljblandara"
 
 #: ../plugins/volumealsa/volumealsa.c:1554
 #: ../plugins/volumealsa/volumealsa.c:1575
-#, fuzzy
 msgid "Display and control volume"
-msgstr "Birta og ssla me hljstyrk ALSA"
+msgstr "Birta og ssla me hljstyrk"
 
 #: ../plugins/netstat/netstat.c:183
 msgid "<Hidden Access Point>"
@@ -1333,7 +1329,7 @@ msgid "The interface name"
 msgstr "Heiti netkortsins"
 
 #: ../plugins/netstatus/netstatus-iface.c:156
-#: ../plugins/weather/weatherwidget.c:2137
+#: ../plugins/weather/weatherwidget.c:2136
 msgid "State"
 msgstr "Staa"
 
@@ -1573,25 +1569,22 @@ msgstr "Mttek"
 msgid "Sending/Receiving"
 msgstr "Sendi/Mttek"
 
-#: ../plugins/batt/batt.c:156
+#: ../plugins/batt/batt.c:155
 #, c-format
-#, fuzzy, c-format
 msgid "Battery %d: %d%% charged, %d:%02d until full"
-msgstr "Rafhlaa: %d%% hlain, %d:%02d ar til fullhlain"
+msgstr "Rafhlaa %d: %d%% hlain, %d:%02d ar til fullhlain"
 
-#: ../plugins/batt/batt.c:170
+#: ../plugins/batt/batt.c:169
 #, c-format
-#, fuzzy, c-format
 msgid "Battery %d: %d%% charged, %d:%02d left"
-msgstr "Rafhlaa: %d%% hlain, %d:%02d eftir"
+msgstr "Rafhlaa %d: %d%% hlain, %d:%02d eftir"
 
-#: ../plugins/batt/batt.c:177
+#: ../plugins/batt/batt.c:176
 #, c-format
-#, fuzzy, c-format
 msgid "Battery %d: %d%% charged"
-msgstr "Rafhlaa: %d%% hlain"
+msgstr "Rafhlaa %d: %d%% hlain"
 
-#: ../plugins/batt/batt.c:187
+#: ../plugins/batt/batt.c:186
 #, c-format
 msgid ""
 "\n"
@@ -1600,7 +1593,7 @@ msgstr ""
 "\n"
 "%sFullt afl (skv. framl.):\t\t%5d mWh"
 
-#: ../plugins/batt/batt.c:189
+#: ../plugins/batt/batt.c:188
 #, c-format
 msgid ""
 "\n"
@@ -1609,7 +1602,7 @@ msgstr ""
 "\n"
 "%sFullt afl:\t\t\t%5d mWh"
 
-#: ../plugins/batt/batt.c:191
+#: ../plugins/batt/batt.c:190
 #, c-format
 msgid ""
 "\n"
@@ -1618,7 +1611,7 @@ msgstr ""
 "\n"
 "%sAfl nna:\t\t\t%5d mWh"
 
-#: ../plugins/batt/batt.c:193
+#: ../plugins/batt/batt.c:192
 #, c-format
 msgid ""
 "\n"
@@ -1627,7 +1620,7 @@ msgstr ""
 "\n"
 "%sAfl nna:\t\t\t%5d mW"
 
-#: ../plugins/batt/batt.c:196
+#: ../plugins/batt/batt.c:195
 #, c-format
 msgid ""
 "\n"
@@ -1636,7 +1629,7 @@ msgstr ""
 "\n"
 "%sFull hlesla (skv. framl.):\t%5d mAh"
 
-#: ../plugins/batt/batt.c:198
+#: ../plugins/batt/batt.c:197
 #, c-format
 msgid ""
 "\n"
@@ -1645,7 +1638,7 @@ msgstr ""
 "\n"
 "%sFull hlesla:\t\t\t%5d mAh"
 
-#: ../plugins/batt/batt.c:200
+#: ../plugins/batt/batt.c:199
 #, c-format
 msgid ""
 "\n"
@@ -1654,7 +1647,7 @@ msgstr ""
 "\n"
 "%sHlesla nna:\t\t\t%5d mAh"
 
-#: ../plugins/batt/batt.c:202
+#: ../plugins/batt/batt.c:201
 #, c-format
 msgid ""
 "\n"
@@ -1663,7 +1656,7 @@ msgstr ""
 "\n"
 "%sStraumur nna:\t\t\t%5d mA"
 
-#: ../plugins/batt/batt.c:205
+#: ../plugins/batt/batt.c:204
 #, c-format
 msgid ""
 "\n"
@@ -1672,64 +1665,63 @@ msgstr ""
 "\n"
 "%sVolt nna:\t\t%.3lf V"
 
-#: ../plugins/batt/batt.c:243
+#: ../plugins/batt/batt.c:242
 msgid "No batteries found"
 msgstr "Fann engar rafhlur"
 
-#: ../plugins/batt/batt.c:546 ../plugins/batt/batt.c:679
+#: ../plugins/batt/batt.c:542 ../plugins/batt/batt.c:675
 msgid "Battery low"
 msgstr "Lti  rafhlu"
 
-#: ../plugins/batt/batt.c:702 ../plugins/batt/batt.c:726
+#: ../plugins/batt/batt.c:698 ../plugins/batt/batt.c:722
 msgid "Battery Monitor"
 msgstr "Rafhlueftirlit"
 
-#: ../plugins/batt/batt.c:704
+#: ../plugins/batt/batt.c:700
 msgid "Hide if there is no battery"
 msgstr "Fela ef a er engin rafhlaa"
 
-#: ../plugins/batt/batt.c:705
+#: ../plugins/batt/batt.c:701
 msgid "Alarm command"
 msgstr "minningarskipun"
 
-#: ../plugins/batt/batt.c:706
+#: ../plugins/batt/batt.c:702
 msgid "Alarm time (minutes left)"
 msgstr "Tmi minningar (mntur eftir)"
 
-#: ../plugins/batt/batt.c:707
+#: ../plugins/batt/batt.c:703
 msgid "Background color"
 msgstr "Bakgrunnslitur"
 
-#: ../plugins/batt/batt.c:708
+#: ../plugins/batt/batt.c:704
 msgid "Charging color 1"
 msgstr "Hleslulitur 1"
 
-#: ../plugins/batt/batt.c:709
+#: ../plugins/batt/batt.c:705
 msgid "Charging color 2"
 msgstr "Hleslulitur 2"
 
-#: ../plugins/batt/batt.c:710
+#: ../plugins/batt/batt.c:706
 msgid "Discharging color 1"
 msgstr "Afhleslulitur 1"
 
-#: ../plugins/batt/batt.c:711
+#: ../plugins/batt/batt.c:707
 msgid "Discharging color 2"
 msgstr "Afhleslulitur 2"
 
-#: ../plugins/batt/batt.c:712
+#: ../plugins/batt/batt.c:708
 msgid "Border width"
 msgstr "Breidd jaars"
 
-#: ../plugins/batt/batt.c:716
+#: ../plugins/batt/batt.c:712
 msgid "Show Extended Information"
 msgstr "Birta tarlegar upplsingar"
 
-#: ../plugins/batt/batt.c:717
-#, fuzzy
+#: ../plugins/batt/batt.c:713
 msgid "Number of battery to monitor"
-msgstr "Tengi sem  a fylgjast me"
+msgstr "Fjldi rafhlana sem  a vakta"
 
-#: ../plugins/batt/batt.c:727
+#: ../plugins/batt/batt.c:723
 msgid "Display battery status using ACPI"
 msgstr "Birta stu rafhlu me ACPI"
 
@@ -1828,15 +1820,15 @@ msgstr "Birta mla (CPU, RAM)"
 msgid "[N/A]"
 msgstr "[Ekki tiltkt]"
 
-#: ../plugins/weather/weatherwidget.c:806
+#: ../plugins/weather/weatherwidget.c:807
 msgid "Enter New Location"
 msgstr "Settu inn nja stasetningu"
 
-#: ../plugins/weather/weatherwidget.c:820
+#: ../plugins/weather/weatherwidget.c:821
 msgid "_New Location:"
 msgstr "_N stasetning:"
 
-#: ../plugins/weather/weatherwidget.c:831
+#: ../plugins/weather/weatherwidget.c:832
 msgid ""
 "Enter the:\n"
 "- city, or\n"
@@ -1850,267 +1842,267 @@ msgstr ""
 "- pstnmer\n"
 "ess staar sem  a n  veursp fyrir."
 
-#: ../plugins/weather/weatherwidget.c:868
-#: ../plugins/weather/weatherwidget.c:1001
+#: ../plugins/weather/weatherwidget.c:869
+#: ../plugins/weather/weatherwidget.c:1002
 msgid "You must specify a location."
 msgstr " verur a tiltaka stasetningu."
 
-#: ../plugins/weather/weatherwidget.c:915
+#: ../plugins/weather/weatherwidget.c:916
 #, c-format
 msgid "Location '%s' not found!"
 msgstr "Stasetningin '%s' fannst ekki!"
 
-#: ../plugins/weather/weatherwidget.c:1074
+#: ../plugins/weather/weatherwidget.c:1075
 msgid "Preferences"
 msgstr "Kjrstillingar"
 
-#: ../plugins/weather/weatherwidget.c:1080
+#: ../plugins/weather/weatherwidget.c:1081
 msgid "Refresh"
 msgstr "Endurlesa"
 
-#: ../plugins/weather/weatherwidget.c:1086
+#: ../plugins/weather/weatherwidget.c:1087
 msgid "Quit"
 msgstr "Htta"
 
-#: ../plugins/weather/weatherwidget.c:1253
+#: ../plugins/weather/weatherwidget.c:1254
 msgid "Weather Preferences"
 msgstr "Veurstillingar"
 
-#: ../plugins/weather/weatherwidget.c:1267
+#: ../plugins/weather/weatherwidget.c:1268
 msgid "Current Location"
 msgstr "Nverandi stasetning"
 
-#: ../plugins/weather/weatherwidget.c:1271
-#: ../plugins/weather/weatherwidget.c:1573
+#: ../plugins/weather/weatherwidget.c:1272
+#: ../plugins/weather/weatherwidget.c:1574
 msgid "None configured"
 msgstr "Ekkert stillt"
 
-#: ../plugins/weather/weatherwidget.c:1273
-#: ../plugins/weather/weatherwidget.c:1570
+#: ../plugins/weather/weatherwidget.c:1274
+#: ../plugins/weather/weatherwidget.c:1571
 msgid "_Set"
 msgstr "_Setja"
 
-#: ../plugins/weather/weatherwidget.c:1294
+#: ../plugins/weather/weatherwidget.c:1295
 msgid "Display"
 msgstr "Birting"
 
-#: ../plugins/weather/weatherwidget.c:1298
+#: ../plugins/weather/weatherwidget.c:1299
 msgid "Name:"
 msgstr "Heiti:"
 
-#: ../plugins/weather/weatherwidget.c:1302
+#: ../plugins/weather/weatherwidget.c:1303
 msgid "Units:"
 msgstr "Mlieiningar:"
 
-#: ../plugins/weather/weatherwidget.c:1306
+#: ../plugins/weather/weatherwidget.c:1307
 msgid "_Metric (C)"
 msgstr "_Metrakerfi (C)"
 
-#: ../plugins/weather/weatherwidget.c:1308
+#: ../plugins/weather/weatherwidget.c:1309
 msgid "_English (F)"
 msgstr "_Enskar (F)"
 
-#: ../plugins/weather/weatherwidget.c:1343
+#: ../plugins/weather/weatherwidget.c:1344
 msgid "Forecast"
 msgstr "Spr"
 
-#: ../plugins/weather/weatherwidget.c:1347
+#: ../plugins/weather/weatherwidget.c:1348
 msgid "Updates:"
 msgstr "Uppfrslur:"
 
-#: ../plugins/weather/weatherwidget.c:1351
+#: ../plugins/weather/weatherwidget.c:1352
 msgid "Ma_nual"
 msgstr "Ha_ndvirkt"
 
-#: ../plugins/weather/weatherwidget.c:1355
+#: ../plugins/weather/weatherwidget.c:1356
 msgid "_Automatic, every"
 msgstr "S_jlfvirkt "
 
-#: ../plugins/weather/weatherwidget.c:1376
+#: ../plugins/weather/weatherwidget.c:1377
 msgid "minutes"
 msgstr "mntna fresti"
 
-#: ../plugins/weather/weatherwidget.c:1385
+#: ../plugins/weather/weatherwidget.c:1386
 msgid "Source:"
 msgstr "Heimild:"
 
-#: ../plugins/weather/weatherwidget.c:1521
+#: ../plugins/weather/weatherwidget.c:1522
 msgid "C_hange"
 msgstr "Bre_yta"
 
 #. Both are available
-#: ../plugins/weather/weatherwidget.c:1612
+#: ../plugins/weather/weatherwidget.c:1613
 #, c-format
 msgid "Current Conditions for %s"
 msgstr "Veurskilyri  %s"
 
-#: ../plugins/weather/weatherwidget.c:1636
+#: ../plugins/weather/weatherwidget.c:1637
 msgid "Location:"
 msgstr "Stasetning:"
 
-#: ../plugins/weather/weatherwidget.c:1659
+#: ../plugins/weather/weatherwidget.c:1660
 msgid "Last updated:"
 msgstr "Sast uppfrt:"
 
-#: ../plugins/weather/weatherwidget.c:1693
+#: ../plugins/weather/weatherwidget.c:1694
 msgid "Feels like:"
 msgstr "Me vindklingu:"
 
-#: ../plugins/weather/weatherwidget.c:1719
+#: ../plugins/weather/weatherwidget.c:1720
 msgid "Humidity:"
 msgstr "Rakastig:"
 
-#: ../plugins/weather/weatherwidget.c:1746
+#: ../plugins/weather/weatherwidget.c:1747
 msgid "Pressure:"
 msgstr "rstingur:"
 
-#: ../plugins/weather/weatherwidget.c:1773
+#: ../plugins/weather/weatherwidget.c:1774
 msgid "Visibility:"
 msgstr "Skyggni:"
 
-#: ../plugins/weather/weatherwidget.c:1801
+#: ../plugins/weather/weatherwidget.c:1802
 msgid "Wind:"
 msgstr "Vindhrai:"
 
-#: ../plugins/weather/weatherwidget.c:1824
+#: ../plugins/weather/weatherwidget.c:1825
 msgid "Sunrise:"
 msgstr "Slarupprs:"
 
-#: ../plugins/weather/weatherwidget.c:1847
+#: ../plugins/weather/weatherwidget.c:1848
 msgid "Sunset:"
 msgstr "Slsetur:"
 
-#: ../plugins/weather/weatherwidget.c:1955
-#: ../plugins/weather/weatherwidget.c:2306
+#: ../plugins/weather/weatherwidget.c:1954
+#: ../plugins/weather/weatherwidget.c:2295
 #, c-format
 msgid "Forecast for %s unavailable."
 msgstr "Sp fyrir %s er ekki tiltk."
 
-#: ../plugins/weather/weatherwidget.c:1964
-#: ../plugins/weather/weatherwidget.c:2311
+#: ../plugins/weather/weatherwidget.c:1963
+#: ../plugins/weather/weatherwidget.c:2300
 #, c-format
 msgid "Location not set."
 msgstr "Stasetning var ekki skilgreind."
 
-#: ../plugins/weather/weatherwidget.c:1981
+#: ../plugins/weather/weatherwidget.c:1980
 #, c-format
 msgid "Searching for '%s'..."
 msgstr "Leita a '%s'..."
 
-#: ../plugins/weather/weatherwidget.c:2107
+#: ../plugins/weather/weatherwidget.c:2106
 #, c-format
 msgid "Location matches for '%s'"
 msgstr "Samsvarandi stair fyrir '%s'"
 
-#: ../plugins/weather/weatherwidget.c:2127
+#: ../plugins/weather/weatherwidget.c:2126
 msgid "City"
 msgstr "Borg"
 
-#: ../plugins/weather/weatherwidget.c:2147
+#: ../plugins/weather/weatherwidget.c:2146
 msgid "Country"
 msgstr "Land"
 
 #. make it nice and pretty
-#: ../plugins/weather/weatherwidget.c:2286
+#: ../plugins/weather/weatherwidget.c:2278
 msgid "Currently in "
 msgstr "Nna  "
 
-#: ../plugins/weather/weatherwidget.c:2292
+#: ../plugins/weather/weatherwidget.c:2281
 msgid "Today: "
 msgstr " dag: "
 
-#: ../plugins/weather/weatherwidget.c:2293
+#: ../plugins/weather/weatherwidget.c:2282
 msgid "Tomorrow: "
 msgstr " morgun: "
 
-#: ../plugins/weather/weather.c:415
+#: ../plugins/weather/weather.c:419
 msgid "Weather Plugin"
-msgstr "Vibtarforrit fyrir veurlsingar/spr"
+msgstr "Forritsvibt fyrir veurlsingar/spr"
 
-#: ../plugins/weather/weather.c:416
+#: ../plugins/weather/weather.c:420
 msgid "Show weather conditions for a location."
 msgstr "Birta veurslsingu fyrir kveinn sta."
 
-#: ../plugins/weather/yahooutil.c:51 ../plugins/weather/openweathermap.c:56
+#: ../plugins/weather/yahooutil.c:51
 msgid "N"
-msgstr ""
+msgstr "N"
 
-#: ../plugins/weather/yahooutil.c:52 ../plugins/weather/openweathermap.c:57
+#: ../plugins/weather/yahooutil.c:52
 msgid "NNE"
-msgstr ""
+msgstr "NNA"
 
-#: ../plugins/weather/yahooutil.c:53 ../plugins/weather/openweathermap.c:58
+#: ../plugins/weather/yahooutil.c:53
 msgid "NE"
-msgstr ""
+msgstr "NA"
 
-#: ../plugins/weather/yahooutil.c:54 ../plugins/weather/openweathermap.c:59
+#: ../plugins/weather/yahooutil.c:54
 msgid "ENE"
-msgstr ""
+msgstr "ANA"
 
-#: ../plugins/weather/yahooutil.c:55 ../plugins/weather/openweathermap.c:60
+#: ../plugins/weather/yahooutil.c:55
 msgid "E"
-msgstr ""
+msgstr "E"
 
-#: ../plugins/weather/yahooutil.c:56 ../plugins/weather/openweathermap.c:61
+#: ../plugins/weather/yahooutil.c:56
 msgid "ESE"
-msgstr ""
+msgstr "ASA"
 
-#: ../plugins/weather/yahooutil.c:57 ../plugins/weather/openweathermap.c:62
+#: ../plugins/weather/yahooutil.c:57
 msgid "SE"
-msgstr ""
+msgstr "SA"
 
-#: ../plugins/weather/yahooutil.c:58 ../plugins/weather/openweathermap.c:63
+#: ../plugins/weather/yahooutil.c:58
 msgid "SSE"
-msgstr ""
+msgstr "SSA"
 
-#: ../plugins/weather/yahooutil.c:59 ../plugins/weather/openweathermap.c:64
+#: ../plugins/weather/yahooutil.c:59
 msgid "S"
-msgstr ""
+msgstr "S"
 
-#: ../plugins/weather/yahooutil.c:60 ../plugins/weather/openweathermap.c:65
+#: ../plugins/weather/yahooutil.c:60
 msgid "SSW"
-msgstr ""
+msgstr "SSV"
 
-#: ../plugins/weather/yahooutil.c:61 ../plugins/weather/openweathermap.c:66
+#: ../plugins/weather/yahooutil.c:61
 msgid "SW"
-msgstr ""
+msgstr "SV"
 
-#: ../plugins/weather/yahooutil.c:62 ../plugins/weather/openweathermap.c:67
+#: ../plugins/weather/yahooutil.c:62
 msgid "WSW"
-msgstr ""
+msgstr "VSV"
 
-#: ../plugins/weather/yahooutil.c:63 ../plugins/weather/openweathermap.c:68
+#: ../plugins/weather/yahooutil.c:63
 msgid "W"
-msgstr ""
+msgstr "V"
 
-#: ../plugins/weather/yahooutil.c:64 ../plugins/weather/openweathermap.c:69
+#: ../plugins/weather/yahooutil.c:64
 msgid "WNW"
-msgstr ""
+msgstr "VNV"
 
-#: ../plugins/weather/yahooutil.c:65 ../plugins/weather/openweathermap.c:70
+#: ../plugins/weather/yahooutil.c:65
 msgid "NW"
-msgstr ""
+msgstr "NV"
 
-#: ../plugins/weather/yahooutil.c:66 ../plugins/weather/openweathermap.c:71
+#: ../plugins/weather/yahooutil.c:66
 msgid "NNW"
-msgstr ""
+msgstr "NNV"
 
 #: ../plugins/weather/yahooutil.c:1086
 msgid "Yahoo! Weather"
-msgstr ""
+msgstr "Yahoo! veur"
 
-#: ../plugins/weather/openweathermap.c:365
+#: ../plugins/weather/openweathermap.c:347
 msgid "Mph"
-msgstr ""
+msgstr "mlur/klst"
 
-#: ../plugins/weather/openweathermap.c:365
+#: ../plugins/weather/openweathermap.c:347
 msgid "m/s"
-msgstr ""
+msgstr "m/sek"
 
-#: ../plugins/weather/openweathermap.c:535
+#: ../plugins/weather/openweathermap.c:501
 msgid "m"
-msgstr ""
+msgstr "m"
 
-#: ../plugins/weather/openweathermap.c:932
+#: ../plugins/weather/openweathermap.c:916
 msgid "OpenWeatherMap"
-msgstr ""
+msgstr "OpenWeatherMap"
diff --git a/po/it.po b/po/it.po
index 048885c..a32c4b2 100644
--- a/po/it.po
+++ b/po/it.po
@@ -1,24 +1,24 @@
 # Translation of lxpanel to Italian
-# Copyright (C) 2009 Fabio Barone <phonky at gmx.net>
 # This file is distributed under the same license as the lxpanel package
 # Fabio Barone <phonky at gmx.net>, 2009.
 # Andrea Florio <andrea@opensuse.org>, 2010.
 # Daniele Forsi <daniele@forsi.it>, 2012, 2016.
-# kunturweb <kunturweb@altervista.org>, 2014
+# kunturweb <kunturweb@altervista.org>, 2014.
+# Emanuele Goldoni <emanuele.goldoni@gmail.com>, 2020.
 msgid ""
 msgstr ""
-"Project-Id-Version: lxpanel 0.3.99\n"
+"Project-Id-Version: LxPanel\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2019-03-01 01:38+0200\n"
-"PO-Revision-Date: 2016-10-26 00:40+0200\n"
-"Last-Translator: Daniele Forsi <daniele@forsi.it>\n"
-"Language-Team: <lxde-i18n@lists.sourceforge.net>\n"
-"Language: \n"
+"POT-Creation-Date: 2020-05-06 12:53+0200\n"
+"PO-Revision-Date: 2020-05-11 09:28+0200\n"
+"Last-Translator: Emanuele Goldoni <emanuele.goldoni@gmail.com>\n"
+"Language-Team: Italian\n"
+"Language: it\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 "Plural-Forms: nplurals=2; plural=(n != 1);\n"
-"X-Generator: Virtaal 0.7.1\n"
+"X-Generator: Poedit 2.3\n"
 
 #: ../src/configurator.c:148
 msgid ""
@@ -49,23 +49,23 @@ msgstr "Plugin disponibili"
 msgid "Logout command is not set"
 msgstr "Il comando di chiusura sessione non  impostato"
 
-#: ../src/configurator.c:1495
+#: ../src/configurator.c:1519
 msgid "Select a directory"
 msgstr "Scegliere una directory"
 
-#: ../src/configurator.c:1495 ../src/configurator.c:1607
+#: ../src/configurator.c:1519 ../src/configurator.c:1633
 msgid "Select a file"
 msgstr "Scegliere un file"
 
-#: ../src/configurator.c:1640
+#: ../src/configurator.c:1692
 msgid "_Browse"
 msgstr "_Sfoglia"
 
-#: ../src/panel.c:1292
+#: ../src/panel.c:1403
 msgid "There is no room for another panel. All the edges are taken."
 msgstr "Non c' spazio per un altro pannello. Tutti i bordi sono occupati."
 
-#: ../src/panel.c:1318
+#: ../src/panel.c:1429
 msgid ""
 "Really delete this panel?\n"
 "<b>Warning: This can not be recovered.</b>"
@@ -73,93 +73,94 @@ msgstr ""
 "Eliminare davvero questo pannello?\n"
 "<b>Attenzione: non potr essere recuperato</b>"
 
-#: ../src/panel.c:1320
+#: ../src/panel.c:1431
 msgid "Confirm"
 msgstr "Conferma"
 
 #. TRANSLATORS: Replace this string with your names, one name per line.
-#: ../src/panel.c:1355
+#: ../src/panel.c:1466
 msgid "translator-credits"
 msgstr ""
 "Alessandro Pellizzari\n"
-"Daniele Forsi <daniele@forsi.it>"
+"Daniele Forsi <daniele@forsi.it>\n"
+"Emanuele Goldoni <emanuele.goldoni@gmail.com>"
 
-#: ../src/panel.c:1360
+#: ../src/panel.c:1471
 msgid "LXPanel"
 msgstr "LXPanel"
 
-#: ../src/panel.c:1378
-msgid "Copyright (C) 2008-2021"
-msgstr "Copyright  2008-2021"
+#: ../src/panel.c:1489
+msgid "Copyright (C) 2008-2019"
+msgstr "Copyright  2008-2019"
 
-#: ../src/panel.c:1379
+#: ../src/panel.c:1490
 msgid "Desktop panel for LXDE project"
 msgstr "Pannello del desktop per il Progetto LXDE"
 
-#: ../src/panel.c:1421
+#: ../src/panel.c:1532
 #, c-format
-msgid "\"%s\" Settings"
-msgstr "Impostazioni di %s"
+msgid "%s Settings"
+msgstr "Impostazioni di %s"
 
-#: ../src/panel.c:1442
+#: ../src/panel.c:1553
 msgid "Add / Remove Panel Items"
-msgstr "Aggiungi/Rimuovi elementi pannello"
+msgstr "Aggiungi / Rimuovi elementi del pannello"
 
-#: ../src/panel.c:1450
+#: ../src/panel.c:1561
 #, c-format
 msgid "Remove \"%s\" From Panel"
 msgstr "Elimina %s dal pannello"
 
-#: ../src/panel.c:1462
+#: ../src/panel.c:1573
 msgid "Panel Settings"
 msgstr "Impostazioni pannello"
 
-#: ../src/panel.c:1468
+#: ../src/panel.c:1579
 msgid "Create New Panel"
 msgstr "Crea nuovo pannello"
 
-#: ../src/panel.c:1474
+#: ../src/panel.c:1585
 msgid "Delete This Panel"
 msgstr "Elimina questo pannello"
 
-#: ../src/panel.c:1485
+#: ../src/panel.c:1596
 msgid "About"
 msgstr "Informazioni"
 
-#: ../src/panel.c:1492
+#: ../src/panel.c:1603
 msgid "Panel"
 msgstr "Pannello"
 
-#: ../src/panel.c:1710 ../src/panel.c:1718 ../data/ui/panel-pref.glade.h:22
+#: ../src/panel.c:1821 ../src/panel.c:1829 ../data/ui/panel-pref.glade.h:22
 msgid "Height:"
 msgstr "Altezza:"
 
-#: ../src/panel.c:1711 ../src/panel.c:1717 ../data/ui/panel-pref.glade.h:21
+#: ../src/panel.c:1822 ../src/panel.c:1828 ../data/ui/panel-pref.glade.h:21
 msgid "Width:"
 msgstr "Larghezza:"
 
-#: ../src/panel.c:1712 ../data/ui/panel-pref.glade.h:13
+#: ../src/panel.c:1823 ../data/ui/panel-pref.glade.h:13
 msgid "Left"
 msgstr "Sinistra"
 
-#: ../src/panel.c:1713 ../data/ui/panel-pref.glade.h:14
+#: ../src/panel.c:1824 ../data/ui/panel-pref.glade.h:14
 msgid "Right"
 msgstr "Destra"
 
-#: ../src/panel.c:1719 ../data/ui/panel-pref.glade.h:12
+#: ../src/panel.c:1830 ../data/ui/panel-pref.glade.h:12
 msgid "Top"
 msgstr "Superiore"
 
-#: ../src/panel.c:1720 ../data/ui/panel-pref.glade.h:11
+#: ../src/panel.c:1831 ../data/ui/panel-pref.glade.h:11
 msgid "Bottom"
 msgstr "Inferiore"
 
-#: ../src/plugin.c:348
+#: ../src/plugin.c:353
 msgid "No file manager is configured."
 msgstr "Nessun gestore di file configurato."
 
 #. { "configure", N_("Preferences"), configure },
-#: ../src/gtk-run.c:385 ../src/main.c:69 ../plugins/menu.c:718
+#: ../src/gtk-run.c:385 ../src/main.c:70 ../plugins/menu.c:733
 msgid "Run"
 msgstr "Esegui"
 
@@ -167,58 +168,58 @@ msgstr "Esegui"
 msgid "Enter the command you want to execute:"
 msgstr "Digitare il comando da eseguire:"
 
-#: ../src/main.c:70 ../plugins/menu.c:719
+#: ../src/main.c:71 ../plugins/menu.c:734
 msgid "Restart"
 msgstr "Riavvia"
 
-#: ../src/main.c:71 ../plugins/menu.c:720
+#: ../src/main.c:72 ../plugins/menu.c:735
 msgid "Logout"
 msgstr "Chiudi sessione"
 
-#: ../src/main.c:323
-#, c-format, fuzzy
-msgid "lxpanel %s - lightweight GTK+ panel for UNIX desktops\n"
+#: ../src/main.c:505
+#, c-format
+msgid "lxpanel %s - lightweight GTK2+ panel for UNIX desktops\n"
 msgstr "lxpanel %s - pannello GTK2+ leggero per desktop UNIX\n"
 
-#: ../src/main.c:324
+#: ../src/main.c:506
 #, c-format
 msgid "Command line options:\n"
 msgstr "Opzioni da riga di comando:\n"
 
-#: ../src/main.c:325
+#: ../src/main.c:507
 #, c-format
 msgid " --help      -- print this help and exit\n"
-msgstr " --help         -- mostra questo aiuto e termina\n"
+msgstr " --help      -- mostra questo aiuto e termina\n"
 
-#: ../src/main.c:326
+#: ../src/main.c:508
 #, c-format
 msgid " --version   -- print version and exit\n"
-msgstr " --version      -- mostra la versione e termina\n"
+msgstr " --version   -- mostra la versione e termina\n"
 
 #. g_print(_(" --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"));
 #. g_print(_(" --configure -- launch configuration utility\n"));
-#: ../src/main.c:329
+#: ../src/main.c:511
 #, c-format
 msgid " --profile name -- use specified profile\n"
 msgstr " --profile NOME -- usa il profilo specificato\n"
 
-#: ../src/main.c:331
+#: ../src/main.c:513
 #, c-format
 msgid " -h  -- same as --help\n"
 msgstr " -h  -- analogo a --help\n"
 
-#: ../src/main.c:332
+#: ../src/main.c:514
 #, c-format
 msgid " -p  -- same as --profile\n"
 msgstr " -p  -- analogo a --profile\n"
 
-#: ../src/main.c:333
+#: ../src/main.c:515
 #, c-format
 msgid " -v  -- same as --version\n"
 msgstr " -v  -- analogo a --version\n"
 
 #. g_print(_(" -C  -- same as --configure\n"));
-#: ../src/main.c:335
+#: ../src/main.c:517
 #, c-format
 msgid ""
 "\n"
@@ -286,9 +287,9 @@ msgstr "Dimensione"
 msgid "Allocate space"
 msgstr "Alloca spazio"
 
-#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2482
+#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2507
 msgid "Application Launch and Task Bar"
-msgstr "Avvio applicazioni e Barra dei task"
+msgstr "Barre di avvio applicazioni e delle attivit"
 
 #. Launchtaskbar mode: launchbar, taskbar, or combined
 #: ../data/ui/launchtaskbar.glade.h:3
@@ -321,7 +322,8 @@ msgstr "Mostra finestre da tutte le scrivanie"
 
 #: ../data/ui/launchtaskbar.glade.h:10
 msgid "Only show windows on the same monitor as the task bar"
-msgstr "Mostra solo le finestre dello stesso monitor della barra dei task"
+msgstr ""
+"Mostra solo le finestre dello stesso monitor della barra delle attivit"
 
 #: ../data/ui/launchtaskbar.glade.h:11
 msgid "Use mouse wheel"
@@ -337,15 +339,16 @@ msgstr "Combina finestre multiple applicazione in un singolo pulsante"
 
 #: ../data/ui/launchtaskbar.glade.h:14
 msgid "Disable enlargement for small task icons"
-msgstr "Disabilita l'ingrandimento delle icone piccole dei task"
+msgstr "Disabilita l'ingrandimento delle icone piccole delle attivit"
 
 #: ../data/ui/launchtaskbar.glade.h:15
 msgid "Show task icons smaller than rest of panel icons"
 msgstr ""
+"Mostra icone delle attivit pi piccole rispetto alle altre del pannello"
 
 #: ../data/ui/launchtaskbar.glade.h:16
 msgid "Maximum width of task button"
-msgstr "Larghezza massima di un pulsante dei task"
+msgstr "Larghezza massima di un pulsante delle attivit"
 
 #: ../data/ui/launchtaskbar.glade.h:17
 msgid "Spacing"
@@ -353,7 +356,7 @@ msgstr "Spaziatura"
 
 #: ../data/ui/launchtaskbar.glade.h:18
 msgid "<b>Taskbar</b>"
-msgstr "<b>Barra dei task</b>"
+msgstr "<b>Barra delle attivit</b>"
 
 #: ../data/ui/launchtaskbar.glade.h:19
 msgid "Only Application Launch Bar"
@@ -361,11 +364,11 @@ msgstr "Solo barra avvio applicazioni"
 
 #: ../data/ui/launchtaskbar.glade.h:20
 msgid "Only Task Bar (Window List)"
-msgstr "Solo barra dei task (Elenco finestre)"
+msgstr "Solo barra delle attivit (elenco finestre)"
 
 #: ../data/ui/launchtaskbar.glade.h:21
 msgid "Integrated Application Launch Bar and Task Bar"
-msgstr "Barra avvio applicazioni e barra dei task integrata"
+msgstr "Barra avvio applicazioni e barra delle attivit integrate"
 
 #: ../data/ui/netstatus.glade.h:1
 msgid "<b>Connection</b>"
@@ -462,7 +465,7 @@ msgstr "Pixel"
 #: ../data/ui/panel-pref.glade.h:4
 #, no-c-format
 msgid "% Percent"
-msgstr "% Percento"
+msgstr "% (percentuale)"
 
 #  un'opzione per "Livello registro:"
 #: ../data/ui/panel-pref.glade.h:6
@@ -581,7 +584,7 @@ msgstr "I window manager devono trattare il pannello come dock"
 
 #: ../data/ui/panel-pref.glade.h:41
 msgid "Reserve space, and not covered by maximized windows"
-msgstr "Riserva spazio e non  coperto da finestre massimizzate"
+msgstr "Riserva spazio e non coprirlo con finestre massimizzate"
 
 #: ../data/ui/panel-pref.glade.h:42
 msgid "<b>Properties</b>"
@@ -615,19 +618,35 @@ msgstr "<b>Livello registro</b>"
 msgid "Advanced"
 msgstr "Avanzate"
 
-#: ../plugins/cpu/cpu.c:310
+#: ../plugins/cpu/cpu.c:368
+msgid "CPU Usage"
+msgstr "Utilizzo CPU"
+
+#: ../plugins/cpu/cpu.c:370
+msgid "Show usage as percentage"
+msgstr "Mostra utilizzo come percentuale"
+
+#: ../plugins/cpu/cpu.c:371
+msgid "Foreground colour"
+msgstr "Colore in primo piano"
+
+#: ../plugins/cpu/cpu.c:372
+msgid "Background colour"
+msgstr "Colore di sfondo"
+
+#: ../plugins/cpu/cpu.c:380
 msgid "CPU Usage Monitor"
-msgstr "Monitor uso CPU"
+msgstr "Monitor utilizzo CPU"
 
-#: ../plugins/cpu/cpu.c:311 ../plugins/monitors/monitors.c:734
+#: ../plugins/cpu/cpu.c:382 ../plugins/monitors/monitors.c:734
 msgid "Display CPU usage"
-msgstr "Mostra uso CPU"
+msgstr "Mostra utilizzo CPU"
 
 #: ../plugins/deskno/deskno.c:210 ../plugins/deskno/deskno.c:230
 msgid "Desktop Number / Workspace Name"
 msgstr "Numero scrivania / Nome area di lavoro"
 
-#: ../plugins/deskno/deskno.c:212 ../plugins/dclock.c:439
+#: ../plugins/deskno/deskno.c:212
 msgid "Bold font"
 msgstr "Carattere grassetto"
 
@@ -639,144 +658,161 @@ msgstr "Mostra nomi scrivanie"
 msgid "Display workspace number, by cmeury@users.sf.net"
 msgstr "Mostra il numero dell'area di lavoro, di cmeury@users.sf.net"
 
-#: ../plugins/launchtaskbar.c:1831 ../plugins/launchtaskbar.c:2452
+#: ../plugins/launchtaskbar.c:1835 ../plugins/launchtaskbar.c:2477
 msgid "Application Launch Bar"
 msgstr "Barra avvio applicazioni"
 
-#: ../plugins/launchtaskbar.c:1834 ../plugins/launchtaskbar.c:2462
+#: ../plugins/launchtaskbar.c:1838 ../plugins/launchtaskbar.c:2487
 msgid "Task Bar (Window List)"
-msgstr "Barra delle applicazioni (Elenco finestre)"
+msgstr "Barra delle attivit (elenco finestre)"
 
-#: ../plugins/launchtaskbar.c:1985
+#: ../plugins/launchtaskbar.c:2010
 msgid "A_dd to Launcher"
 msgstr "A_ggiungi al lanciatore"
 
-#: ../plugins/launchtaskbar.c:1987
+#: ../plugins/launchtaskbar.c:2012
 msgid "Rem_ove from Launcher"
 msgstr "Elimina dal lanciat_ore"
 
-#: ../plugins/launchtaskbar.c:1989
+#: ../plugins/launchtaskbar.c:2014
 msgid "_New Instance"
 msgstr "_Nuova istanza"
 
-#: ../plugins/launchtaskbar.c:2453
+#: ../plugins/launchtaskbar.c:2478
 msgid "Bar with buttons to launch application"
 msgstr "Barra con pulsanti per avviare applicazioni"
 
-#: ../plugins/launchtaskbar.c:2463
-#, fuzzy
+#: ../plugins/launchtaskbar.c:2488
 msgid ""
-"Taskbar shows all opened windows and allows to iconify them, shade or get "
+"Taskbar shows all opened windows and allow to iconify them, shade or get "
 "focus"
 msgstr ""
-"La barra delle applicazioni mostra tutte le finestre aperte e permette di "
+"La barra delle attivit mostra tutte le finestre aperte e permette di "
 "minimizzarle, arrotolarle o attivarle"
 
-#: ../plugins/launchtaskbar.c:2483
+#: ../plugins/launchtaskbar.c:2508
 msgid "Bar with buttons to launch application and/or show all opened windows"
 msgstr ""
 "Barra con pulsanti per avviare applicazioni e/o mostrare tutte le finestre "
 "aperte"
 
 #. Add Raise menu item.
-#: ../plugins/task-button.c:352
+#: ../plugins/task-button.c:351
 msgid "_Raise"
 msgstr "_Rivela"
 
 #. Add Restore menu item.
-#: ../plugins/task-button.c:357
+#: ../plugins/task-button.c:356
 msgid "R_estore"
 msgstr "R_ipristina"
 
 #. Add Maximize menu item.
-#: ../plugins/task-button.c:362
+#: ../plugins/task-button.c:361
 msgid "Ma_ximize"
 msgstr "Massimi_zza"
 
 #. Add Iconify menu item.
-#: ../plugins/task-button.c:367
+#: ../plugins/task-button.c:366
 msgid "Ico_nify"
 msgstr "Ico_nifica"
 
-#: ../plugins/task-button.c:388
+#: ../plugins/task-button.c:387
 #, c-format
 msgid "Workspace _%d"
 msgstr "Area di lavoro _%d"
 
-#: ../plugins/task-button.c:393
+#: ../plugins/task-button.c:392
 #, c-format
 msgid "Workspace %d"
 msgstr "Area di lavoro %d"
 
 #. Add "move to all workspaces" item.  This causes the window to be visible no matter what desktop is active.
-#: ../plugins/task-button.c:410
+#: ../plugins/task-button.c:409
 msgid "_All workspaces"
 msgstr "_Tutte le aree di lavoro"
 
 #. FIXME: add "Current workspace" item, active if not on a current
 #. Add Move to Workspace menu item as a submenu.
-#: ../plugins/task-button.c:418
+#: ../plugins/task-button.c:417
 msgid "_Move to Workspace"
 msgstr "_Muovi ad area di lavoro"
 
-#: ../plugins/task-button.c:433
+#: ../plugins/task-button.c:432
 msgid "_Close Window"
 msgstr "_Chiudi finestra"
 
-#: ../plugins/task-button.c:1256
+#: ../plugins/task-button.c:1258
 msgid "_Close all windows"
 msgstr "_Chiudi tutte le finestre"
 
-#: ../plugins/dclock.c:433 ../plugins/dclock.c:453
+#: ../plugins/dclock.c:551 ../plugins/dclock.c:574
 msgid "Digital Clock"
 msgstr "Orologio digitale"
 
-#: ../plugins/dclock.c:435
+#: ../plugins/dclock.c:553
 msgid "Clock Format"
 msgstr "Formato orologio"
 
-#: ../plugins/dclock.c:436
+#: ../plugins/dclock.c:554
 msgid "Tooltip Format"
 msgstr "Formato suggerimenti"
 
-#: ../plugins/dclock.c:437
+#: ../plugins/dclock.c:555
 #, c-format
 msgid "Format codes: man 3 strftime; %n for line break"
 msgstr "Codici formato: man 3 strftime; %n per ritorno a capo"
 
-#: ../plugins/dclock.c:438
+#: ../plugins/dclock.c:556
 msgid "Action when clicked (default: display calendar)"
 msgstr "Azione al clic (predefinita: mostra calendario)"
 
-#: ../plugins/dclock.c:440
+#. _("Bold font"), &dc->bold, CONF_TYPE_BOOL,
+#: ../plugins/dclock.c:558
 msgid "Tooltip only"
 msgstr "Solo suggerimenti"
 
-#: ../plugins/dclock.c:441
+#. _("Center text"), &dc->center_text, CONF_TYPE_BOOL,
+#: ../plugins/dclock.c:560
+msgid "Left align"
+msgstr "Allinea a sinistra"
+
+#: ../plugins/dclock.c:561
 msgid "Center text"
 msgstr "Testo centrato"
 
-#: ../plugins/dclock.c:454
+#: ../plugins/dclock.c:562
+msgid "Right align"
+msgstr "Allinea a destra"
+
+#: ../plugins/dclock.c:575
 msgid "Display digital clock and tooltip"
 msgstr "Mostra orologio digitale e suggerimento"
 
-#: ../plugins/menu.c:360
+#: ../plugins/menu.c:363
 msgid "Add to desktop"
 msgstr "Aggiunge alla scrivania"
 
-#: ../plugins/menu.c:367
+#: ../plugins/menu.c:370
 msgid "Properties"
 msgstr "Propriet"
 
-#: ../plugins/menu.c:989 ../plugins/menu.c:997
+#: ../plugins/menu.c:717
+msgid "Click here to open applications menu"
+msgstr "Clic qui per aprire il menu applicazioni"
+
+#: ../plugins/menu.c:1025 ../plugins/menu.c:1040
 msgid "Menu"
 msgstr "Menu"
 
-#: ../plugins/menu.c:990 ../plugins/dirmenu.c:359
+#: ../plugins/menu.c:1026 ../plugins/dirmenu.c:359
 msgid "Icon"
 msgstr "Icona"
 
-#: ../plugins/menu.c:998
+#: ../plugins/menu.c:1027
+msgid "Padding"
+msgstr "Riempimento"
+
+#: ../plugins/menu.c:1041
 msgid "Application Menu"
 msgstr "Menu applicazioni"
 
@@ -916,7 +952,7 @@ msgstr "Minimizza tutte le finestre"
 
 #: ../plugins/wincmd.c:247
 msgid "Alternately iconify/shade and raise"
-msgstr "Iconificare/arrotolare e rivelare alternativamente"
+msgstr "Iconificare / Arrotolare e rivelare alternativamente"
 
 #: ../plugins/wincmd.c:256
 msgid ""
@@ -1003,8 +1039,7 @@ msgid "CPUFreq frontend"
 msgstr "Interfaccia CPUFreq"
 
 #: ../plugins/cpufreq/cpufreq.c:402
-#, fuzzy
-msgid "Display CPU frequency and allow one to change governors and frequency"
+msgid "Display CPU frequency and allow to change governors and frequency"
 msgstr ""
 "Mostra la frequenza della CPU e permette di cambiare governor e frequenza"
 
@@ -1023,8 +1058,8 @@ msgid ""
 "Error, you need to install an application to configure the sound "
 "(pavucontrol, alsamixer ...)"
 msgstr ""
-"Errore:  necessario installare un'applicazione per configurare il suono ("
-"pavucontrol, alsamixer ...)"
+"Errore:  necessario installare un'applicazione per configurare il suono "
+"(pavucontrol, alsamixer ...)"
 
 #. Create a frame as the child of the viewport.
 #: ../plugins/volumealsa/volumealsa.c:895
@@ -1059,7 +1094,7 @@ msgstr "Altoparlante+LO"
 
 #: ../plugins/volumealsa/volumealsa.c:1352
 msgid "default"
-msgstr "Predefinito"
+msgstr "predefinito"
 
 #. desc, index
 #: ../plugins/volumealsa/volumealsa.c:1412
@@ -1080,7 +1115,7 @@ msgstr "Clic per il cursore del volume"
 
 #: ../plugins/volumealsa/volumealsa.c:1446
 msgid "Click for Toggle Mute"
-msgstr "Clic per attivare/disattivare il volume"
+msgstr "Clic per attivare / disattivare il volume"
 
 #: ../plugins/volumealsa/volumealsa.c:1450
 msgid "Click for Open Mixer"
@@ -1516,7 +1551,7 @@ msgstr "Impossibile analizzare /proc/net/dev. Formato sconosciuto."
 #: ../plugins/netstatus/netstatus-sysdeps.c:332
 #, c-format
 msgid "Could not parse interface name from '%s'"
-msgstr "Impossibile analizzare il nome dell'interfaccia da '%s'"
+msgstr "Impossibile analizzare il nome dell'interfaccia da %s"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:218
 #: ../plugins/netstatus/netstatus-sysdeps.c:647
@@ -1525,7 +1560,7 @@ msgid ""
 "Could not parse interface statistics from '%s'. prx_idx = %d; ptx_idx = %d; "
 "brx_idx = %d; btx_idx = %d;"
 msgstr ""
-"Impossibile analizzare le statistiche dell'interfaccia da \"%s\". prx_idx = "
+"Impossibile analizzare le statistiche dell'interfaccia da %s. prx_idx = "
 "%d; ptx_idx = %d; brx_idx = %d; btx_idx = %d;"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:312
@@ -1539,26 +1574,26 @@ msgstr "Impossibile analizzare /proc/net/wireless. Formato sconosciuto."
 #: ../plugins/netstatus/netstatus-sysdeps.c:343
 #, c-format
 msgid "Could not parse wireless details from '%s'. link_idx = %d;"
-msgstr "Impossibile analizzare i dettagli wireless da \"%s\". link_idx = %d;"
+msgstr "Impossibile analizzare i dettagli wireless da %s. link_idx = %d;"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:416
 #, c-format
 msgid "Could not connect to interface, '%s'"
-msgstr "Impossibile connettersi all'interfaccia, \"%s\""
+msgstr "Impossibile connettersi all'interfaccia, %s"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:422
 #, c-format
 msgid "Could not send ioctl to interface, '%s'"
-msgstr "Impossibile inviare ioctl all'interfaccia, \"%s\""
+msgstr "Impossibile inviare ioctl all'interfaccia, %s"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:600
 #, c-format
 msgid "Could not parse command line '%s': %s"
-msgstr "Impossibile analizzare la riga di comando \"%s\": %s"
+msgstr "Impossibile analizzare la riga di comando %s: %s"
 
 #: ../plugins/netstatus/netstatus-sysdeps.c:637
 msgid "Could not parse 'netstat' output. Unknown format"
-msgstr "Impossibile analizzare l'output di \"netstat\". Formato sconosciuto."
+msgstr "Impossibile analizzare l'output di netstat. Formato sconosciuto."
 
 #: ../plugins/netstatus/netstatus-util.c:152
 msgid "Disconnected"
@@ -1796,12 +1831,12 @@ msgstr "Aggiunge applet Indicatore al pannello"
 #: ../plugins/monitors/monitors.c:285
 #, c-format
 msgid "CPU usage: %.2f%%"
-msgstr "Uso CPU: %.2f%%"
+msgstr "Utilizzo CPU: %.2f%%"
 
 #: ../plugins/monitors/monitors.c:386
 #, c-format
 msgid "RAM usage: %.1fMB (%.2f%%)"
-msgstr "Uso RAM: %.1fMB (%.2f%%)"
+msgstr "Utilizzo RAM: %.1fMB (%.2f%%)"
 
 #: ../plugins/monitors/monitors.c:732 ../plugins/monitors/monitors.c:821
 msgid "Resource monitors"
@@ -1813,7 +1848,7 @@ msgstr "Colore CPU"
 
 #: ../plugins/monitors/monitors.c:736
 msgid "Display RAM usage"
-msgstr "Mostra uso RAM"
+msgstr "Mostra utilizzo RAM"
 
 #: ../plugins/monitors/monitors.c:737
 msgid "RAM color"
@@ -1829,7 +1864,7 @@ msgstr "Mostra monitoraggi (CPU, RAM)"
 
 #: ../plugins/weather/weatherwidget.c:52
 msgid "[N/A]"
-msgstr "[N/D]"
+msgstr "[N.D.]"
 
 #: ../plugins/weather/weatherwidget.c:806
 msgid "Enter New Location"
@@ -1911,7 +1946,7 @@ msgstr "_Metriche (C)"
 
 #: ../plugins/weather/weatherwidget.c:1308
 msgid "_English (F)"
-msgstr "Ingl_esi (F)"
+msgstr "Imp_eriali (F)"
 
 #: ../plugins/weather/weatherwidget.c:1343
 msgid "Forecast"
@@ -2036,95 +2071,96 @@ msgstr "Mostra le condizioni meteo per una localit."
 
 #: ../plugins/weather/yahooutil.c:51 ../plugins/weather/openweathermap.c:56
 msgid "N"
-msgstr ""
+msgstr "N"
 
 #: ../plugins/weather/yahooutil.c:52 ../plugins/weather/openweathermap.c:57
 msgid "NNE"
-msgstr ""
+msgstr "NNE"
 
 #: ../plugins/weather/yahooutil.c:53 ../plugins/weather/openweathermap.c:58
 msgid "NE"
-msgstr ""
+msgstr "NE"
 
 #: ../plugins/weather/yahooutil.c:54 ../plugins/weather/openweathermap.c:59
 msgid "ENE"
-msgstr ""
+msgstr "ENE"
 
 #: ../plugins/weather/yahooutil.c:55 ../plugins/weather/openweathermap.c:60
 msgid "E"
-msgstr ""
+msgstr "E"
 
 #: ../plugins/weather/yahooutil.c:56 ../plugins/weather/openweathermap.c:61
 msgid "ESE"
-msgstr ""
+msgstr "ESE"
 
 #: ../plugins/weather/yahooutil.c:57 ../plugins/weather/openweathermap.c:62
 msgid "SE"
-msgstr ""
+msgstr "SE"
 
 #: ../plugins/weather/yahooutil.c:58 ../plugins/weather/openweathermap.c:63
 msgid "SSE"
-msgstr ""
+msgstr "SSE"
 
 #: ../plugins/weather/yahooutil.c:59 ../plugins/weather/openweathermap.c:64
 msgid "S"
-msgstr ""
+msgstr "S"
 
 #: ../plugins/weather/yahooutil.c:60 ../plugins/weather/openweathermap.c:65
 msgid "SSW"
-msgstr ""
+msgstr "SSO"
 
 #: ../plugins/weather/yahooutil.c:61 ../plugins/weather/openweathermap.c:66
 msgid "SW"
-msgstr ""
+msgstr "SO"
 
 #: ../plugins/weather/yahooutil.c:62 ../plugins/weather/openweathermap.c:67
 msgid "WSW"
-msgstr ""
+msgstr "OSO"
 
 #: ../plugins/weather/yahooutil.c:63 ../plugins/weather/openweathermap.c:68
 msgid "W"
-msgstr ""
+msgstr "O"
 
 #: ../plugins/weather/yahooutil.c:64 ../plugins/weather/openweathermap.c:69
 msgid "WNW"
-msgstr ""
+msgstr "ONO"
 
 #: ../plugins/weather/yahooutil.c:65 ../plugins/weather/openweathermap.c:70
 msgid "NW"
-msgstr ""
+msgstr "NO"
 
 #: ../plugins/weather/yahooutil.c:66 ../plugins/weather/openweathermap.c:71
 msgid "NNW"
-msgstr ""
+msgstr "NNO"
 
 #: ../plugins/weather/yahooutil.c:1086
 msgid "Yahoo! Weather"
-msgstr ""
+msgstr "Yahoo! Meteo"
 
 #: ../plugins/weather/openweathermap.c:365
 msgid "Mph"
-msgstr ""
+msgstr "miglia/ora"
 
 #: ../plugins/weather/openweathermap.c:365
 msgid "m/s"
-msgstr ""
+msgstr "m/s"
 
+# visibility in meters
 #: ../plugins/weather/openweathermap.c:535
 msgid "m"
-msgstr ""
+msgstr "m"
 
 #: ../plugins/weather/openweathermap.c:932
 msgid "OpenWeatherMap"
-msgstr ""
+msgstr "OpenWeatherMap"
 
 #~ msgid " --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"
 #~ msgstr ""
 #~ "  --log NUMERO   -- definisce il livello di log 0-5. 0 - nessuno, 5 - "
 #~ "completo\n"
 
-#~ msgid "Format codes: man 3 strftime; \\%n for line break"
-#~ msgstr "Codici formato: man 3 strftime; \\%n per ritorno a capo"
+#~ msgid "Display Image and Tooltip"
+#~ msgstr "Mostra immagine e suggerimento"
 
 #~ msgid "Normal"
 #~ msgstr "Normale"
@@ -2135,25 +2171,6 @@ msgstr ""
 #~ msgid "Warning2"
 #~ msgstr "Avvertimento2"
 
-#~ msgid "Warning1 Temperature"
-#~ msgstr "Temperatura avvertimento1"
-
-#~ msgid "Warning2 Temperature"
-#~ msgstr "Temperatura avvertimento2"
-
-#~ msgid "Copyright (C) 2008-2013"
-#~ msgstr "Copyright  2008-2013"
-
-#~ msgid "Display Image and Tooltip"
-#~ msgstr "Mostra immagine e suggerimento"
-
-#~ msgid ""
-#~ "Error, you need to install an application to configure the sound "
-#~ "(pavucontol, alsamixer ...)"
-#~ msgstr ""
-#~ "Errore:  necessario installare un'applicazione per configurare il suono "
-#~ "(pavucontol, alsamixer, ...)"
-
 #~ msgid "Failed to launch time configuration tool: %s"
 #~ msgstr ""
 #~ "Lancio dello strumento di configurazione della data non riuscito: %s"
@@ -2181,114 +2198,3 @@ msgstr ""
 
 #~ msgid "Default layout:"
 #~ msgstr "Layout predefinito:"
-
-#~ msgid "Available Applications"
-#~ msgstr "Applicazioni Disponibili"
-
-#~ msgid "Display system temperature, by kesler.daniel@gmail.com"
-#~ msgstr "Mostra temperatura di sistema, by kesler.daniel@gmail.com"
-
-#~ msgid "Left\t"
-#~ msgstr "Sinistra\t"
-
-#~ msgid "Top\t"
-#~ msgstr "Superiore\t"
-
-#~ msgid "Couldn't find pixmap file: %s"
-#~ msgstr "Impossibile trovare file pixmap: %s"
-
-#~ msgid "Desktop No / Workspace Name"
-#~ msgstr "Numero scrivania / area di lavoro"
-
-#~ msgid ""
-#~ "Allows you to switch the keyboard layout and\n"
-#~ "displays the currently selected layout."
-#~ msgstr ""
-#~ "Permette di cambiare il layout della tastiera\n"
-#~ "e mostra il layout attuale."
-
-#~ msgid "Other plugins available here"
-#~ msgstr "Altri plugin disponibili qui"
-
-#~ msgid "Old KDE/GNOME Tray"
-#~ msgstr "Pannello KDE/GNOME vecchio"
-
-#~ msgid "Enable Image:"
-#~ msgstr "Attiva immagine:"
-
-#~ msgid "Enable Transparency"
-#~ msgstr "Attiva trasparenza"
-
-#~ msgid " --configure -- launch configuration utility\n"
-#~ msgstr " --configure -- avvia il programma di configurazione\n"
-
-#~ msgid " -C  -- same as --configure\n"
-#~ msgstr " -C  -- analogo a --configure\n"
-
-#~ msgid "Add Button"
-#~ msgstr "Aggiungi bottone"
-
-#~ msgid "Button Properties"
-#~ msgstr "Propriet bottone"
-
-#~ msgid "Remove Button"
-#~ msgstr "Eliminare bottone"
-
-#~ msgid "Buttons"
-#~ msgstr "Bottoni"
-
-#~ msgid "Accept SkipPager"
-#~ msgstr "Accetta SkipPager"
-
-#~ msgid "Show Iconified windows"
-#~ msgstr "Mostra finestre minimizzate"
-
-#~ msgid "Show mapped windows"
-#~ msgstr "Mostra finestre arrotolate"
-
-#~ msgid "Kayboard Layout switcher"
-#~ msgstr "Cambio Layout Tastiera"
-
-#~ msgid ""
-#~ "Dynamic\n"
-#~ "Pixels\n"
-#~ "% Percent"
-#~ msgstr ""
-#~ "Dinamico\n"
-#~ "Pixel\n"
-#~ "% Percento"
-
-#~ msgid ""
-#~ "Left\n"
-#~ "Center\n"
-#~ "Right"
-#~ msgstr ""
-#~ "Sinistra\n"
-#~ "Centro\n"
-#~ "Destra"
-
-#~ msgid ""
-#~ "Left\n"
-#~ "Right\n"
-#~ "Top\n"
-#~ "Bottom"
-#~ msgstr ""
-#~ "Sinistra\n"
-#~ "Destra\n"
-#~ "Sopra\n"
-#~ "Sotto"
-
-#~ msgid "Where to put the panel?"
-#~ msgstr "Dove devo piazzare il pannello?"
-
-#~ msgid "Battery: %d%% charged, %s"
-#~ msgstr "Batteria: %d%% caricata, %s"
-
-#~ msgid "charging finished"
-#~ msgstr "carica completata"
-
-#~ msgid "charging"
-#~ msgstr "in caricamento"
-
-#~ msgid "Add to desktop panel"
-#~ msgstr "Aggiungere al pannello scrivania"
diff --git a/po/sk.po b/po/sk.po
index 99aa45a..68fb3a0 100644
--- a/po/sk.po
+++ b/po/sk.po
@@ -7,8 +7,8 @@ msgid ""
 msgstr ""
 "Project-Id-Version: lxpanel\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2019-03-01 01:38+0200\n"
-"PO-Revision-Date: 2020-12-12 22:51+0100\n"
+"POT-Creation-Date: 2020-12-21 01:33+0100\n"
+"PO-Revision-Date: 2020-12-21 01:36+0100\n"
 "Last-Translator: Jose Riha <jose1711@gmail.com>\n"
 "Language-Team: Slovak <sk-i18n@lists.linux.sk>\n"
 "Language: sk_SK\n"
@@ -50,24 +50,24 @@ msgstr "Dostupn moduly"
 msgid "Logout command is not set"
 msgstr "Prkaz na odhlsenie nie je nastaven"
 
-#: ../src/configurator.c:1495
+#: ../src/configurator.c:1519
 msgid "Select a directory"
 msgstr "Vyberte adresr"
 
-#: ../src/configurator.c:1495 ../src/configurator.c:1607
+#: ../src/configurator.c:1519 ../src/configurator.c:1633
 msgid "Select a file"
 msgstr "Vyberte sbor"
 
-#: ../src/configurator.c:1640
+#: ../src/configurator.c:1692
 msgid "_Browse"
 msgstr "_Prechdza"
 
-#: ../src/panel.c:1292
+#: ../src/panel.c:1403
 msgid "There is no room for another panel. All the edges are taken."
 msgstr ""
 "Na vytvorenie novho panela u nie je miesto. Vetky okraje s u obsaden."
 
-#: ../src/panel.c:1318
+#: ../src/panel.c:1429
 msgid ""
 "Really delete this panel?\n"
 "<b>Warning: This can not be recovered.</b>"
@@ -75,94 +75,94 @@ msgstr ""
 "Skutone chcete zmaza tento panel?\n"
 "<b>Upozornenie: Tto operciu nemono vrti.</b>"
 
-#: ../src/panel.c:1320
+#: ../src/panel.c:1431
 msgid "Confirm"
 msgstr "Potvrdi"
 
 #. TRANSLATORS: Replace this string with your names, one name per line.
-#: ../src/panel.c:1355
+#: ../src/panel.c:1466
 msgid "translator-credits"
 msgstr ""
 "Ivan Masr <helix84@centrum.sk>, 2007, 2009.\n"
 "Miroslav Bias <mirek@cnl.sk>, 2018, 2019.\n"
 "Jose Riha <jose1711@gmail.com>, 2020."
 
-#: ../src/panel.c:1360
+#: ../src/panel.c:1471
 msgid "LXPanel"
 msgstr "LXPanel"
 
-#: ../src/panel.c:1378
-msgid "Copyright (C) 2008-2021"
-msgstr "Copyright (C) 2008-2021"
+#: ../src/panel.c:1489
+msgid "Copyright (C) 2008-2019"
+msgstr "Copyright (C) 2008-2019"
 
-#: ../src/panel.c:1379
+#: ../src/panel.c:1490
 msgid "Desktop panel for LXDE project"
 msgstr "Panel plochy projektu LXDE"
 
-#: ../src/panel.c:1421
+#: ../src/panel.c:1532
 #, c-format
-msgid "\"%s\" Settings"
+msgid "%s Settings"
 msgstr "Nastavenia %s"
 
-#: ../src/panel.c:1442
+#: ../src/panel.c:1553
 msgid "Add / Remove Panel Items"
 msgstr "Prida / odstrni poloky panela"
 
-#: ../src/panel.c:1450
+#: ../src/panel.c:1561
 #, c-format
 msgid "Remove \"%s\" From Panel"
 msgstr "Odstrni %s z panela"
 
-#: ../src/panel.c:1462
+#: ../src/panel.c:1573
 msgid "Panel Settings"
 msgstr "Nastavenia panela"
 
-#: ../src/panel.c:1468
+#: ../src/panel.c:1579
 msgid "Create New Panel"
 msgstr "Vytvori nov panel"
 
-#: ../src/panel.c:1474
+#: ../src/panel.c:1585
 msgid "Delete This Panel"
 msgstr "Zmaza tento panel"
 
-#: ../src/panel.c:1485
+#: ../src/panel.c:1596
 msgid "About"
 msgstr "O aplikcii"
 
-#: ../src/panel.c:1492
+#: ../src/panel.c:1603
 msgid "Panel"
 msgstr "Panel"
 
-#: ../src/panel.c:1710 ../src/panel.c:1718 ../data/ui/panel-pref.glade.h:22
+#: ../src/panel.c:1821 ../src/panel.c:1829 ../data/ui/panel-pref.glade.h:22
 msgid "Height:"
 msgstr "Vka:"
 
-#: ../src/panel.c:1711 ../src/panel.c:1717 ../data/ui/panel-pref.glade.h:21
+#: ../src/panel.c:1822 ../src/panel.c:1828 ../data/ui/panel-pref.glade.h:21
 msgid "Width:"
 msgstr "rka:"
 
-#: ../src/panel.c:1712 ../data/ui/panel-pref.glade.h:13
+#: ../src/panel.c:1823 ../data/ui/panel-pref.glade.h:13
 msgid "Left"
 msgstr "Vavo"
 
-#: ../src/panel.c:1713 ../data/ui/panel-pref.glade.h:14
+#: ../src/panel.c:1824 ../data/ui/panel-pref.glade.h:14
 msgid "Right"
 msgstr "Vpravo"
 
-#: ../src/panel.c:1719 ../data/ui/panel-pref.glade.h:12
+#: ../src/panel.c:1830 ../data/ui/panel-pref.glade.h:12
 msgid "Top"
 msgstr "Hore"
 
-#: ../src/panel.c:1720 ../data/ui/panel-pref.glade.h:11
+#: ../src/panel.c:1831 ../data/ui/panel-pref.glade.h:11
 msgid "Bottom"
 msgstr "Dolu"
 
-#: ../src/plugin.c:348
+#: ../src/plugin.c:353
 msgid "No file manager is configured."
 msgstr "Nie je nakonfigurovan iadny sprvca sborov."
 
 #. { "configure", N_("Preferences"), configure },
-#: ../src/gtk-run.c:385 ../src/main.c:69 ../plugins/menu.c:718
+#: ../src/gtk-run.c:385 ../src/main.c:70 ../plugins/menu.c:733
 msgid "Run"
 msgstr "Spusti"
 
@@ -170,58 +170,58 @@ msgstr "Spusti"
 msgid "Enter the command you want to execute:"
 msgstr "Zadajte prkaz, ktor chcete vykona:"
 
-#: ../src/main.c:70 ../plugins/menu.c:719
+#: ../src/main.c:71 ../plugins/menu.c:734
 msgid "Restart"
 msgstr "Retartova"
 
-#: ../src/main.c:71 ../plugins/menu.c:720
+#: ../src/main.c:72 ../plugins/menu.c:735
 msgid "Logout"
 msgstr "Odhlsi"
 
-#: ../src/main.c:323
+#: ../src/main.c:505
 #, c-format
-msgid "lxpanel %s - lightweight GTK+ panel for UNIX desktops\n"
-msgstr "lxpanel %s - odahen GTK+ panel pre unixov pracovn prostredia\n"
+msgid "lxpanel %s - lightweight GTK2+ panel for UNIX desktops\n"
+msgstr "lxpanel %s - odahen GTK2+ panel pre unixov pracovn prostredia\n"
 
-#: ../src/main.c:324
+#: ../src/main.c:506
 #, c-format
 msgid "Command line options:\n"
 msgstr "Voby prkazovho riadka:\n"
 
-#: ../src/main.c:325
+#: ../src/main.c:507
 #, c-format
 msgid " --help      -- print this help and exit\n"
 msgstr " --help      -- vypsa tohto pomocnka a skoni\n"
 
-#: ../src/main.c:326
+#: ../src/main.c:508
 #, c-format
 msgid " --version   -- print version and exit\n"
 msgstr " --version   -- vypsa verziu a skoni\n"
 
 #. g_print(_(" --log <number> -- set log level 0-5. 0 - none 5 - chatty\n"));
 #. g_print(_(" --configure -- launch configuration utility\n"));
-#: ../src/main.c:329
+#: ../src/main.c:511
 #, c-format
 msgid " --profile name -- use specified profile\n"
 msgstr " --profile meno -- poui uveden profil\n"
 
-#: ../src/main.c:331
+#: ../src/main.c:513
 #, c-format
 msgid " -h  -- same as --help\n"
 msgstr " -h  -- ekvivalent --help\n"
 
-#: ../src/main.c:332
+#: ../src/main.c:514
 #, c-format
 msgid " -p  -- same as --profile\n"
 msgstr " -p  -- ekvivalent --profile\n"
 
-#: ../src/main.c:333
+#: ../src/main.c:515
 #, c-format
 msgid " -v  -- same as --version\n"
 msgstr " -v  -- ekvivalent --version\n"
 
 #. g_print(_(" -C  -- same as --configure\n"));
-#: ../src/main.c:335
+#: ../src/main.c:517
 #, c-format
 msgid ""
 "\n"
@@ -290,7 +290,7 @@ msgstr "Vekos"
 msgid "Allocate space"
 msgstr "Vyhradi miesto"
 
-#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2482
+#: ../data/ui/launchtaskbar.glade.h:1 ../plugins/launchtaskbar.c:2507
 msgid "Application Launch and Task Bar"
 msgstr "Panel loh a spanie aplikci"
 
@@ -614,11 +614,27 @@ msgstr "<b>rove logovania</b>"
 msgid "Advanced"
 msgstr "Pokroil"
 
-#: ../plugins/cpu/cpu.c:310
+#: ../plugins/cpu/cpu.c:369
+msgid "CPU Usage"
+msgstr "Monitor vyuitia CPU"
+
+#: ../plugins/cpu/cpu.c:371
+msgid "Show usage as percentage"
+msgstr "Zobrazi vyuitie v percentch"
+
+#: ../plugins/cpu/cpu.c:372
+msgid "Foreground colour"
+msgstr "Farba popredia"
+
+#: ../plugins/cpu/cpu.c:373
+msgid "Background colour"
+msgstr "Farba pozadia"
+
+#: ../plugins/cpu/cpu.c:381
 msgid "CPU Usage Monitor"
 msgstr "Monitor vyuitia CPU"
 
-#: ../plugins/cpu/cpu.c:311 ../plugins/monitors/monitors.c:734
+#: ../plugins/cpu/cpu.c:383 ../plugins/monitors/monitors.c:734
 msgid "Display CPU usage"
 msgstr "Zobrazi vyuitie CPU"
 
@@ -626,7 +642,7 @@ msgstr "Zobrazi vyuitie CPU"
 msgid "Desktop Number / Workspace Name"
 msgstr "slo plochy / Nzov plochy"
 
-#: ../plugins/deskno/deskno.c:212 ../plugins/dclock.c:439
+#: ../plugins/deskno/deskno.c:212
 msgid "Bold font"
 msgstr "Hrub psmo"
 
@@ -638,143 +654,161 @@ msgstr "Zobrazi nzvy plch"
 msgid "Display workspace number, by cmeury@users.sf.net"
 msgstr "Zobrazenie sla plochy, cmeury@users.sf.net"
 
-#: ../plugins/launchtaskbar.c:1831 ../plugins/launchtaskbar.c:2452
+#: ../plugins/launchtaskbar.c:1835 ../plugins/launchtaskbar.c:2477
 msgid "Application Launch Bar"
 msgstr "Spac panel"
 
-#: ../plugins/launchtaskbar.c:1834 ../plugins/launchtaskbar.c:2462
+#: ../plugins/launchtaskbar.c:1838 ../plugins/launchtaskbar.c:2487
 msgid "Task Bar (Window List)"
 msgstr "Panel loh (Zoznam okien)"
 
-#: ../plugins/launchtaskbar.c:1985
+#: ../plugins/launchtaskbar.c:2010
 msgid "A_dd to Launcher"
 msgstr "Pri_da do spaa"
 
-#: ../plugins/launchtaskbar.c:1987
+#: ../plugins/launchtaskbar.c:2012
 msgid "Rem_ove from Launcher"
 msgstr "_Odstrni zo spaa"
 
-#: ../plugins/launchtaskbar.c:1989
+#: ../plugins/launchtaskbar.c:2014
 msgid "_New Instance"
 msgstr "_Nov intancia"
 
-#: ../plugins/launchtaskbar.c:2453
+#: ../plugins/launchtaskbar.c:2478
 msgid "Bar with buttons to launch application"
 msgstr "Panel s tlaidlami pre spanie aplikci"
 
-#: ../plugins/launchtaskbar.c:2463
+#: ../plugins/launchtaskbar.c:2488
 msgid ""
-"Taskbar shows all opened windows and allows to iconify them, shade or get "
+"Taskbar shows all opened windows and allow to iconify them, shade or get "
 "focus"
 msgstr ""
 "Panel loh zobrazuje vetky otvoren okn a umouje ich ikonifikova, "
 "zatieni alebo aktivova"
 
-#: ../plugins/launchtaskbar.c:2483
+#: ../plugins/launchtaskbar.c:2508
 msgid "Bar with buttons to launch application and/or show all opened windows"
 msgstr ""
-"Panel s tlaidlami pre spanie aplikci a/alebo zobrazenie vetkch otvorench "
-"okien"
+"Panel s tlaidlami pre spanie aplikci a/alebo zobrazenie vetkch "
+"otvorench okien"
 
 #. Add Raise menu item.
-#: ../plugins/task-button.c:352
+#: ../plugins/task-button.c:351
 msgid "_Raise"
 msgstr "_Zdvihn"
 
 #. Add Restore menu item.
-#: ../plugins/task-button.c:357
+#: ../plugins/task-button.c:356
 msgid "R_estore"
 msgstr "_Obnovi"
 
 #. Add Maximize menu item.
-#: ../plugins/task-button.c:362
+#: ../plugins/task-button.c:361
 msgid "Ma_ximize"
 msgstr "Ma_ximalizova"
 
 #. Add Iconify menu item.
-#: ../plugins/task-button.c:367
+#: ../plugins/task-button.c:366
 msgid "Ico_nify"
 msgstr "Iko_nifikova"
 
-#: ../plugins/task-button.c:388
+#: ../plugins/task-button.c:387
 #, c-format
 msgid "Workspace _%d"
 msgstr "Pracovn plocha _%d"
 
-#: ../plugins/task-button.c:393
+#: ../plugins/task-button.c:392
 #, c-format
 msgid "Workspace %d"
 msgstr "Pracovn plocha %d"
 
 #. Add "move to all workspaces" item.  This causes the window to be visible no matter what desktop is active.
-#: ../plugins/task-button.c:410
+#: ../plugins/task-button.c:409
 msgid "_All workspaces"
 msgstr "Vetky pr_acovn plochy"
 
 #. FIXME: add "Current workspace" item, active if not on a current
 #. Add Move to Workspace menu item as a submenu.
-#: ../plugins/task-button.c:418
+#: ../plugins/task-button.c:417
 msgid "_Move to Workspace"
 msgstr "_Presun na plochu"
 
-#: ../plugins/task-button.c:433
+#: ../plugins/task-button.c:432
 msgid "_Close Window"
 msgstr "_Zatvori okno"
 
-#: ../plugins/task-button.c:1256
+#: ../plugins/task-button.c:1258
 msgid "_Close all windows"
 msgstr "_Zatvori vetky okn"
 
-#: ../plugins/dclock.c:433 ../plugins/dclock.c:453
+#: ../plugins/dclock.c:551 ../plugins/dclock.c:574
 msgid "Digital Clock"
 msgstr "Digitlne hodiny"
 
-#: ../plugins/dclock.c:435
+#: ../plugins/dclock.c:553
 msgid "Clock Format"
 msgstr "Formt hodn"
 
-#: ../plugins/dclock.c:436
+#: ../plugins/dclock.c:554
 msgid "Tooltip Format"
 msgstr "Formt bublinovch tipov"
 
-#: ../plugins/dclock.c:437
+#: ../plugins/dclock.c:555
 #, c-format
 msgid "Format codes: man 3 strftime; %n for line break"
 msgstr "Formtovacie kdy: man 3 strftime; %n pre zalomenie riadka"
 
-#: ../plugins/dclock.c:438
+#: ../plugins/dclock.c:556
 msgid "Action when clicked (default: display calendar)"
 msgstr "Opercia po kliknut (predvolen: zobrazi kalendr)"
 
-#: ../plugins/dclock.c:440
+#. _("Bold font"), &dc->bold, CONF_TYPE_BOOL,
+#: ../plugins/dclock.c:558
 msgid "Tooltip only"
 msgstr "Iba bublinov tipy"
 
-#: ../plugins/dclock.c:441
+#. _("Center text"), &dc->center_text, CONF_TYPE_BOOL,
+#: ../plugins/dclock.c:560
+msgid "Left align"
+msgstr "Zarovna doava"
+
+#: ../plugins/dclock.c:561
 msgid "Center text"
 msgstr "Zarovna text na stred"
 
-#: ../plugins/dclock.c:454
+#: ../plugins/dclock.c:562
+msgid "Right align"
+msgstr "Zarovna doprava"
+
+#: ../plugins/dclock.c:575
 msgid "Display digital clock and tooltip"
 msgstr "Zobrazi digitlne hodiny a bublinov tipy"
 
-#: ../plugins/menu.c:360
+#: ../plugins/menu.c:363
 msgid "Add to desktop"
 msgstr "Prida na plochu"
 
-#: ../plugins/menu.c:367
+#: ../plugins/menu.c:370
 msgid "Properties"
 msgstr "Vlastnosti"
 
-#: ../plugins/menu.c:989 ../plugins/menu.c:997
+#: ../plugins/menu.c:717
+msgid "Click here to open applications menu"
+msgstr "Kliknite sem pre ponuky programov"
+
+#: ../plugins/menu.c:1032 ../plugins/menu.c:1054
 msgid "Menu"
 msgstr "Ponuka"
 
-#: ../plugins/menu.c:990 ../plugins/dirmenu.c:359
+#: ../plugins/menu.c:1033 ../plugins/dirmenu.c:359
 msgid "Icon"
 msgstr "Ikona"
 
-#: ../plugins/menu.c:998
+#: ../plugins/menu.c:1034
+msgid "Padding"
+msgstr "Vpl"
+
+#: ../plugins/menu.c:1055
 msgid "Application Menu"
 msgstr "Aplikan menu"
 
@@ -1001,7 +1035,7 @@ msgid "CPUFreq frontend"
 msgstr "Pouvatesk rozhranie pre CPUFreq"
 
 #: ../plugins/cpufreq/cpufreq.c:402
-msgid "Display CPU frequency and allow one to change governors and frequency"
+msgid "Display CPU frequency and allow to change governors and frequency"
 msgstr "Zobrazi frekvenciu CPU a povoli zmenu regultorov a frekvencie"
 
 #: ../plugins/volumealsa/volumealsa.c:245
@@ -2025,7 +2059,7 @@ msgstr "Dnes: "
 
 #: ../plugins/weather/weatherwidget.c:2293
 msgid "Tomorrow: "
-msgstr "Zajtra:"
+msgstr "Zajtra: "
 
 #: ../plugins/weather/weather.c:415
 msgid "Weather Plugin"
diff --git a/src/Makefile.am b/src/Makefile.am
index 2e9a266..f193d25 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -52,8 +52,12 @@ lxpanel_include_HEADERS = \
 	icon-grid.h \
 	conf.h
 
+if GTK2_ONLY
+GTK2_ONLY_SOURCES =	icon-grid-old.c
+endif
+
 lxpanel_SOURCES = \
-	icon-grid-old.c \
+	$(GTK2_ONLY_SOURCES) \
 	bg.c \
 	gtk-run.c \
 	main.c \
diff --git a/src/configurator.c b/src/configurator.c
index 5f93dcf..c60ca93 100644
--- a/src/configurator.c
+++ b/src/configurator.c
@@ -325,13 +325,23 @@ static void set_width_type( GtkWidget *item, LXPanel* panel )
     case WIDTH_PIXEL:
         if ((p->edge == EDGE_TOP) || (p->edge == EDGE_BOTTOM))
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_spin_button_set_range( GTK_SPIN_BUTTON(spin), 0, screen_width (NULL) );
+            gtk_spin_button_set_value( GTK_SPIN_BUTTON(spin), screen_width (NULL) );
+#else
             gtk_spin_button_set_range( GTK_SPIN_BUTTON(spin), 0, gdk_screen_width() );
             gtk_spin_button_set_value( GTK_SPIN_BUTTON(spin), gdk_screen_width() );
+#endif
         }
         else
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_spin_button_set_range( GTK_SPIN_BUTTON(spin), 0, screen_height (NULL) );
+            gtk_spin_button_set_value( GTK_SPIN_BUTTON(spin), screen_height (NULL) );
+#else
             gtk_spin_button_set_range( GTK_SPIN_BUTTON(spin), 0, gdk_screen_height() );
             gtk_spin_button_set_value( GTK_SPIN_BUTTON(spin), gdk_screen_height() );
+#endif
         }
         break;
     case WIDTH_REQUEST:
@@ -424,11 +434,19 @@ background_disable_toggle( GtkWidget *b, Panel* p )
 }
 
 static void
+#if GTK_CHECK_VERSION(3, 0, 0)
+on_font_color_set(GtkColorChooser* clr, LXPanel* panel)
+#else
 on_font_color_set(GtkColorButton* clr, LXPanel* panel)
+#endif
 {
     Panel *p = panel->priv;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_color_chooser_get_rgba( clr, &p->gfontcolor );
+#else
     gtk_color_button_get_color( clr, &p->gfontcolor );
+#endif
     panel_set_panel_configuration_changed(p);
     p->fontcolor = gcolor2rgb24(&p->gfontcolor);
     UPDATE_GLOBAL_COLOR(p, "fontcolor", p->fontcolor);
@@ -436,11 +454,23 @@ on_font_color_set(GtkColorButton* clr, LXPanel* panel)
 }
 
 static void
+#if GTK_CHECK_VERSION(3, 0, 0)
+on_tint_color_set( GtkColorChooser* clr,  Panel* p )
+#else
 on_tint_color_set( GtkColorButton* clr,  Panel* p )
+#endif
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_color_chooser_get_rgba( clr, &p->gtintcolor );
+#else
     gtk_color_button_get_color( clr, &p->gtintcolor );
+#endif
     p->tintcolor = gcolor2rgb24(&p->gtintcolor);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    p->alpha = (int) (p->gtintcolor.alpha * 256.0);
+#else
     p->alpha = gtk_color_button_get_alpha( clr ) / alpha_scale_factor;
+#endif
     panel_update_background( p );
     UPDATE_GLOBAL_COLOR(p, "tintcolor", p->tintcolor);
     UPDATE_GLOBAL_INT(p, "alpha", p->alpha);
@@ -777,16 +807,25 @@ static void on_add_plugin( GtkButton* btn, GtkTreeView* _view )
 
     parent_win = gtk_widget_get_toplevel( GTK_WIDGET(_view) );
     dlg = gtk_dialog_new_with_buttons( _("Add plugin to panel"),
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                       GTK_WINDOW(parent_win), 0,
+                                       _("_Cancel"),
+                                       GTK_RESPONSE_CANCEL,
+                                       _("_Add"),
+#else
                                        GTK_WINDOW(parent_win), 0,
                                        GTK_STOCK_CANCEL,
                                        GTK_RESPONSE_CANCEL,
                                        GTK_STOCK_ADD,
+#endif
                                        GTK_RESPONSE_OK, NULL );
     panel_apply_icon(GTK_WINDOW(dlg));
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
     /* fix background */
     if (p->priv->background)
         gtk_widget_set_style(dlg, p->priv->defstyle);
+#endif
 
     /* gtk_widget_set_sensitive( parent_win, FALSE ); */
     scroll = gtk_scrolled_window_new( NULL, NULL );
@@ -1081,7 +1120,11 @@ void panel_configure( LXPanel* panel, int sel_page )
     GtkWidget *w, *w2, *tint_clr;
     FmMimeType *mt;
     GtkComboBox *fm;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkDisplay *display;
+#else
     GdkScreen *screen;
+#endif
     gint monitors;
 
     if( p->pref_dialog )
@@ -1125,8 +1168,13 @@ void panel_configure( LXPanel* panel, int sel_page )
 
     /* monitor */
     monitors = 1;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    display = gtk_widget_get_display(GTK_WIDGET(panel));
+    if (display) monitors = gdk_display_get_n_monitors(display);
+#else
     screen = gtk_widget_get_screen(GTK_WIDGET(panel));
     if(screen) monitors = gdk_screen_get_n_monitors(screen);
+#endif
     g_assert(monitors >= 1);
     w = (GtkWidget*)gtk_builder_get_object( builder, "monitor" );
     if (GTK_IS_SPIN_BUTTON(w))
@@ -1197,7 +1245,11 @@ void panel_configure( LXPanel* panel, int sel_page )
     if( p->widthtype == WIDTH_PERCENT)
         upper = 100;
     else if( p->widthtype == WIDTH_PIXEL)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        upper = (((p->edge == EDGE_TOP) || (p->edge == EDGE_BOTTOM)) ? screen_width (NULL) : screen_height (NULL));
+#else
         upper = (((p->edge == EDGE_TOP) || (p->edge == EDGE_BOTTOM)) ? gdk_screen_width() : gdk_screen_height());
+#endif
     gtk_spin_button_set_range( GTK_SPIN_BUTTON(w), 0, upper );
     gtk_spin_button_set_value( GTK_SPIN_BUTTON(w), p->width );
     g_signal_connect( w, "value-changed", G_CALLBACK(set_width), panel );
@@ -1263,8 +1315,13 @@ void panel_configure( LXPanel* panel, int sel_page )
 
     /* transparancy */
     tint_clr = w = (GtkWidget*)gtk_builder_get_object( builder, "tint_clr" );
+#if GTK_CHECK_VERSION(3, 0, 0)
+    p->gtintcolor.alpha = ((double) p->alpha) / 256.0;
+    gtk_color_chooser_set_rgba(GTK_COLOR_CHOOSER(w), &p->gtintcolor);
+#else
     gtk_color_button_set_color(GTK_COLOR_BUTTON(w), &p->gtintcolor);
     gtk_color_button_set_alpha(GTK_COLOR_BUTTON(w), alpha_scale_factor * p->alpha);
+#endif
     if ( ! p->transparent )
         gtk_widget_set_sensitive( w, FALSE );
     g_signal_connect( w, "color-set", G_CALLBACK( on_tint_color_set ), p );
@@ -1297,7 +1354,11 @@ void panel_configure( LXPanel* panel, int sel_page )
         else if ((info = gtk_icon_theme_lookup_icon(p->icon_theme, "lxpanel-background", 0, 0)))
         {
             gtk_file_chooser_set_filename(GTK_FILE_CHOOSER(w), gtk_icon_info_get_filename(info));
+#if GTK_CHECK_VERSION(3, 0, 0)
+            g_object_unref (info);
+#else
             gtk_icon_info_free(info);
+#endif
         }
 
         if (!p->background)
@@ -1308,7 +1369,11 @@ void panel_configure( LXPanel* panel, int sel_page )
 
     /* font color */
     w = (GtkWidget*)gtk_builder_get_object( builder, "font_clr" );
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_color_chooser_set_rgba( GTK_COLOR_CHOOSER(w), &p->gfontcolor );
+#else
     gtk_color_button_set_color( GTK_COLOR_BUTTON(w), &p->gfontcolor );
+#endif
     g_signal_connect(w, "color-set", G_CALLBACK( on_font_color_set ), panel);
 
     w2 = (GtkWidget*)gtk_builder_get_object( builder, "use_font_clr" );
@@ -1479,6 +1544,24 @@ static void on_toggle_changed( GtkToggleButton* btn, gpointer user_data )
     notify_apply_config( GTK_WIDGET(btn) );
 }
 
+static void on_radio_changed( GtkRadioButton* btn, gpointer user_data )
+{
+    gboolean* val = (gboolean*)user_data;
+
+    GSList *group = gtk_radio_button_get_group (btn);
+    GtkRadioButton *tbtn;
+    int nbtn = 0, sbtn;
+    while (group)
+    {
+        tbtn = group->data;
+        group = group->next;
+        if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (tbtn))) sbtn = nbtn;
+        nbtn++;
+    }
+    *val = nbtn - sbtn - 1;
+    notify_apply_config( GTK_WIDGET(btn) );
+}
+
 static void on_file_chooser_btn_file_set(GtkFileChooser* btn, char** val)
 {
     g_free( *val );
@@ -1486,6 +1569,20 @@ static void on_file_chooser_btn_file_set(GtkFileChooser* btn, char** val)
     notify_apply_config( GTK_WIDGET(btn) );
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+static void on_color_button_set(GtkColorChooser* btn, char** val)
+{
+    gtk_color_chooser_get_rgba (btn, (GdkRGBA *) val);
+    notify_apply_config( GTK_WIDGET(btn) );
+}
+#else
+static void on_color_button_set(GtkColorButton* btn, char** val)
+{
+    gtk_color_button_get_color (btn, (GdkColor *) val);
+    notify_apply_config( GTK_WIDGET(btn) );
+}
+#endif
+
 static void on_browse_btn_clicked(GtkButton* btn, GtkEntry* entry)
 {
     char* file;
@@ -1495,10 +1592,17 @@ static void on_browse_btn_clicked(GtkButton* btn, GtkEntry* entry)
                                         (action == GTK_FILE_CHOOSER_ACTION_SELECT_FOLDER) ? _("Select a directory") : _("Select a file"),
                                         GTK_WINDOW(dlg),
                                         action,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                        _("_Cancel"), GTK_RESPONSE_CANCEL,
+                                        _("_OK"), GTK_RESPONSE_OK,
+#else
                                         GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                                         GTK_STOCK_OK, GTK_RESPONSE_OK,
+#endif
                                         NULL);
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_dialog_set_alternative_button_order(GTK_DIALOG(fc), GTK_RESPONSE_OK, GTK_RESPONSE_CANCEL, -1);
+#endif
     file = (char*)gtk_entry_get_text(entry);
     if( file && *file )
         gtk_file_chooser_set_filename(GTK_FILE_CHOOSER(fc), file );
@@ -1521,6 +1625,8 @@ static void on_plugin_destroy(GtkWidget *plugin, GtkDialog *dlg)
 /* Handler for "response" signal from standard configuration dialog. */
 static void generic_config_dlg_response(GtkWidget * dlg, int response, Panel * panel)
 {
+    if (response == GTK_RESPONSE_CLOSE)
+    {
     gpointer plugin = g_object_get_data(G_OBJECT(dlg), "generic-config-plugin");
     if (plugin)
         g_signal_handlers_disconnect_by_func(plugin, on_plugin_destroy, dlg);
@@ -1528,6 +1634,7 @@ static void generic_config_dlg_response(GtkWidget * dlg, int response, Panel * p
     panel->plugin_pref_dialog = NULL;
     gtk_widget_destroy(dlg);
     panel_config_save(panel);
+    }
 }
 
 void _panel_show_config_dialog(LXPanel *panel, GtkWidget *p, GtkWidget *dlg)
@@ -1545,10 +1652,6 @@ void _panel_show_config_dialog(LXPanel *panel, GtkWidget *p, GtkWidget *dlg)
     g_signal_connect(p, "destroy", G_CALLBACK(on_plugin_destroy), dlg);
     g_object_set_data(G_OBJECT(dlg), "generic-config-plugin", p);
 
-    /* adjust config dialog window position to be near plugin */
-    lxpanel_plugin_popup_set_position_helper(panel, p, dlg, &x, &y);
-    gtk_window_move(GTK_WINDOW(dlg), x, y);
-
     gtk_window_present(GTK_WINDOW(dlg));
 }
 
@@ -1559,7 +1662,11 @@ static GtkWidget *_lxpanel_generic_config_dlg(const char *title, Panel *p,
                                               const char *name, va_list args)
 {
     GtkWidget* dlg = gtk_dialog_new_with_buttons( title, NULL, 0,
-                                                  GTK_STOCK_CLOSE,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                                  _("_OK"),
+#else
+                                                  GTK_STOCK_OK,
+#endif
                                                   GTK_RESPONSE_CLOSE,
                                                   NULL );
     GtkBox *dlg_vbox = GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dlg)));
@@ -1572,11 +1679,14 @@ static GtkWidget *_lxpanel_generic_config_dlg(const char *title, Panel *p,
 
     gtk_box_set_spacing( dlg_vbox, 4 );
 
+    int rb_group = 0;
+    GtkWidget *lastbtn;
     while( name )
     {
         GtkWidget* entry = NULL;
         gpointer val = va_arg( args, gpointer );
         PluginConfType type = va_arg( args, PluginConfType );
+        if (rb_group && type != CONF_TYPE_RBUTTON) rb_group = 0;
         if (type != CONF_TYPE_TRIM && val == NULL)
             g_critical("NULL pointer for generic config dialog");
         else switch( type )
@@ -1624,14 +1734,54 @@ static GtkWidget *_lxpanel_generic_config_dlg(const char *title, Panel *p,
                 else
                     g_critical("value for CONF_TYPE_EXTERNAL is not a GtkWidget");
                 break;
+            case CONF_TYPE_COLOR:
+                {
+                entry = gtk_color_button_new();
+#if GTK_CHECK_VERSION(3, 0, 0)
+                gtk_color_chooser_set_rgba (GTK_COLOR_CHOOSER (entry), val);
+#else
+                gtk_color_button_set_color (GTK_COLOR_BUTTON (entry), val);
+#endif
+                g_signal_connect (entry, "color-set", G_CALLBACK (on_color_button_set), val);
+                }
+                break;
+            case CONF_TYPE_RBUTTON:
+                if (!rb_group)
+                {
+                    entry = gtk_radio_button_new_with_label (NULL, name);
+                    g_signal_connect (entry, "toggled", G_CALLBACK(on_radio_changed), val);
+                    gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (entry), * (int *) val == rb_group);
+#if !GTK_CHECK_VERSION(3, 0, 0)
+                    gtk_radio_button_group (GTK_RADIO_BUTTON (entry));
+#endif
+                    lastbtn = entry;
+                    rb_group++;
+                }
+                else
+                {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                    entry = gtk_radio_button_new_with_label (gtk_radio_button_get_group (GTK_RADIO_BUTTON (lastbtn)), name);
+#else
+                    entry = gtk_radio_button_new_with_label (gtk_radio_button_group (GTK_RADIO_BUTTON (lastbtn)), name);
+#endif
+                    g_signal_connect (entry, "toggled", G_CALLBACK(on_radio_changed), val);
+                    gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (entry), * (int *) val == rb_group);
+                    lastbtn = entry;
+                    rb_group++;
+                }
+                break;
         }
         if( entry )
         {
-            if(( type == CONF_TYPE_BOOL ) || ( type == CONF_TYPE_TRIM ))
+            if(( type == CONF_TYPE_BOOL ) || ( type == CONF_TYPE_TRIM ) || (type == CONF_TYPE_RBUTTON))
                 gtk_box_pack_start( dlg_vbox, entry, FALSE, FALSE, 2 );
             else
             {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                GtkWidget* hbox = gtk_box_new( GTK_ORIENTATION_HORIZONTAL, 2 );
+#else
                 GtkWidget* hbox = gtk_hbox_new( FALSE, 2 );
+#endif
                 gtk_box_pack_start( GTK_BOX(hbox), gtk_label_new(name), FALSE, FALSE, 2 );
                 gtk_box_pack_start( GTK_BOX(hbox), entry, TRUE, TRUE, 2 );
                 gtk_box_pack_start( dlg_vbox, hbox, FALSE, FALSE, 2 );
@@ -1667,7 +1817,11 @@ GtkWidget *panel_config_int_button_new(const char *name, gint *val,
                                        gint min, gint max)
 {
     GtkWidget *entry = gtk_spin_button_new_with_range(min, max, 1);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 2);
+#else
     GtkWidget *hbox = gtk_hbox_new(FALSE, 2);
+#endif
 
     gtk_spin_button_set_value(GTK_SPIN_BUTTON(entry), *val);
     g_signal_connect(entry, "value-changed", G_CALLBACK(on_spin_changed), val);
diff --git a/src/gtk-run.c b/src/gtk-run.c
index 5c43610..9a63d51 100644
--- a/src/gtk-run.c
+++ b/src/gtk-run.c
@@ -341,7 +341,11 @@ static void on_entry_changed( GtkEntry* entry, GtkImage* img )
     }
     else
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_image_set_from_icon_name(img, "gtk-execute", GTK_ICON_SIZE_DIALOG);
+#else
         gtk_image_set_from_stock(img, GTK_STOCK_EXECUTE, GTK_ICON_SIZE_DIALOG);
+#endif
     }
 }
 #endif
@@ -385,11 +389,18 @@ void gtk_run()
         win = gtk_dialog_new_with_buttons( _("Run"),
                                            NULL,
                                            GTK_DIALOG_NO_SEPARATOR,
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                           _("_Cancel"), GTK_RESPONSE_CANCEL,
+                                           _("_OK"), GTK_RESPONSE_OK,
+#else
                                            GTK_STOCK_CANCEL, GTK_RESPONSE_CANCEL,
                                            GTK_STOCK_OK, GTK_RESPONSE_OK,
+#endif
                                            NULL );
+#if !GTK_CHECK_VERSION(3, 0, 0)
         gtk_dialog_set_alternative_button_order((GtkDialog*)win,
                                 GTK_RESPONSE_OK, GTK_RESPONSE_CANCEL, -1);
+#endif
         gtk_dialog_set_default_response( (GtkDialog*)win, GTK_RESPONSE_OK );
         entry = gtk_entry_new();
 
@@ -398,8 +409,13 @@ void gtk_run()
         gtk_box_pack_start( (GtkBox*)dlg_vbox,
                              gtk_label_new(_("Enter the command you want to execute:")),
                              FALSE, FALSE, 8 );
+#if GTK_CHECK_VERSION(3, 0, 0)
+        hbox = gtk_box_new( GTK_ORIENTATION_HORIZONTAL, 2 );
+        img = gtk_image_new_from_icon_name ( "gtk-execute", GTK_ICON_SIZE_DIALOG );
+#else
         hbox = gtk_hbox_new( FALSE, 2 );
         img = gtk_image_new_from_stock( GTK_STOCK_EXECUTE, GTK_ICON_SIZE_DIALOG );
+#endif
         gtk_box_pack_start( (GtkBox*)hbox, img,
                              FALSE, FALSE, 4 );
         gtk_box_pack_start( (GtkBox*)hbox, entry, TRUE, TRUE, 4 );
diff --git a/src/icon-grid.c b/src/icon-grid.c
index 2177971..914674c 100644
--- a/src/icon-grid.c
+++ b/src/icon-grid.c
@@ -207,7 +207,11 @@ static void panel_icon_grid_size_allocate(GtkWidget *widget,
         if (gtk_widget_get_visible(child))
         {
             /* Do necessary operations on the child. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gtk_widget_get_preferred_size (child, NULL, &req);
+#else
             gtk_widget_get_child_requisition(child, &req);
+#endif
             icon_grid_element_check_requisition(ig, &req);
             child_allocation.width = MIN(req.width, child_width);
             child_allocation.height = MIN(req.height, child_height);
@@ -298,7 +302,11 @@ static void panel_icon_grid_calculate_size(PanelIconGrid *ig,
         for (ige = ig->children; ige != NULL; ige = ige->next)
             if (gtk_widget_get_visible(ige->data))
             {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                gtk_widget_get_preferred_size(ige->data, NULL, &child_requisition);
+#else
                 gtk_widget_size_request(ige->data, &child_requisition);
+#endif
                 icon_grid_element_check_requisition(ig, &child_requisition);
                 if (row == 0)
                     ig->columns++;
@@ -324,6 +332,14 @@ static void panel_icon_grid_calculate_size(PanelIconGrid *ig,
             ig->rows = visible_children; */
         if (ig->columns > 0)
             requisition->height = (ig->child_height + ig->spacing) * ig->rows - ig->spacing + 2 * border;
+#if GTK_CHECK_VERSION(3, 0, 0)
+        /* The line below fixes a problem under GTK+3 whereby an icon grid which is supposed to have a constrained width,
+         * such as the taskbar, just keeps growing as items are added. I am not 100% sure why this fix works - I think it is
+         * because otherwise the icon grid's width request just gets bigger as items are added, and the bar allocates the requested
+         * space; by resetting the requisition to zero, the widget is only ever given any remaining space and so does not grow
+         * infinitely. This may have side effects which I have not yet discovered... */
+        if (ig->constrain_width) requisition->width = 0;
+#endif
     }
     else
     {
@@ -337,7 +353,11 @@ static void panel_icon_grid_calculate_size(PanelIconGrid *ig,
         for (ige = ig->children; ige != NULL; ige = ige->next)
             if (gtk_widget_get_visible(ige->data))
             {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                gtk_widget_get_preferred_size(ige->data, NULL, &child_requisition);
+#else
                 gtk_widget_size_request(ige->data, &child_requisition);
+#endif
                 icon_grid_element_check_requisition(ig, &child_requisition);
                 if (w > 0)
                 {
@@ -929,11 +949,13 @@ static void panel_icon_grid_realize(GtkWidget *widget)
         gdk_window_set_user_data(ig->event_window, widget);
     }
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
     style = gtk_style_attach(gtk_widget_get_style(widget), window);
     gtk_widget_set_style(widget, style);
 
     if (visible_window)
         gtk_style_set_background(style, window, GTK_STATE_NORMAL);
+#endif
 }
 
 static void panel_icon_grid_unrealize(GtkWidget *widget)
@@ -1195,6 +1217,7 @@ static void panel_icon_grid_class_init(PanelIconGridClass *klass)
 
 static void panel_icon_grid_init(PanelIconGrid *ig)
 {
+    gtk_widget_set_has_window(GTK_WIDGET(ig), FALSE);
     gtk_widget_set_redraw_on_allocate(GTK_WIDGET(ig), FALSE);
 
     ig->orientation = GTK_ORIENTATION_HORIZONTAL;
diff --git a/src/input-button.c b/src/input-button.c
index 1bd9dd9..4eb0813 100644
--- a/src/input-button.c
+++ b/src/input-button.c
@@ -114,8 +114,14 @@ static void on_focus_in_event(GtkButton *test, GdkEvent *event,
     gtk_toggle_button_set_active(btn->custom, TRUE);
     btn->has_focus = TRUE;
     if (btn->do_key)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_seat_grab (gdk_display_get_default_seat (gdk_display_get_default ()),
+            gtk_widget_get_window(GTK_WIDGET(test)), GDK_SEAT_CAPABILITY_KEYBOARD,
+            TRUE, NULL, event, NULL, NULL);
+#else
         gdk_keyboard_grab(gtk_widget_get_window(GTK_WIDGET(test)),
                           TRUE, GDK_CURRENT_TIME);
+#endif
 }
 
 static void on_focus_out_event(GtkButton *test, GdkEvent *event,
@@ -124,7 +130,11 @@ static void on_focus_out_event(GtkButton *test, GdkEvent *event,
     /* stop accepting mouse clicks */
     btn->has_focus = FALSE;
     if (btn->do_key)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_seat_ungrab (gdk_display_get_default_seat (gdk_display_get_default ()));
+#else
         gdk_keyboard_ungrab(GDK_CURRENT_TIME);
+#endif
 }
 
 static void _button_set_click_label(GtkButton *btn, guint keyval, GdkModifierType state)
@@ -173,8 +183,14 @@ static gboolean on_key_event(GtkButton *test, GdkEventKey *event,
     if (event->keyval == GDK_KEY_Tab)
         return FALSE;
     /* request mods directly, event->state isn't updated yet */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_window_get_device_position (gtk_widget_get_window (GTK_WIDGET(test)),
+        gdk_seat_get_pointer (gdk_display_get_default_seat (gdk_display_get_default ())),
+        NULL, NULL, &state);
+#else
     gdk_window_get_pointer(gtk_widget_get_window(GTK_WIDGET(test)),
                            NULL, NULL, &state);
+#endif
     /* special support for Win key, it doesn't work sometimes */
     if ((state & GDK_SUPER_MASK) == 0 && (state & GDK_MOD4_MASK) != 0)
         state |= GDK_SUPER_MASK;
@@ -322,7 +338,11 @@ static void config_input_button_class_init(PanelCfgInputButtonClass *klass)
 
 static void config_input_button_init(PanelCfgInputButton *self)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GtkWidget *w = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 6);
+#else
     GtkWidget *w = gtk_hbox_new(FALSE, 6);
+#endif
     GtkBox *box = GTK_BOX(w);
 
     /* GtkRadioButton "None" */
diff --git a/src/lxpanelctl.c b/src/lxpanelctl.c
index d0334d1..4ee530c 100644
--- a/src/lxpanelctl.c
+++ b/src/lxpanelctl.c
@@ -42,6 +42,8 @@ static const char usage[] =
         "run\t\t\tshow run dialog\n"
         "config\t\t\tshow configuration dialog\n"
         "restart\t\t\trestart lxpanel\n"
+        "refresh\t\trefresh lxpanel\n"
+        "move\t\tmove panel to new monitor\n"
         "exit\t\t\texit lxpanel\n"
         "command <plugin> <cmd>\tsend a command to a plugin\n\n";
 
@@ -59,6 +61,10 @@ static int get_cmd( const char* cmd )
         return LXPANEL_CMD_EXIT;
     else if( ! strcmp( cmd, "command") )
         return LXPANEL_CMD_COMMAND;
+    else if( ! strcmp( cmd, "refresh") )
+        return LXPANEL_CMD_REFRESH;
+    else if( ! strcmp( cmd, "move") )
+        return LXPANEL_CMD_MOVE;
     return -1;
 }
 
diff --git a/src/lxpanelctl.h b/src/lxpanelctl.h
index 0ca1e71..e5ba1c6 100644
--- a/src/lxpanelctl.h
+++ b/src/lxpanelctl.h
@@ -33,7 +33,9 @@ typedef enum {
     LXPANEL_CMD_CONFIG,
     LXPANEL_CMD_RESTART,
     LXPANEL_CMD_EXIT,
-    LXPANEL_CMD_COMMAND
+    LXPANEL_CMD_COMMAND,
+    LXPANEL_CMD_REFRESH,
+    LXPANEL_CMD_MOVE
 } PanelControlCommand;
 
 /* this enum was in private.h but it is used by LXPANEL_CMD_COMMAND now */
diff --git a/src/main.c b/src/main.c
index d55a66b..79e73e5 100644
--- a/src/main.c
+++ b/src/main.c
@@ -62,6 +62,7 @@ static gchar *cfgfile = NULL;
 static gchar version[] = VERSION;
 static int config = 0;
 
+static gboolean mon_override = FALSE;
 static gboolean is_restarting = FALSE;
 
 Command commands[] = {
@@ -81,6 +82,13 @@ void restart(void)
     RET();
 }
 
+/* copied from configurator.c */
+#define UPDATE_GLOBAL_INT(panel,name,val) do { \
+    config_setting_t *_s = config_setting_add(config_setting_get_elem(config_setting_get_member(config_root_setting(panel->config),""),\
+                                                                      0),\
+                                              name,PANEL_CONF_TYPE_INT);\
+    if (_s) config_setting_set_int(_s,val); } while(0)
+
 static void process_client_msg ( XClientMessageEvent* ev )
 {
     int cmd = ev->data.b[0];
@@ -130,6 +138,155 @@ static void process_client_msg ( XClientMessageEvent* ev )
         case LXPANEL_CMD_EXIT:
             gtk_main_quit();
             break;
+        case LXPANEL_CMD_REFRESH:
+            {
+                GSList *l;
+                for (l = all_panels; l; l = l->next)
+                {
+                    LXPanel *p = (LXPanel *) l->data;
+                    if (p != NULL)
+                    {
+                        // at some point I may need to read some more parameters here, but this will do for now...
+                        char linebuf[256], posbuf[16];
+                        int val;
+
+                        // try to find a config file...
+                        FILE *fp;
+                        char *file;
+                        file = g_build_filename (g_get_user_config_dir(), "lxpanel", cprofile, "panels", p->priv->name, NULL);
+                        fp = fopen (file, "rb");
+                        g_free (file);
+                        if (!fp)
+                        {
+                            const gchar * const *dir = g_get_system_config_dirs();
+                            if (dir)
+                            {
+                                while (dir[0])
+                                {
+                                    file = g_build_filename (dir[0], "lxpanel", cprofile, "panels", p->priv->name, NULL);
+                                    fp = fopen (file, "rb");
+                                    g_free (file);
+                                    if (fp) break;
+                                    dir++;
+                                }
+                            }
+                        }
+
+                        while (fp && !feof (fp))
+                        {
+                            if (fgets (linebuf, 256, fp))
+                            {
+                                if (sscanf (linebuf, "%*[ \t]iconsize=%d", &val) == 1)
+                                {
+                                    p->priv->icon_size = val;
+                                    p->priv->height = val;
+                                    panel_set_panel_configuration_changed (p->priv);
+                                }
+                                if (sscanf (linebuf, "%*[ \t]edge=%s", posbuf) == 1)
+                                {
+                                    if (!strcmp (posbuf, "bottom"))
+                                    {
+                                        if (p->priv->edge != EDGE_BOTTOM)
+                                        {
+                                            p->priv->edge = EDGE_BOTTOM;
+                                            gtk_widget_queue_resize(GTK_WIDGET(p));
+                                        }
+                                    }
+                                    else
+                                    {
+                                        if (p->priv->edge != EDGE_TOP)
+                                        {
+                                            p->priv->edge = EDGE_TOP;
+                                            gtk_widget_queue_resize(GTK_WIDGET(p));
+                                        }
+                                    }
+                                }
+                                if (sscanf (linebuf, "%*[ \t]monitor=%d", &val) == 1)
+                                {
+#if GTK_CHECK_VERSION(3, 0, 0)
+                                    if (!mon_override || gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (p))) > 1)
+#else
+                                    if (!mon_override || gdk_screen_get_n_monitors (gtk_widget_get_screen (GTK_WIDGET (p))) > 1)
+#endif
+                                    {
+                                        p->priv->monitor = val;
+                                        panel_set_panel_configuration_changed (p->priv);
+                                    }
+                                }
+
+                                /*
+                                 * This is a really unpleasant hack...
+                                 * I need to be able to get the taskbar plugin to resize elements based
+                                 * on an updated value in the global config file.
+                                 * The taskbar plugin cannot see the name of the profile used to launch
+                                 * lxpanel, so it cannot read the config file itself.
+                                 * The panel does not have access to the local data structures of a plugin,
+                                 * so it can't write the data directly to the plugin.
+                                 * The messaging interface from panel to plugin does not support arguments to
+                                 * commands.
+                                 * So the only way I can see to do this is to create a single-word command which
+                                 * incorporates the argument, and send that via the messaging interface.
+                                 * It's nasty, but it works. I'm open to suggestions for a better (more generic)
+                                 * way of doing this - ideally it should be possible to get every plugin to
+                                 * update from the config file simultaneously, but after banging my head on the
+                                 * keyboard for a day, I can't see a simple and efficient way to do that...
+                                 */
+                                if (sscanf (linebuf, "%*[ \t]MaxTaskWidth=%d", &val) == 1)
+                                {
+                                    GList *plugins, *pl;
+                                    const LXPanelPluginInit *init;
+                                    char buf[10];
+
+                                    init = g_hash_table_lookup (lxpanel_get_all_types (), "taskbar");
+                                    if (init && init->control)
+                                    {
+                                        plugins = gtk_container_get_children (GTK_CONTAINER(p->priv->box));
+                                        for (pl = plugins; pl; pl = pl->next)
+                                        {
+                                            if (init == PLUGIN_CLASS(pl->data))
+                                            {
+                                                sprintf (buf, "mtw%d\n", val);
+                                                init->control (pl->data, buf);
+                                                break;
+                                            }
+                                        }
+                                        g_list_free (plugins);
+                                    }
+                                }
+                            }
+                        }
+                        if (fp) fclose (fp);
+                    }
+                }
+            }
+            break;
+        case LXPANEL_CMD_MOVE:
+            {
+                GSList *l;
+                for (l = all_panels; l; l = l->next)
+                {
+                    LXPanel *p = (LXPanel *) l->data;
+                    if (p != NULL)
+                    {
+                        int ppm = p->priv->monitor;
+#if GTK_CHECK_VERSION(3, 0, 0)
+                        if (p->priv->monitor < gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (p))) - 1)
+#else
+                        if (p->priv->monitor < gdk_screen_get_n_monitors (gtk_widget_get_screen (GTK_WIDGET (p))) - 1)
+#endif
+                            p->priv->monitor++;
+                        else
+                            p->priv->monitor = 0;
+                        if (p->priv->monitor != ppm)
+                        {
+                            panel_set_panel_configuration_changed (p->priv);
+                            UPDATE_GLOBAL_INT (p->priv, "monitor", p->priv->monitor);
+                            lxpanel_config_save (p);
+                        }
+                    }
+                }
+            }
+            break;
         case LXPANEL_CMD_COMMAND:
             monitor = (ev->data.b[1] & 0xf) - 1; /* 0 for no monitor */
             edge = (ev->data.b[1] >> 4) & 0x7;
@@ -138,7 +295,40 @@ static void process_client_msg ( XClientMessageEvent* ev )
                 break;
             plugin_type = g_strndup(&ev->data.b[2], 18);
             command = strchr(plugin_type, '\t');
-            if (command) do /* use do{}while(0) to enable break */
+            if (!strncmp (plugin_type, "volumealsabt", 12))
+            {
+                /* special case - message volume plugin on all panels, not just the first one found */
+                *command++ = '\0';
+                GSList *l;
+                for (l = all_panels; l; l = l->next)
+                {
+                    LXPanel *p = (LXPanel *) l->data;
+                    if (p != NULL)
+                    {
+                        GList *plugins, *pl;
+                        const LXPanelPluginInit *init;
+                        GtkWidget *plugin = NULL;
+
+                        init = g_hash_table_lookup (lxpanel_get_all_types (), plugin_type);
+                        if (init)
+                        {
+                            plugins = gtk_container_get_children (GTK_CONTAINER (p->priv->box));
+                            for (pl = plugins; pl; pl = pl->next)
+                            {
+                                if (init == PLUGIN_CLASS (pl->data))
+                                {
+                                    plugin = pl->data;
+                                    break;
+                                }
+                            }
+                            g_list_free (plugins);
+
+                            if (plugin && init->control) init->control (plugin, command);
+                        }
+                    }
+                }
+            }
+            else if (command) do /* use do{}while(0) to enable break */
             {
                 LXPanel *p;
                 GSList *l;
@@ -391,13 +581,17 @@ static gboolean check_main_lock()
 
 out:
     XUngrabServer (xdisplay);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_display_flush (gdk_display_get_default());
+#else
     gdk_flush ();
+#endif
 
     return retval;
 }
 #undef CLIPBOARD_NAME
 
-static void _start_panels_from_dir(const char *panel_dir)
+static void _start_panels_from_dir(const char *panel_dir, int fallback)
 {
     GDir* dir = g_dir_open( panel_dir, 0, NULL );
     const gchar* name;
@@ -410,9 +604,9 @@ static void _start_panels_from_dir(const char *panel_dir)
     while((name = g_dir_read_name(dir)) != NULL)
     {
         char* panel_config = g_build_filename( panel_dir, name, NULL );
-        if (strchr(panel_config, '~') == NULL)    /* Skip editor backup files in case user has hand edited in this directory */
+        if (strchr(panel_config, '~') == NULL && name[0] != '.')    /* Skip editor backup files in case user has hand edited in this directory */
         {
-            LXPanel* panel = panel_new( panel_config, name );
+            LXPanel* panel = fallback ? panel_new_mon_fb (panel_config, name) : panel_new (panel_config, name);
             if( panel )
                 all_panels = g_slist_prepend( all_panels, panel );
         }
@@ -428,7 +622,15 @@ static gboolean start_all_panels( )
 
     /* try user panels */
     panel_dir = _user_config_file_name("panels", NULL);
-    _start_panels_from_dir(panel_dir);
+
+    /* check to see if there are any panels which will display on monitor 0 */
+    char *cmd = g_strdup_printf ("grep -l Global $(grep -L monitor=[1-9] %s/*) /dev/null | grep -c . | grep -q 0", panel_dir);
+    int res = system (cmd);
+    g_free (cmd);
+    /* if res == 0 here, then there are no panels defined which will display on monitor 0 */
+    if (res == 0) mon_override = TRUE;
+
+    _start_panels_from_dir(panel_dir, mon_override);
     g_free(panel_dir);
     if (all_panels != NULL)
         return TRUE;
@@ -437,7 +639,7 @@ static gboolean start_all_panels( )
     if (dir) while (dir[0])
     {
         panel_dir = _system_config_file_name(dir[0], "panels");
-        _start_panels_from_dir(panel_dir);
+        _start_panels_from_dir(panel_dir, 0);
         g_free(panel_dir);
         if (all_panels != NULL)
             return TRUE;
@@ -445,7 +647,7 @@ static gboolean start_all_panels( )
     }
     /* last try at old fallback for compatibility reasons */
     panel_dir = _old_system_config_file_name("panels");
-    _start_panels_from_dir(panel_dir);
+    _start_panels_from_dir(panel_dir, 0);
     g_free(panel_dir);
     return all_panels != NULL;
 }
@@ -526,9 +728,11 @@ int main(int argc, char *argv[], char *env[])
     }
 
     /* Add a gtkrc file to be parsed too. */
+#if !GTK_CHECK_VERSION(3, 0, 0)
     file = _user_config_file_name("gtkrc", NULL);
     gtk_rc_parse(file);
     g_free(file);
+#endif
 
     /* Check for duplicated lxpanel instances */
     if (!check_main_lock() && !config) {
diff --git a/src/misc.c b/src/misc.c
index be46ac1..1fbf436 100644
--- a/src/misc.c
+++ b/src/misc.c
@@ -851,6 +851,7 @@ calculate_width(int scrw, int pw, int wtype, int align, int margin,
     RET();
 }
 
+extern int gdk_mon_num (int index);
 
 void _calculate_position(LXPanel *panel, GdkRectangle *rect)
 {
@@ -864,11 +865,21 @@ void _calculate_position(LXPanel *panel, GdkRectangle *rect)
     {
         marea.x = 0;
         marea.y = 0;
+#if GTK_CHECK_VERSION(3, 0, 0)
+        marea.width = screen_width(screen);
+        marea.height = screen_height(screen);
+#else
         marea.width = gdk_screen_get_width(screen);
         marea.height = gdk_screen_get_height(screen);
+#endif
     }
+#if GTK_CHECK_VERSION(3, 0, 0)
+    else if (np->monitor < gdk_display_get_n_monitors(gtk_widget_get_display(GTK_WIDGET(panel))))
+        gdk_monitor_get_geometry (gdk_display_get_monitor (gdk_screen_get_display (screen), gdk_mon_num (np->monitor)), &marea);
+#else
     else if (np->monitor < gdk_screen_get_n_monitors(screen))
-        gdk_screen_get_monitor_geometry(screen,np->monitor,&marea);
+        gdk_screen_get_monitor_geometry(screen,gdk_mon_num (np->monitor),&marea);
+#endif
     else
     {
         marea.x = 0;
@@ -965,6 +976,10 @@ static void _lxpanel_button_set_icon(GtkWidget* btn, FmIcon* icon, gint size)
     /* Locate the image within the button. */
     GtkWidget * child = gtk_bin_get_child(GTK_BIN(btn));
     GtkWidget * img = NULL;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (GTK_IS_BUTTON (btn) && !(img = gtk_button_get_image (GTK_BUTTON(btn))))
+    {
+#endif
     if (GTK_IS_IMAGE(child))
         img = child;
     else if (GTK_IS_BOX(child))
@@ -973,6 +988,9 @@ static void _lxpanel_button_set_icon(GtkWidget* btn, FmIcon* icon, gint size)
         img = GTK_WIDGET(GTK_IMAGE(children->data));
         g_list_free(children);
     }
+#if GTK_CHECK_VERSION(3, 0, 0)
+    }
+#endif
 
     if (img != NULL)
     {
@@ -1042,12 +1060,13 @@ void fb_button_set_from_file(GtkWidget * btn, const char * img_file, gint width,
     lxpanel_button_set_icon(btn, img_file, height);
 }
 
+#define ICON_BUTTON_TRIM 4
 static void _gtk_image_set_from_file_scaled(GtkWidget * img, ImgData * data)
 {
     gint size = data->size;
 
     if (size < 0 && data->panel)
-        size = data->panel->priv->icon_size;
+        size = data->panel->priv->icon_size - ICON_BUTTON_TRIM;
 
     if (data->pixbuf != NULL)
     {
@@ -1091,7 +1110,11 @@ static void _gtk_image_set_from_file_scaled(GtkWidget * img, ImgData * data)
     else
     {
         /* No pixbuf available.  Set the "missing image" icon. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_image_set_from_icon_name(GTK_IMAGE(img), "gtk-missing-image", GTK_ICON_SIZE_BUTTON);
+#else
         gtk_image_set_from_stock(GTK_IMAGE(img), GTK_STOCK_MISSING_IMAGE, GTK_ICON_SIZE_BUTTON);
+#endif
     }
 }
 
@@ -1185,13 +1208,37 @@ get_button_spacing(GtkRequisition *req, GtkContainer *parent, gchar *name)
         gtk_container_add(parent, b);
 
     gtk_widget_show(b);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_get_preferred_size(b, NULL, req);
+#else
     gtk_widget_size_request(b, req);
+#endif
 
     gtk_widget_destroy(b);
     RET();
 }
 
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+guint32 gcolor2rgb24(GdkRGBA *color)
+{
+    guint32 i;
+    double f;
+
+    ENTER;
+
+    f = color->red * 255.999;
+    i = ((guint32) f) & 0xFF;
+    i <<= 8;
+    f = color->green * 255.999;
+    i |= ((guint32) f) & 0xFF;
+    i <<= 8;
+    f = color->blue * 255.999;
+    i |= ((guint32) f) & 0xFF;
+    DBG("i=%x\n", i);
+    RET(i);
+}
+#else
 guint32 gcolor2rgb24(GdkColor *color)
 {
     guint32 i;
@@ -1206,6 +1253,7 @@ guint32 gcolor2rgb24(GdkColor *color)
     DBG("i=%x\n", i);
     RET(i);
 }
+#endif
 
 /* Handler for "enter-notify-event" signal on image that has highlighting requested. */
 static gboolean fb_button_enter(GtkImage * widget, GdkEventCrossing * event)
@@ -1278,8 +1326,16 @@ static GtkWidget *_lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image
 {
     ImgData * data = (ImgData *) g_object_get_qdata(G_OBJECT(image), img_data_id);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gtk_widget_set_margin_start (image, 0);
+    gtk_widget_set_margin_end (image, 0);
+    gtk_widget_set_margin_top (image, 0);
+    gtk_widget_set_margin_bottom (image, 0);
+#else
     gtk_misc_set_padding(GTK_MISC(image), 0, 0);
     gtk_misc_set_alignment(GTK_MISC(image), 0.5, 0.5);
+#endif
+#if 0
     if (highlight_color != 0 && data != NULL)
     {
         data->hicolor = highlight_color;
@@ -1287,14 +1343,23 @@ static GtkWidget *_lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image
         g_signal_connect_swapped(G_OBJECT(event_box), "enter-notify-event", G_CALLBACK(fb_button_enter), image);
         g_signal_connect_swapped(G_OBJECT(event_box), "leave-notify-event", G_CALLBACK(fb_button_leave), image);
     }
+#endif
 
     if (label == NULL)
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_button_set_image (GTK_BUTTON(event_box), image);
+#else
         gtk_container_add(GTK_CONTAINER(event_box), image);
+#endif
     else
     {
         GtkWidget *inner, *lbl;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+        inner = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 0);
+#else
         inner = gtk_hbox_new(FALSE, 0);
+#endif
         gtk_container_set_border_width(GTK_CONTAINER(inner), 0);
         gtk_widget_set_can_focus(inner, FALSE);
         gtk_container_add(GTK_CONTAINER(event_box), inner);
@@ -1312,16 +1377,27 @@ static GtkWidget *_lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image
         }
         else
             gtk_label_set_text(GTK_LABEL(lbl), label);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_set_margin_start (lbl, 2);
+        gtk_widget_set_margin_end (lbl, 2);
+#else
         gtk_misc_set_padding(GTK_MISC(lbl), 2, 0);
+#endif
         gtk_box_pack_end(GTK_BOX(inner), lbl, FALSE, FALSE, 0);
     }
 
+    if (GTK_IS_BUTTON (event_box)) gtk_button_set_relief (GTK_BUTTON (event_box), GTK_RELIEF_NONE);
     gtk_widget_show_all(event_box);
     return event_box;
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+GtkWidget *lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image,
+                                  GdkRGBA *color, const gchar *label)
+#else
 GtkWidget *lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image,
                                   GdkColor *color, const gchar *label)
+#endif
 {
     gulong highlight_color = color ? gcolor2rgb24(color) : PANEL_ICON_HIGHLIGHT;
     return _lxpanel_button_compose(event_box, image, highlight_color, label);
@@ -1340,14 +1416,22 @@ static GtkWidget *_lxpanel_button_new_for_icon(LXPanel *panel, FmIcon *icon,
     return _lxpanel_button_compose(event_box, image, highlight_color, label);
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+GtkWidget *lxpanel_button_new_for_icon(LXPanel *panel, const gchar *name, GdkRGBA *color, const gchar *label)
+#else
 GtkWidget *lxpanel_button_new_for_icon(LXPanel *panel, const gchar *name, GdkColor *color, const gchar *label)
+#endif
 {
     gulong highlight_color = color ? gcolor2rgb24(color) : PANEL_ICON_HIGHLIGHT;
     return _lxpanel_button_new_for_icon(panel, fm_icon_from_name(name), -1,
                                         highlight_color, label);
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+GtkWidget *lxpanel_button_new_for_fm_icon(LXPanel *panel, FmIcon *icon, GdkRGBA *color, const gchar *label)
+#else
 GtkWidget *lxpanel_button_new_for_fm_icon(LXPanel *panel, FmIcon *icon, GdkColor *color, const gchar *label)
+#endif
 {
     gulong highlight_color = color ? gcolor2rgb24(color) : PANEL_ICON_HIGHLIGHT;
     return _lxpanel_button_new_for_icon(panel, g_object_ref(icon), -1,
@@ -1651,4 +1735,42 @@ gboolean lxpanel_launch_app(const char* exec, GList* files, gboolean in_terminal
     return (error == NULL);
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+int screen_width (GdkScreen *scr)
+{
+    GdkDisplay *disp = gdk_screen_get_display (scr == NULL ? gdk_screen_get_default () : scr);
+    GdkMonitor *mon;
+    GdkRectangle rect;
+    int min = -1, max = 0, i;
+
+    for (i = 0; i < gdk_display_get_n_monitors (disp); i++)
+    {
+        mon = gdk_display_get_monitor (disp, i);
+        gdk_monitor_get_geometry (mon, &rect);
+        if (min == -1 || rect.x < min) min = rect.x;
+        if (rect.x + rect.width > max) max = rect.x + rect.width;
+    }
+
+    return max - min;
+}
+
+int screen_height (GdkScreen *scr)
+{
+    GdkDisplay *disp = gdk_screen_get_display (scr == NULL ? gdk_screen_get_default () : scr);
+    GdkMonitor *mon;
+    GdkRectangle rect;
+    int min = -1, max = 0, i;
+
+    for (i = 0; i < gdk_display_get_n_monitors (disp); i++)
+    {
+        mon = gdk_display_get_monitor (disp, i);
+        gdk_monitor_get_geometry (mon, &rect);
+        if (min == -1 || rect.y < min) min = rect.y;
+        if (rect.y + rect.height > max) max = rect.y + rect.height;
+    }
+
+    return max - min;
+}
+#endif
+
 /* vim: set sw=4 et sts=4 : */
diff --git a/src/misc.h b/src/misc.h
index c263c7c..3ba9341 100644
--- a/src/misc.h
+++ b/src/misc.h
@@ -164,7 +164,11 @@ gchar *expand_tilda(const gchar *file);
  *
  * Returns: a 32-bit integer.
  */
+#if GTK_CHECK_VERSION(3, 0, 0)
+guint32 gcolor2rgb24(GdkRGBA *color);
+#else
 guint32 gcolor2rgb24(GdkColor *color);
+#endif
 
 /**
  * lxpanel_button_new_for_icon
@@ -180,8 +184,13 @@ guint32 gcolor2rgb24(GdkColor *color);
  *
  * Returns: (transfer full): a new #GtkEventBox widget.
  */
+#if GTK_CHECK_VERSION(3, 0, 0)
+extern GtkWidget *lxpanel_button_new_for_icon(LXPanel *panel, const gchar *name, GdkRGBA *color, const gchar *label);
+extern GtkWidget *lxpanel_button_new_for_fm_icon(LXPanel *panel, FmIcon *icon, GdkRGBA *color, const gchar *label);
+#else
 extern GtkWidget *lxpanel_button_new_for_icon(LXPanel *panel, const gchar *name, GdkColor *color, const gchar *label);
 extern GtkWidget *lxpanel_button_new_for_fm_icon(LXPanel *panel, FmIcon *icon, GdkColor *color, const gchar *label);
+#endif
 
 /**
  * lxpanel_button_set_icon
@@ -228,8 +237,13 @@ extern gboolean lxpanel_button_set_label(GtkWidget *btn, const char *label);
  *
  * Since: 0.8.0
  */
+#if GTK_CHECK_VERSION(3, 0, 0)
+extern GtkWidget *lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image,
+                                         GdkRGBA *color, const gchar *label);
+#else
 extern GtkWidget *lxpanel_button_compose(GtkWidget *event_box, GtkWidget *image,
                                          GdkColor *color, const gchar *label);
+#endif
 
 /**
  * lxpanel_image_new_for_icon
@@ -269,6 +283,12 @@ extern GtkWidget *lxpanel_image_new_for_fm_icon(LXPanel *panel, FmIcon *icon,
 extern gboolean lxpanel_image_change_icon(GtkWidget *img, const gchar *name,
                                           const char *fallback);
 
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+extern int screen_width (GdkScreen *scr);
+extern int screen_height (GdkScreen *scr);
+#endif
+
 G_END_DECLS
 
 #endif
diff --git a/src/panel-plugin-move.c b/src/panel-plugin-move.c
index 1e7c548..cd048e2 100644
--- a/src/panel-plugin-move.c
+++ b/src/panel-plugin-move.c
@@ -36,7 +36,7 @@ gboolean _lxpanel_button_release(GtkWidget *widget, GdkEventButton *event)
         {
             /* ungrab device and return back previous cursor */
 #if GTK_CHECK_VERSION(3, 0, 0)
-            gdk_device_ungrab(event->device, event->time);
+            gdk_seat_ungrab (gdk_display_get_default_seat (gdk_display_get_default ()));
 #else
             gdk_pointer_ungrab(event->time);
 #endif
@@ -94,11 +94,9 @@ gboolean _lxpanel_motion_notify(GtkWidget *widget, GdkEventMotion *event)
             }
             /* grab pointer, use cursor "move" */
 #if GTK_CHECK_VERSION(3, 0, 0)
-            s = gdk_device_grab(event->device, gtk_widget_get_window(widget),
-                                GDK_OWNERSHIP_NONE, FALSE,
-                                GDK_POINTER_MOTION_MASK | GDK_BUTTON_RELEASE_MASK,
-                                gdk_cursor_new_from_name(p->display, "move"),
-                                event->time);
+            s = gdk_seat_grab (gdk_display_get_default_seat (gdk_display_get_default ()),
+                gtk_widget_get_window (widget), GDK_SEAT_CAPABILITY_ALL_POINTING,
+                FALSE, gdk_cursor_new_from_name (p->display, "move"), (GdkEvent *) event, NULL, NULL);
 #else
             s = gdk_pointer_grab(gtk_widget_get_window(widget), FALSE,
                                  GDK_POINTER_MOTION_MASK | GDK_BUTTON_RELEASE_MASK,
diff --git a/src/panel.c b/src/panel.c
index 45188db..b3e8efd 100644
--- a/src/panel.c
+++ b/src/panel.c
@@ -86,6 +86,130 @@ enum
 
 static guint signals[N_SIGNALS];
 
+/* Monitor number remapping
+ * ========================
+ *
+ * There are two monitor numbering systems used in the code.
+ *
+ * The first is the numbering used by GDK. In this, monitors are numbered
+ * as they appear from left to right within the current GdkDisplay and
+ * GdkScreen. If xrandr or similar is used to rearrange the monitors, these
+ * numbers change.
+ *
+ * The second system is that used by X, and tools like xrandr. In this,
+ * the primary monitor is always 0, with non-primary monitors numbered from
+ * 1 upwards.
+ *
+ * xrandr --listmonitors lists monitors with their X reference number
+ * (with the primary monitor always as 0) - at the end of each line of the
+ * results of this command, the x and y offsets within the screen are shown
+ * for each monitor, so it is possible to cross-reference the two systems.
+ *
+ * Within lxpanel and pcmanfm, whenever a monitor number is given in the data
+ * file or data structure, it is an X reference number - 0 is always the
+ * primary monitor. (Otherwise, rearranging monitors makes these references
+ * change, and desktop, panel etc change when rearranging. Which is bad...)
+ *
+ * Whenever a GDK screen function is called on an internal monitor reference,
+ * the gdk_mon_num function must be used to wrap the internal reference before
+ * passing it to GDK.
+ *
+ * Note that identical functions are used in lxpanel and pcmanfm.
+ */
+
+int gdk_mon_num (int x_mon_num)
+{
+    GdkDisplay *disp = gdk_display_get_default ();
+#if GTK_CHECK_VERSION(3, 0, 0)
+    int prim = -1;
+    GdkMonitor *mon = gdk_display_get_primary_monitor (disp);
+    for (int i = 0; i < gdk_display_get_n_monitors (disp); i++)
+        if (gdk_display_get_monitor (disp, i) == mon) prim = i;
+#else
+    GdkScreen *scr = gdk_display_get_screen (disp, 0);
+    int prim = gdk_screen_get_primary_monitor (scr);
+#endif
+
+    /* monitor 0 is always the primary monitor */
+    if (x_mon_num == 0) return prim;
+
+    /* this will currently only return the secondary monitor, if there is one */
+    /* for some future world, this needs to compare co-ords against those from xrandr */
+#if GTK_CHECK_VERSION(3, 0, 0)
+    for (int i = 0; i < gdk_display_get_n_monitors (disp); i++)
+#else
+    for (int i = 0; i < gdk_screen_get_n_monitors (scr); i++)
+#endif
+    {
+        if (i != prim) return i;
+    }
+
+    /* ... or -1 if there is only one monitor */
+    return -1;
+}
+
+int x_mon_num (int gdk_mon_num)
+{
+    GdkDisplay *disp = gdk_display_get_default ();
+#if GTK_CHECK_VERSION(3, 0, 0)
+    int prim = -1;
+    GdkMonitor *mon = gdk_display_get_primary_monitor (disp);
+    for (int i = 0; i < gdk_display_get_n_monitors (disp); i++)
+        if (gdk_display_get_monitor (disp, i) == mon) prim = i;
+#else
+    GdkScreen *scr = gdk_display_get_screen (disp, 0);
+    int prim = gdk_screen_get_primary_monitor (scr);
+#endif
+
+    if (gdk_mon_num == prim) return 0;
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (gdk_display_get_n_monitors (disp) > 1) return 1;
+#else
+    if (gdk_screen_get_n_monitors (scr) > 1) return 1;
+#endif
+    else return -1;
+}
+
+void warp_pointer (Panel *p)
+{
+    if (p->point_at_menu && p->box != NULL)
+    {
+        // loop through all plugins to find the menu
+        GList *plugins = gtk_container_get_children (GTK_CONTAINER (p->box));
+        for (GList *l = plugins; l != NULL; l = l->next)
+        {
+            if (!g_strcmp0 ("Menu", PLUGIN_CLASS (l->data)->name))
+            {
+                int xpos, ypos;
+                GdkRectangle alloc;
+
+                // get the position of the menu window (the bar) and the menu button allocation
+                gdk_window_get_origin (gtk_widget_get_window (l->data), &xpos, &ypos);
+                gtk_widget_get_allocation (l->data, &alloc);
+
+                // calculate the centre of the menu button in screen coords
+                xpos += alloc.x + (alloc.width / 2);
+                ypos += alloc.y + (alloc.height / 2);
+
+                int x, y;
+                unsigned int w, h, d, b;
+                Window root;
+
+                // move the mouse pointer to the centre of the button
+                Display *xdisplay = XOpenDisplay (NULL);
+                XGetGeometry (xdisplay, DefaultRootWindow (xdisplay), &root, &x, &y, &w, &h, &b, &d);
+                XWarpPointer (xdisplay, 0, root, 0, 0, 0, 0, xpos, ypos);
+                XCloseDisplay (xdisplay);
+            }
+        }
+        g_list_free (plugins);
+    }
+
+    // clear the flag in RAM so we only do this once per run
+    p->point_at_menu = 0;
+}
+
 G_DEFINE_TYPE(PanelToplevel, lxpanel, GTK_TYPE_WINDOW);
 
 static void lxpanel_finalize(GObject *object)
@@ -129,7 +253,11 @@ static void panel_stop_gui(LXPanel *self)
     {
         gtk_window_group_remove_window(win_grp, GTK_WINDOW(self));
         xdisplay = GDK_DISPLAY_XDISPLAY(gdk_display_get_default());
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_display_flush (gdk_display_get_default ());
+#else
         gdk_flush();
+#endif
         XFlush(xdisplay);
         XSync(xdisplay, True);
         p->initialized = FALSE;
@@ -251,7 +379,11 @@ static void lxpanel_size_request(GtkWidget *widget, GtkRequisition *req)
     if (!p->visible)
         /* When the panel is in invisible state, the content box also got hidden, thus always
          * report 0 size.  Ask the content box instead for its size. */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_widget_get_preferred_size(p->box, NULL, req);
+#else
         gtk_widget_size_request(p->box, req);
+#endif
 
     rect.width = req->width;
     rect.height = req->height;
@@ -325,6 +457,10 @@ static void lxpanel_size_allocate(GtkWidget *widget, GtkAllocation *a)
     p->ax = rect.x;
     p->ay = rect.y;
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (a->width != p->aw || a->height != p->ah) gtk_widget_set_size_request (widget, p->aw, p->ah);
+#endif
+
     if (rect.width != p->aw || rect.height != p->ah || x != p->ax || y != p->ay)
     {
         p->aw = rect.width;
@@ -375,7 +511,11 @@ static gboolean lxpanel_button_press(GtkWidget *widget, GdkEventButton *event)
     if (event->button == 3) /* right button */
     {
         GtkMenu* popup = (GtkMenu*) lxpanel_get_plugin_menu(panel, NULL, FALSE);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_menu_popup_at_widget (popup, widget, GDK_GRAVITY_NORTH_WEST, GDK_GRAVITY_NORTH_WEST, (GdkEvent *) event);
+#else
         gtk_menu_popup(popup, NULL, NULL, NULL, NULL, event->button, event->time);
+#endif
         return TRUE;
     }
     else if (event->button == 2) /* middle button */
@@ -464,7 +604,11 @@ static void lxpanel_init(PanelToplevel *self)
     p->height_when_hidden = 2;
     p->transparent = 0;
     p->alpha = 255;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_rgba_parse(&p->gtintcolor, "white");
+#else
     gdk_color_parse("white", &p->gtintcolor);
+#endif
     p->tintcolor = gcolor2rgb24(&p->gtintcolor);
     p->usefontcolor = 0;
     p->fontcolor = 0x00000000;
@@ -474,7 +618,10 @@ static void lxpanel_init(PanelToplevel *self)
     p->icon_size = PANEL_ICON_SIZE;
     p->icon_theme = gtk_icon_theme_get_default();
     p->config = config_new();
+#if !GTK_CHECK_VERSION(3, 0, 0)
     p->defstyle = gtk_widget_get_default_style();
+#endif
+    p->point_at_menu = 0;
 }
 
 /* Allocate and initialize new Panel structure. */
@@ -563,10 +710,25 @@ gboolean _panel_edge_can_strut(LXPanel *panel, int edge, gint monitor, gulong *s
     }
 
     screen = gtk_widget_get_screen(GTK_WIDGET(panel));
+#if GTK_CHECK_VERSION(3, 0, 0)
+    n = gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (panel)));
+#else
     n = gdk_screen_get_n_monitors(screen);
+#endif
     if (monitor >= n) /* hidden now */
         return FALSE;
-    gdk_screen_get_monitor_geometry(screen, monitor, &rect);
+
+    /* the tests below are all based on the idea that a strut can only be attached to a monitor
+     * edge which is adjacent to a screen edge, and with size scaled to fill the entirety of the gap
+     * between screen and monitor. This restriction seems not to be required any more... */
+    if (G_LIKELY(size))
+        *size = s;
+    return TRUE;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_monitor_get_geometry (gdk_display_get_monitor (gdk_screen_get_display (screen), gdk_mon_num (monitor)), &rect);
+#else
+    gdk_screen_get_monitor_geometry(screen, gdk_mon_num (monitor), &rect);
+#endif
     switch (edge)
     {
         case EDGE_LEFT:
@@ -576,7 +738,11 @@ gboolean _panel_edge_can_strut(LXPanel *panel, int edge, gint monitor, gulong *s
             break;
         case EDGE_RIGHT:
             rect.x += rect.width;
+#if GTK_CHECK_VERSION(3, 0, 0)
+            rect.width = screen_width(screen) - rect.x;
+#else
             rect.width = gdk_screen_get_width(screen) - rect.x;
+#endif
             s += rect.width;
             break;
         case EDGE_TOP:
@@ -586,7 +752,11 @@ gboolean _panel_edge_can_strut(LXPanel *panel, int edge, gint monitor, gulong *s
             break;
         case EDGE_BOTTOM:
             rect.y += rect.height;
+#if GTK_CHECK_VERSION(3, 0, 0)
+            rect.height = screen_height(screen) - rect.y;
+#else
             rect.height = gdk_screen_get_height(screen) - rect.y;
+#endif
             s += rect.height;
             break;
         default: ;
@@ -598,7 +768,11 @@ gboolean _panel_edge_can_strut(LXPanel *panel, int edge, gint monitor, gulong *s
         {
             if (i == monitor)
                 continue;
-            gdk_screen_get_monitor_geometry(screen, i, &rect2);
+#if GTK_CHECK_VERSION(3, 0, 0)
+            gdk_monitor_get_geometry (gdk_display_get_monitor (gdk_screen_get_display (screen), gdk_mon_num (i)), &rect2);
+#else
+            gdk_screen_get_monitor_geometry(screen, gdk_mon_num (i), &rect2);
+#endif
             if (gdk_rectangle_intersect(&rect, &rect2, NULL))
                 /* that monitor lies over the edge */
                 return FALSE;
@@ -824,8 +998,14 @@ static void _panel_determine_background_pixmap(LXPanel * panel)
         else
         {
             /* Either color is set or image is invalid, fill the background */
+#if GTK_CHECK_VERSION(3, 0, 0)
+            p->gtintcolor.alpha = p->transparent ? (((double) p->alpha) / 256.0) : 1.0;
+            gdk_cairo_set_source_rgba(cr, &p->gtintcolor);
+            cairo_paint (cr);
+#else
             gdk_cairo_set_source_color(cr, &p->gtintcolor);
             cairo_paint_with_alpha(cr, p->transparent ? (double)p->alpha/255 : 1.0);
+#endif
         }
         cairo_destroy(cr);
     }
@@ -833,11 +1013,7 @@ static void _panel_determine_background_pixmap(LXPanel * panel)
     if (p->surface != NULL)
     {
         gtk_widget_set_app_paintable(widget, TRUE);
-#if GTK_CHECK_VERSION(3, 0, 0)
-        pattern = cairo_pattern_create_for_surface(p->surface);
-        gdk_window_set_background_pattern(window, pattern);
-        cairo_pattern_destroy(pattern);
-#else
+#if !GTK_CHECK_VERSION(3, 0, 0)
         pixmap = gdk_pixmap_new(window, p->aw, p->ah, -1);
         cr = gdk_cairo_create(pixmap);
         cairo_set_source_surface(cr, p->surface, 0, 0);
@@ -861,9 +1037,7 @@ void panel_determine_background_pixmap(Panel * panel, GtkWidget * widget, GdkWin
         /* Backward compatibility:
            reset background for the child, using background of panel */
         gtk_widget_set_app_paintable(widget, (panel->background || panel->transparent));
-#if GTK_CHECK_VERSION(3, 0, 0)
-        gdk_window_set_background_pattern(window, NULL);
-#else
+#if !GTK_CHECK_VERSION(3, 0, 0)
         gdk_window_set_back_pixmap(window, NULL, TRUE);
 #endif
     }
@@ -949,7 +1123,11 @@ mouse_watch(LXPanel *panel)
         return FALSE;
 
     ENTER;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    gdk_device_get_position (gdk_seat_get_pointer (gdk_display_get_default_seat (gdk_display_get_default ())), NULL, &x, &y);
+#else
     gdk_display_get_pointer(gdk_display_get_default(), NULL, &x, &y, NULL);
+#endif
 
 /*  Reduce sensitivity area
     p->ah_far = ((x < p->cx - GAP) || (x > p->cx + p->cw + GAP)
@@ -1254,15 +1432,28 @@ static void panel_popupmenu_create_panel( GtkMenuItem* item, LXPanel* panel )
 
     /* Allocate the edge. */
     g_assert(screen);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    monitors = gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (panel)));
+#else
     monitors = gdk_screen_get_n_monitors(screen);
+#endif
     /* try to allocate edge on current monitor first */
     m = panel->priv->monitor;
     if (m < 0)
     {
         /* panel is spanned over the screen, guess from pointer now */
         gint x, y;
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gdk_device_get_position (gdk_seat_get_pointer (gdk_display_get_default_seat (gdk_display_get_default ())), NULL, &x, &y);
+        int n = -1;
+        GdkMonitor *mon = gdk_display_get_monitor_at_point (gdk_screen_get_display (screen), x, y);
+        for (int i = 0; i < gdk_display_get_n_monitors (gdk_screen_get_display (screen)); i++)
+            if (gdk_display_get_monitor (gdk_screen_get_display (screen), i) == mon) n = i;
+        m = x_mon_num (n);
+#else
         gdk_display_get_pointer(gdk_display_get_default(), NULL, &x, &y, NULL);
-        m = gdk_screen_get_monitor_at_point(screen, x, y);
+        m = x_mon_num (gdk_screen_get_monitor_at_point(screen, x, y));
+#endif
     }
     for (e = 1; e < 5; ++e)
     {
@@ -1417,12 +1608,19 @@ GtkMenu* lxpanel_get_plugin_menu( LXPanel* panel, GtkWidget* plugin, gboolean us
     {
         init = PLUGIN_CLASS(plugin);
         /* create single item - plugin instance settings */
+#if GTK_CHECK_VERSION(3, 0, 0)
+        tmp = g_strdup_printf(_("%s Settings"),
+                              g_dgettext(init->gettext_package, init->name));
+        menu_item = gtk_menu_item_new_with_label( tmp );
+        g_free( tmp );
+#else
         img = gtk_image_new_from_stock( GTK_STOCK_PREFERENCES, GTK_ICON_SIZE_MENU );
-        tmp = g_strdup_printf(_("\"%s\" Settings"),
+        tmp = g_strdup_printf(_("%s Settings"),
                               g_dgettext(init->gettext_package, init->name));
         menu_item = gtk_image_menu_item_new_with_label( tmp );
         g_free( tmp );
         gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
         gtk_menu_shell_prepend(GTK_MENU_SHELL(ret), menu_item);
         if( init->config )
             g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_config_plugin), plugin );
@@ -1438,19 +1636,29 @@ GtkMenu* lxpanel_get_plugin_menu( LXPanel* panel, GtkWidget* plugin, gboolean us
     if (use_sub_menu)
         menu = GTK_MENU(gtk_menu_new());
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    menu_item = gtk_menu_item_new_with_label(_("Add / Remove Panel Items"));
+#else
     img = gtk_image_new_from_stock( GTK_STOCK_EDIT, GTK_ICON_SIZE_MENU );
     menu_item = gtk_image_menu_item_new_with_label(_("Add / Remove Panel Items"));
     gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
     g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_add_item), panel );
 
     if( plugin )
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        tmp = g_strdup_printf( _("Remove \"%s\" From Panel"), _(init->name) );
+        menu_item = gtk_menu_item_new_with_label( tmp );
+        g_free( tmp );
+#else
         img = gtk_image_new_from_stock( GTK_STOCK_REMOVE, GTK_ICON_SIZE_MENU );
         tmp = g_strdup_printf( _("Remove \"%s\" From Panel"), _(init->name) );
         menu_item = gtk_image_menu_item_new_with_label( tmp );
         g_free( tmp );
         gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
         gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
         g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_remove_item), plugin );
     }
@@ -1458,21 +1666,33 @@ GtkMenu* lxpanel_get_plugin_menu( LXPanel* panel, GtkWidget* plugin, gboolean us
     menu_item = gtk_separator_menu_item_new();
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    menu_item = gtk_menu_item_new_with_label(_("Panel Settings"));
+#else
     img = gtk_image_new_from_stock( GTK_STOCK_PREFERENCES, GTK_ICON_SIZE_MENU );
     menu_item = gtk_image_menu_item_new_with_label(_("Panel Settings"));
     gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
     g_signal_connect(G_OBJECT(menu_item), "activate", G_CALLBACK(panel_popupmenu_configure), panel );
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    menu_item = gtk_menu_item_new_with_label(_("Create New Panel"));
+#else
     img = gtk_image_new_from_stock( GTK_STOCK_NEW, GTK_ICON_SIZE_MENU );
     menu_item = gtk_image_menu_item_new_with_label(_("Create New Panel"));
     gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
     g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_create_panel), panel );
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    menu_item = gtk_menu_item_new_with_label(_("Delete This Panel"));
+#else
     img = gtk_image_new_from_stock( GTK_STOCK_DELETE, GTK_ICON_SIZE_MENU );
     menu_item = gtk_image_menu_item_new_with_label(_("Delete This Panel"));
     gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
     g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_delete_panel), panel );
     if( ! all_panels->next )    /* if this is the only panel */
@@ -1481,15 +1701,23 @@ GtkMenu* lxpanel_get_plugin_menu( LXPanel* panel, GtkWidget* plugin, gboolean us
     menu_item = gtk_separator_menu_item_new();
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    menu_item = gtk_menu_item_new_with_label(_("About"));
+#else
     img = gtk_image_new_from_stock( GTK_STOCK_ABOUT, GTK_ICON_SIZE_MENU );
     menu_item = gtk_image_menu_item_new_with_label(_("About"));
     gtk_image_menu_item_set_image( (GtkImageMenuItem*)menu_item, img );
+#endif
     gtk_menu_shell_append(GTK_MENU_SHELL(menu), menu_item);
     g_signal_connect( menu_item, "activate", G_CALLBACK(panel_popupmenu_about), panel->priv );
 
     if( use_sub_menu )
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        menu_item = gtk_menu_item_new_with_label(_("Panel"));
+#else
         menu_item = gtk_image_menu_item_new_with_label(_("Panel"));
+#endif
         gtk_menu_shell_append(GTK_MENU_SHELL(ret), menu_item);
         gtk_menu_item_set_submenu(GTK_MENU_ITEM(menu_item), GTK_WIDGET(menu) );
     }
@@ -1624,7 +1852,9 @@ panel_start_gui(LXPanel *panel, config_setting_t *list)
     p->ax = p->ay = p->aw = p->ah = 0;
 
     p->display = gdk_display_get_default();
+#if !GTK_CHECK_VERSION(3, 0, 0)
     gtk_window_set_wmclass(GTK_WINDOW(panel), "panel", "lxpanel");
+#endif
 
     if (G_UNLIKELY(win_grp == NULL))
     {
@@ -1724,9 +1954,15 @@ void panel_adjust_geometry_terminology(Panel * p)
 
 /* Draw text into a label, with the user preference color and optionally bold. */
 static
+#if GTK_CHECK_VERSION(3, 0, 0)
+void panel_draw_label_text_with_color(Panel * p, GtkWidget * label, const char * text,
+                           gboolean bold, float custom_size_factor,
+                           gboolean custom_color, GdkRGBA *gdkcolor)
+#else
 void panel_draw_label_text_with_color(Panel * p, GtkWidget * label, const char * text,
                            gboolean bold, float custom_size_factor,
                            gboolean custom_color, GdkColor *gdkcolor)
+#endif
 {
     if (text == NULL)
     {
@@ -1741,8 +1977,16 @@ void panel_draw_label_text_with_color(Panel * p, GtkWidget * label, const char *
         font_desc = p->fontsize;
     else
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        PangoFontDescription *desc;
+        GtkStyleContext *sc = gtk_widget_get_style_context (label);
+        gtk_style_context_get (sc, GTK_STATE_FLAG_NORMAL, "font", &desc, NULL);
+        font_desc = pango_font_description_get_size (desc) / PANGO_SCALE;
+        pango_font_description_free (desc);
+#else
         GtkStyle *style = gtk_widget_get_style(label);
         font_desc = pango_font_description_get_size(style->font_desc) / PANGO_SCALE;
+#endif
     }
     font_desc *= custom_size_factor;
 
@@ -1799,12 +2043,18 @@ void lxpanel_draw_label_text(LXPanel * p, GtkWidget * label, const char * text,
                            gboolean bold, float custom_size_factor,
                            gboolean custom_color)
 {
-    panel_draw_label_text(p->priv, label, text, bold, custom_size_factor, custom_color);
+    gtk_label_set_text (GTK_LABEL (label), text);
 }
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
+                                    gboolean bold, float custom_size_factor,
+                                    GdkRGBA *color)
+#else
 void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
                                     gboolean bold, float custom_size_factor,
                                     GdkColor *color)
+#endif
 {
     panel_draw_label_text_with_color(p->priv, label, text, bold, custom_size_factor, FALSE, color);
 }
@@ -1844,13 +2094,18 @@ static gboolean _panel_idle_reconfigure(gpointer widget)
             gtk_spin_button_set_value(GTK_SPIN_BUTTON(p->height_control), p->height);
         if ((p->widthtype == WIDTH_PIXEL) && (p->width_control != NULL))
         {
+#if GTK_CHECK_VERSION(3, 0, 0)
+            int value = ((p->orientation == GTK_ORIENTATION_HORIZONTAL) ? screen_width (NULL) : screen_height (NULL));
+#else
             int value = ((p->orientation == GTK_ORIENTATION_HORIZONTAL) ? gdk_screen_width() : gdk_screen_height());
+#endif
             gtk_spin_button_set_range(GTK_SPIN_BUTTON(p->width_control), 0, value);
             gtk_spin_button_set_value(GTK_SPIN_BUTTON(p->width_control), value);
         }
     }
 
     /* FIXME: it's deprecated, kept for binary compatibility */
+#if !GTK_CHECK_VERSION(3, 0, 0)
     if (p->orientation == GTK_ORIENTATION_HORIZONTAL) {
         p->my_box_new = gtk_hbox_new;
         p->my_separator_new = gtk_vseparator_new;
@@ -1858,6 +2113,7 @@ static gboolean _panel_idle_reconfigure(gpointer widget)
         p->my_box_new = gtk_vbox_new;
         p->my_separator_new = gtk_hseparator_new;
     }
+#endif
 
     /* recreate the main layout box */
     if (p->box != NULL)
@@ -1883,6 +2139,8 @@ static gboolean _panel_idle_reconfigure(gpointer widget)
 
     p->reconfigure_queued = 0;
 
+    warp_pointer (p);
+
     return FALSE;
 }
 
@@ -1936,12 +2194,19 @@ panel_parse_global(Panel *p, config_setting_t *cfg)
     }
     if (config_setting_lookup_int(cfg, "autohide", &i))
         p->autohide = i != 0;
+    if (config_setting_lookup_int(cfg, "point_at_menu", &i))
+        p->point_at_menu = i != 0;
     if (config_setting_lookup_int(cfg, "heightwhenhidden", &i))
         p->height_when_hidden = MAX(0, i);
     if (config_setting_lookup_string(cfg, "tintcolor", &str))
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        if (!gdk_rgba_parse (&p->gtintcolor, str))
+            gdk_rgba_parse (&p->gtintcolor, "#FFFFFF");
+#else
         if (!gdk_color_parse (str, &p->gtintcolor))
             gdk_color_parse ("white", &p->gtintcolor);
+#endif
         p->tintcolor = gcolor2rgb24(&p->gtintcolor);
             DBG("tintcolor=%x\n", p->tintcolor);
     }
@@ -1949,8 +2214,13 @@ panel_parse_global(Panel *p, config_setting_t *cfg)
         p->usefontcolor = i != 0;
     if (config_setting_lookup_string(cfg, "fontcolor", &str))
     {
+#if GTK_CHECK_VERSION(3, 0, 0)
+        if (!gdk_rgba_parse (&p->gfontcolor, str))
+            gdk_rgba_parse (&p->gfontcolor, "#000000");
+#else
         if (!gdk_color_parse (str, &p->gfontcolor))
             gdk_color_parse ("black", &p->gfontcolor);
+#endif
         p->fontcolor = gcolor2rgb24(&p->gfontcolor);
             DBG("fontcolor=%x\n", p->fontcolor);
     }
@@ -1973,7 +2243,11 @@ panel_parse_global(Panel *p, config_setting_t *cfg)
 static void on_monitors_changed(GdkScreen* screen, gpointer unused)
 {
     GSList *pl;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    int monitors = gdk_display_get_n_monitors (gdk_screen_get_display (screen));
+#else
     int monitors = gdk_screen_get_n_monitors(screen);
+#endif
 
     for (pl = all_panels; pl; pl = pl->next)
     {
@@ -2007,7 +2281,11 @@ static int panel_start(LXPanel *p)
     if (!list || !panel_parse_global(p->priv, config_setting_get_elem(list, 0)))
         RET(0);
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+    if (p->priv->monitor < gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (p))))
+#else
     if (p->priv->monitor < gdk_screen_get_n_monitors(screen))
+#endif
         panel_start_gui(p, list);
     if (monitors_handler == 0)
         monitors_handler = g_signal_connect(screen, "monitors-changed",
@@ -2040,6 +2318,56 @@ LXPanel* panel_new( const char* config_file, const char* config_name )
     return panel;
 }
 
+/* This is a modified version of panel_new; the sole difference is that if
+ * there is only one monitor connected, it shows all panels which would
+ * normally be displayed on monitor 1 on monitor 0 instead. */
+
+LXPanel* panel_new_mon_fb (const char* config_file, const char* config_name)
+{
+    LXPanel* panel = NULL;
+
+    if (G_LIKELY(config_file))
+    {
+        panel = panel_allocate (gdk_screen_get_default ());
+        panel->priv->name = g_strdup (config_name);
+        g_debug ("starting panel from file %s", config_file);
+        if (!config_read_file (panel->priv->config, config_file))
+        {
+            g_warning ( "lxpanel: can't start panel");
+            gtk_widget_destroy (GTK_WIDGET(panel));
+            return NULL;
+        }
+
+        GdkScreen *screen = gtk_widget_get_screen (GTK_WIDGET (panel));
+
+        /* parse global section of config file */
+        config_setting_t *list = config_setting_get_member (config_root_setting (panel->priv->config), "");
+        if (!list || !panel_parse_global (panel->priv, config_setting_get_elem (list, 0)))
+        {
+            g_warning ( "lxpanel: can't start panel");
+            gtk_widget_destroy (GTK_WIDGET(panel));
+            return NULL;
+        }
+
+#if GTK_CHECK_VERSION(3, 0, 0)
+        int n_mons = gdk_display_get_n_monitors (gtk_widget_get_display (GTK_WIDGET (panel)));
+#else
+        int n_mons = gdk_screen_get_n_monitors (screen);
+#endif
+        if (panel->priv->monitor < n_mons)
+            panel_start_gui (panel, list);
+        else if (n_mons == 1 && panel->priv->monitor == 1)
+        {
+            g_debug ("moving monitor 1 panel to monitor 0");
+            panel->priv->monitor = 0;
+            panel_start_gui (panel, list);
+        }
+
+        if (monitors_handler == 0)
+            monitors_handler = g_signal_connect (screen, "monitors-changed", G_CALLBACK (on_monitors_changed), NULL);
+    }
+    return panel;
+}
 
 GtkOrientation panel_get_orientation(LXPanel *panel)
 {
@@ -2051,6 +2379,15 @@ gint panel_get_icon_size(LXPanel *panel)
     return panel->priv->icon_size;
 }
 
+gint panel_get_safe_icon_size (LXPanel *panel)
+{
+    if (panel->priv->icon_size <= 20) return 16;
+    else if (panel->priv->icon_size <= 28) return 24;
+    else if (panel->priv->icon_size <= 40) return 32;
+    else if (panel->priv->icon_size <= 56) return 48;
+    else return 64;
+}
+
 gint panel_get_height(LXPanel *panel)
 {
     return panel->priv->height;
@@ -2063,13 +2400,15 @@ Window panel_get_xwindow(LXPanel *panel)
 
 gint panel_get_monitor(LXPanel *panel)
 {
-    return panel->priv->monitor;
+    return gdk_mon_num (panel->priv->monitor);
 }
 
+#if !GTK_CHECK_VERSION(3, 0, 0)
 GtkStyle *panel_get_defstyle(LXPanel *panel)
 {
     return panel->priv->defstyle;
 }
+#endif
 
 GtkIconTheme *panel_get_icon_theme(LXPanel *panel)
 {
@@ -2088,16 +2427,24 @@ gboolean panel_is_dynamic(LXPanel *panel)
 
 GtkWidget *panel_box_new(LXPanel *panel, gboolean homogeneous, gint spacing)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    return gtk_box_new (panel->priv->orientation, spacing);
+#else
     if (panel->priv->orientation == GTK_ORIENTATION_HORIZONTAL)
         return gtk_hbox_new(homogeneous, spacing);
     return gtk_vbox_new(homogeneous, spacing);
+#endif
 }
 
 GtkWidget *panel_separator_new(LXPanel *panel)
 {
+#if GTK_CHECK_VERSION(3, 0, 0)
+    return gtk_separator_new (panel->priv->orientation);
+#else
     if (panel->priv->orientation == GTK_ORIENTATION_HORIZONTAL)
         return gtk_vseparator_new();
     return gtk_hseparator_new();
+#endif
 }
 
 gboolean _class_is_present(const LXPanelPluginInit *init)
diff --git a/src/panel.h b/src/panel.h
index 8db83e4..e15cdcf 100644
--- a/src/panel.h
+++ b/src/panel.h
@@ -123,9 +123,15 @@ extern void lxpanel_draw_label_text(LXPanel * p, GtkWidget * label, const char *
  * Changes @label to contain @text with appropriate attributes using the
  * panel @p settings.
  */
+#if GTK_CHECK_VERSION(3, 0, 0)
+extern void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
+                                    gboolean bold, float custom_size_factor,
+                                    GdkRGBA *color);
+#else
 extern void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
                                     gboolean bold, float custom_size_factor,
                                     GdkColor *color);
+#endif
 
 /**
  * lxpanel_config_save
@@ -138,10 +144,13 @@ void lxpanel_config_save(LXPanel *p); /* defined in configurator.c */
 /* Accessors APIs for Panel* */
 extern GtkOrientation panel_get_orientation(LXPanel *panel);
 extern gint panel_get_icon_size(LXPanel *panel);
+extern gint panel_get_safe_icon_size(LXPanel *panel);
 extern gint panel_get_height(LXPanel *panel);
 extern Window panel_get_xwindow(LXPanel *panel);
 extern gint panel_get_monitor(LXPanel *panel);
+#if !GTK_CHECK_VERSION(3, 0, 0)
 extern GtkStyle *panel_get_defstyle(LXPanel *panel);
+#endif
 extern GtkIconTheme *panel_get_icon_theme(LXPanel *panel);
 extern gboolean panel_is_at_bottom(LXPanel *panel);
 extern gboolean panel_is_dynamic(LXPanel *panel);
diff --git a/src/panel.h.in b/src/panel.h.in
index cf0f492..1f09a23 100644
--- a/src/panel.h.in
+++ b/src/panel.h.in
@@ -123,9 +123,15 @@ extern void lxpanel_draw_label_text(LXPanel * p, GtkWidget * label, const char *
  * Changes @label to contain @text with appropriate attributes using the
  * panel @p settings.
  */
+#if GTK_CHECK_VERSION(3, 0, 0)
+extern void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
+                                    gboolean bold, float custom_size_factor,
+                                    GdkRGBA *color);
+#else
 extern void lxpanel_draw_label_text_with_color(LXPanel * p, GtkWidget * label, const char * text,
                                     gboolean bold, float custom_size_factor,
                                     GdkColor *color);
+#endif
 
 /**
  * lxpanel_config_save
@@ -138,10 +144,13 @@ void lxpanel_config_save(LXPanel *p); /* defined in configurator.c */
 /* Accessors APIs for Panel* */
 extern GtkOrientation panel_get_orientation(LXPanel *panel);
 extern gint panel_get_icon_size(LXPanel *panel);
+extern gint panel_get_safe_icon_size(LXPanel *panel);
 extern gint panel_get_height(LXPanel *panel);
 extern Window panel_get_xwindow(LXPanel *panel);
 extern gint panel_get_monitor(LXPanel *panel);
+#if !GTK_CHECK_VERSION(3, 0, 0)
 extern GtkStyle *panel_get_defstyle(LXPanel *panel);
+#endif
 extern GtkIconTheme *panel_get_icon_theme(LXPanel *panel);
 extern gboolean panel_is_at_bottom(LXPanel *panel);
 extern gboolean panel_is_dynamic(LXPanel *panel);
diff --git a/src/plugin.c b/src/plugin.c
index aa1c3d0..0dd65d0 100644
--- a/src/plugin.c
+++ b/src/plugin.c
@@ -196,18 +196,18 @@ void plugin_widget_set_background(GtkWidget * w, LXPanel * panel)
             if (gtk_widget_get_realized(w))
             {
                 GdkWindow *window = gtk_widget_get_window(w);
-#if GTK_CHECK_VERSION(3, 0, 0)
-                gdk_window_set_background_pattern(window, NULL);
-#else
+#if !GTK_CHECK_VERSION(3, 0, 0)
                 gdk_window_set_back_pixmap(window, NULL, TRUE);
 #endif
                 if ((p->background) || (p->transparent))
                     /* Reset background for the child, using background of panel */
                     gdk_window_invalidate_rect(window, NULL, TRUE);
+#if !GTK_CHECK_VERSION(3, 0, 0)
                 else
                     /* Set background according to the current GTK style. */
                     gtk_style_set_background(gtk_widget_get_style(w), window,
                                              GTK_STATE_NORMAL);
+#endif
             }
         }
 
@@ -215,9 +215,13 @@ void plugin_widget_set_background(GtkWidget * w, LXPanel * panel)
         if (GTK_IS_SOCKET(w))
         {
             gtk_widget_hide(w);
+#if !GTK_CHECK_VERSION(3, 0, 0)
             gdk_window_process_all_updates();
+#endif
             gtk_widget_show(w);
+#if !GTK_CHECK_VERSION(3, 0, 0)
             gdk_window_process_all_updates();
+#endif
         }
 
         /* Recursively process all children of a container. */
@@ -233,8 +237,17 @@ static gboolean lxpanel_plugin_button_press_event(GtkWidget *plugin, GdkEventBut
     if (event->button == 3 && /* right button */
         (event->state & gtk_accelerator_get_default_mod_mask()) == 0) /* no key */
     {
+#ifdef ENABLE_NLS
+		// this message comes via the plugin, which will have switched to its own text domain, so 
+		// we need to switch back here...
+		textdomain ( GETTEXT_PACKAGE );
+#endif
         GtkMenu* popup = (GtkMenu*)lxpanel_get_plugin_menu(panel, plugin, FALSE);
+#if GTK_CHECK_VERSION(3, 0, 0)
+        gtk_menu_popup_at_pointer (popup, (GdkEvent *) event);
+#else
         gtk_menu_popup(popup, NULL, NULL, NULL, NULL, event->button, event->time);
+#endif
         return TRUE;
     }
     return FALSE;
@@ -253,7 +266,11 @@ void lxpanel_plugin_popup_set_position_helper(LXPanel * p, GtkWidget * near, Gtk
     GtkAllocation allocation;
     GtkAllocation popup_req;
     GdkScreen *screen = NULL;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkMonitor *monitor;
+#else
     gint monitor;
+#endif
 
     /* Get the allocation of the popup menu. */
     gtk_widget_realize(popup);
@@ -262,7 +279,9 @@ void lxpanel_plugin_popup_set_position_helper(LXPanel * p, GtkWidget * near, Gtk
     {
         GdkRectangle extents;
         /* FIXME: can we wait somehow for WM drawing decorations? */
+#if !GTK_CHECK_VERSION(3, 0, 0)
         gdk_window_process_all_updates();
+#endif
         gdk_window_get_frame_extents(gtk_widget_get_window(popup), &extents);
         popup_req.width = extents.width;
         popup_req.height = extents.height;
@@ -294,10 +313,11 @@ void lxpanel_plugin_popup_set_position_helper(LXPanel * p, GtkWidget * near, Gtk
     else
         /* panel as a GtkWindow always has a screen */
         screen = gtk_widget_get_screen(GTK_WIDGET(p));
-    monitor = gdk_screen_get_monitor_at_point(screen, x, y);
-#if GTK_CHECK_VERSION(3, 4, 0)
-    gdk_screen_get_monitor_workarea(screen, monitor, &allocation);
+#if GTK_CHECK_VERSION(3, 0, 0)
+    monitor = gdk_display_get_monitor_at_point (gdk_screen_get_display (screen), x, y);
+    gdk_monitor_get_workarea (monitor, &allocation);
 #else
+    monitor = gdk_screen_get_monitor_at_point(screen, x, y);
     gdk_screen_get_monitor_geometry(screen, monitor, &allocation);
 #endif
     x = CLAMP(x, allocation.x, allocation.x + allocation.width - popup_req.width);
@@ -580,6 +600,7 @@ GtkWidget *lxpanel_add_plugin(LXPanel *p, const char *name, config_setting_t *cf
     gtk_box_pack_start(GTK_BOX(p->priv->box), widget, expand, TRUE, padding);
     if (at >= 0)
         gtk_box_reorder_child(GTK_BOX(p->priv->box), widget, at);
+    if (GTK_IS_CONTAINER (widget))
     gtk_container_set_border_width(GTK_CONTAINER(widget), border);
     g_signal_connect(widget, "size-allocate", G_CALLBACK(on_size_allocate), p);
     gtk_widget_show(widget);
@@ -595,3 +616,88 @@ GHashTable *lxpanel_get_all_types(void)
 {
     return _all_types;
 }
+
+/* sets the supplied image widget to the named icon at the current taskbar size */
+void lxpanel_plugin_set_taskbar_icon (LXPanel *p, GtkWidget *image, const char *icon)
+{
+    GdkPixbuf *pixbuf;
+
+    pixbuf = gtk_icon_theme_load_icon (panel_get_icon_theme (p), icon,
+        panel_get_safe_icon_size (p), GTK_ICON_LOOKUP_FORCE_SIZE, NULL);
+    if (pixbuf)
+    {
+        gtk_image_set_from_pixbuf (GTK_IMAGE (image), pixbuf);
+        g_object_unref (pixbuf);
+    }
+}
+
+void lxpanel_plugin_set_menu_icon (LXPanel *p, GtkWidget *image, const char *icon)
+{
+    GdkPixbuf *pixbuf = NULL;
+
+    if (icon)
+        pixbuf = gtk_icon_theme_load_icon (panel_get_icon_theme (p), icon,
+            panel_get_safe_icon_size (p) > 32 ? 24 : 16, GTK_ICON_LOOKUP_FORCE_SIZE, NULL);
+    if (!pixbuf)
+    {
+        pixbuf = gdk_pixbuf_new (GDK_COLORSPACE_RGB, TRUE, 8, panel_get_safe_icon_size (p) > 32 ? 24 : 16, 
+            panel_get_safe_icon_size (p) > 32 ? 24 : 16);
+        gdk_pixbuf_fill (pixbuf, 0xffffff00);
+    }
+    gtk_image_set_from_pixbuf (GTK_IMAGE (image), pixbuf);
+    g_object_unref (pixbuf);
+}
+
+GtkWidget *lxpanel_plugin_new_menu_item (LXPanel *p, const char *text, int maxlen, const char *iconname)
+{
+    GtkWidget *item = gtk_menu_item_new ();
+    gtk_widget_set_name (item, "panelmenuitem");
+    GtkWidget *box = gtk_box_new (GTK_ORIENTATION_HORIZONTAL, MENU_ICON_SPACE);
+    GtkWidget *label = gtk_label_new (text);
+    GtkWidget *icon = gtk_image_new ();
+    lxpanel_plugin_set_menu_icon (p, icon, iconname);
+
+    if (maxlen)
+    {
+        gtk_label_set_max_width_chars (GTK_LABEL (label), maxlen);
+        gtk_label_set_ellipsize (GTK_LABEL (label), PANGO_ELLIPSIZE_END);
+    }
+
+    gtk_container_add (GTK_CONTAINER (item), box);
+    gtk_container_add (GTK_CONTAINER (box), icon);
+    gtk_container_add (GTK_CONTAINER (box), label);
+
+    return item;
+}
+
+void lxpanel_plugin_update_menu_icon (GtkWidget *item, GtkWidget *image)
+{
+    GtkWidget *box = gtk_bin_get_child (GTK_BIN (item));
+    GList *children = gtk_container_get_children (GTK_CONTAINER (box));
+    GtkWidget *img = (GtkWidget *) children->data;
+    gtk_container_remove (GTK_CONTAINER (box), img);
+    gtk_box_pack_start (GTK_BOX (box), image, FALSE, FALSE, 0);
+    gtk_box_reorder_child (GTK_BOX (box), image, 0);
+}
+
+void lxpanel_plugin_append_menu_icon (GtkWidget *item, GtkWidget *image)
+{
+    GtkWidget *box = gtk_bin_get_child (GTK_BIN (item));
+    gtk_box_pack_start (GTK_BOX (box), image, FALSE, FALSE, 0);
+}
+
+const char *lxpanel_plugin_get_menu_label (GtkWidget *item)
+{
+    if (!GTK_IS_BIN (item)) return "";
+    GtkWidget *box = gtk_bin_get_child (GTK_BIN (item));
+    if (!box) return "";
+    GList *children = gtk_container_get_children (GTK_CONTAINER (box));
+    if (!children) return "";
+    while (children->data)
+    {
+        if (GTK_IS_LABEL ((GtkWidget *) children->data))
+            return gtk_label_get_text (GTK_LABEL ((GtkWidget *) children->data));
+        children = children->next;
+    }
+    return "";
+}
diff --git a/src/plugin.h b/src/plugin.h
index e9120d6..50b57b8 100644
--- a/src/plugin.h
+++ b/src/plugin.h
@@ -36,6 +36,10 @@ G_BEGIN_DECLS
 
 #define FM_MODULE_lxpanel_gtk_VERSION 1 /* version of this API */
 
+#if GTK_CHECK_VERSION(3, 0, 0)
+#define MENU_ICON_SPACE 6
+#endif
+
 /**
  * LXPanelPluginInit:
  * @init: (allow-none): callback on lxpanel start
@@ -267,7 +271,9 @@ typedef enum {
     CONF_TYPE_FILE_ENTRY,
     CONF_TYPE_DIRECTORY_ENTRY,
     CONF_TYPE_TRIM,
-    CONF_TYPE_EXTERNAL
+    CONF_TYPE_EXTERNAL,
+    CONF_TYPE_COLOR,
+    CONF_TYPE_RBUTTON
 } PluginConfType;
 
 /**
@@ -379,6 +385,13 @@ extern guint panel_config_click_parse(const char *keystring, GdkModifierType *mo
 GtkWidget *lxpanel_add_plugin(LXPanel *p, const char *name, config_setting_t *cfg, gint at);
 void lxpanel_remove_plugin(LXPanel *p, GtkWidget *plugin);
 
+extern void lxpanel_plugin_set_taskbar_icon (LXPanel *p, GtkWidget *image, const char *icon);
+extern void lxpanel_plugin_set_menu_icon (LXPanel *p, GtkWidget *image, const char *icon);
+extern GtkWidget *lxpanel_plugin_new_menu_item (LXPanel *p, const char *text, int maxlen, const char *iconname);
+extern void lxpanel_plugin_update_menu_icon (GtkWidget *item, GtkWidget *image);
+extern void lxpanel_plugin_append_menu_icon (GtkWidget *item, GtkWidget *image);
+extern const char *lxpanel_plugin_get_menu_label (GtkWidget *item);
+
 G_END_DECLS
 
 #endif /* __PLUGIN_H__ */
diff --git a/src/private.h b/src/private.h
index ff3cc49..3d99bb0 100644
--- a/src/private.h
+++ b/src/private.h
@@ -94,8 +94,13 @@ struct _Panel {
     int alpha;
     guint32 tintcolor;
     guint32 fontcolor;
+#if GTK_CHECK_VERSION(3, 0, 0)
+    GdkRGBA gtintcolor;
+    GdkRGBA gfontcolor;
+#else
     GdkColor gtintcolor;
     GdkColor gfontcolor;
+#endif
 
     int ax, ay, aw, ah;  /* prefferd allocation of a panel */
     int cx, cy, cw, ch;  /* current allocation (as reported by configure event) allocation */
@@ -120,6 +125,7 @@ struct _Panel {
     guint transparent : 1;
     guint background : 1;
     guint spacing;
+    guint point_at_menu : 1;
 
     guint autohide : 1;
     guint visible : 1;
@@ -248,6 +254,7 @@ extern GQuark lxpanel_plugin_qconf; /* access to congig_setting_t data */
 gboolean _class_is_present(const LXPanelPluginInit *init);
 
 LXPanel* panel_new(const char* config_file, const char* config_name);
+LXPanel* panel_new_mon_fb (const char* config_file, const char* config_name);
 
 void _panel_show_config_dialog(LXPanel *panel, GtkWidget *p, GtkWidget *dlg);
 
